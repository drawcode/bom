-- -----------------------------------------------------------------------------
-- SQL SETUP 
-- -----------------------------------------------------------------------------
-- TABLES

/*
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[app]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[app]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[app_type]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[app_type]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[site]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[site]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[site_type]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[site_type]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[org]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[org]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[org_type]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[org_type]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[content_item]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[content_item]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[content_item_type]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[content_item_type]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[content_page]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[content_page]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[message]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[message]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_category]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_category]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_category_tree]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_category_tree]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_category_assoc]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_category_assoc]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_type]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_type]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_game]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_game]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_game_network]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_game_network]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_game_data_attribute]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_game_data_attribute]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_session]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_session]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_session_data]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_session_data]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_content]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_content]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_profile_content]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_profile_content]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_app]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_app]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[offer]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[offer]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[offer_type]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[offer_type]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[offer_location]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[offer_location]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[offer_category]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[offer_category]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[offer_category_tree]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[offer_category_tree]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[offer_category_assoc]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[offer_category_assoc]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[offer_game_location]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[offer_game_location]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[event_info]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[event_info]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[event_location]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[event_location]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[event_category]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[event_category]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[event_category_tree]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[event_category_tree]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[event_category_assoc]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[event_category_assoc]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[channel]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[channel]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[channel_type]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[channel_type]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[question]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[question]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_offer]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_offer]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_app]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_app]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_org]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_org]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_game_location]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_game_location]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_question]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_question]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[profile_channel]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[profile_channel]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[org_site]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[org_site]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[site_app]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[site_app]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[photo]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[photo]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[video]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[video]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_rpg_item_weapon]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_rpg_item_weapon]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_rpg_item_skill]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_rpg_item_skill]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_product]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_product]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_statistic_leaderboard]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_live_queue]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_live_queue]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_live_recent_queue]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_live_recent_queue]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_statistic]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_statistic_meta]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_statistic_meta]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_statistic_timestamp]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_statistic_timestamp]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_key_meta]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_level]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_level]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_achievement]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[game_achievement_meta]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
DROP TABLE [dbo].[game_achievement_meta]
GO
*/


CREATE TABLE [dbo].[app] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_app_date_modified DEFAULT GETDATE()
    , [type_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [platform] varchar (255)
    , [active] bit
                CONSTRAINT DF_app_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_app_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[app] ADD 
    CONSTRAINT [PK_app] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[app_type] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_app_type_date_modified DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_app_type_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_app_type_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[app_type] ADD 
    CONSTRAINT [PK_app_type] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[site] 
(
    [status] varchar (255)
    , [domain] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_site_date_modified DEFAULT GETDATE()
    , [type_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_site_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_site_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[site] ADD 
    CONSTRAINT [PK_site] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[site_type] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_site_type_date_modified DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_site_type_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_site_type_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[site_type] ADD 
    CONSTRAINT [PK_site_type] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[org] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_org_date_modified DEFAULT GETDATE()
    , [type_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_org_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_org_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[org] ADD 
    CONSTRAINT [PK_org] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[org_type] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_org_type_date_modified DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_org_type_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_org_type_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[org_type] ADD 
    CONSTRAINT [PK_org_type] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[content_item] 
(
    [status] varchar (255)
    , [type_id] uniqueidentifier
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_content_item_date_modified DEFAULT GETDATE()
    , [data] ntext
    , [date_end] DATETIME
                CONSTRAINT DF_content_item_date_end DEFAULT GETDATE()
    , [date_start] DATETIME
                CONSTRAINT DF_content_item_date_start DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [path] varchar (500)
    , [active] bit
                CONSTRAINT DF_content_item_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_content_item_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[content_item] ADD 
    CONSTRAINT [PK_content_item] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[content_item_type] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_content_item_type_date_modified DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_content_item_type_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_content_item_type_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[content_item_type] ADD 
    CONSTRAINT [PK_content_item_type] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[content_page] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_content_page_date_modified DEFAULT GETDATE()
    , [date_end] DATETIME
                CONSTRAINT DF_content_page_date_end DEFAULT GETDATE()
    , [date_start] DATETIME
                CONSTRAINT DF_content_page_date_start DEFAULT GETDATE()
    , [site_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [template] ntext
    , [path] varchar (500)
    , [active] bit
                CONSTRAINT DF_content_page_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_content_page_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[content_page] ADD 
    CONSTRAINT [PK_content_page] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[message] 
(
    [status] varchar (255)
    , [profile_from_name] varchar (500)
    , [read] bit
                CONSTRAINT DF_message_read_bool DEFAULT 1
    , [profile_from_id] uniqueidentifier
    , [profile_to_token] varchar (500)
    , [app_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_message_active_bool DEFAULT 1
    , [subject] varchar (500)
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_message_date_modified DEFAULT GETDATE()
    , [profile_to_id] uniqueidentifier
    , [date_created] DATETIME
                CONSTRAINT DF_message_date_created DEFAULT GETDATE()
    , [profile_to_name] varchar (500)
    , [type] varchar (500)
    , [sent] bit
                CONSTRAINT DF_message_sent_bool DEFAULT 1
)
GO
ALTER TABLE [dbo].[message] ADD 
    CONSTRAINT [PK_message] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_date_modified DEFAULT GETDATE()
    , [org_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [app_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_game_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game] ADD 
    CONSTRAINT [PK_game] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_category] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_category_date_modified DEFAULT GETDATE()
    , [type_id] uniqueidentifier NOT NULL
    , [org_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_game_category_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_category_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_category] ADD 
    CONSTRAINT [PK_game_category] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_category_tree] 
(
    [status] varchar (255)
    , [parent_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_game_category_tree_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_game_category_tree_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_category_tree_date_created DEFAULT GETDATE()
    , [category_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[game_category_tree] ADD 
    CONSTRAINT [PK_game_category_tree] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_category_assoc] 
(
    [status] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_game_category_assoc_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_game_category_assoc_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_category_assoc_date_created DEFAULT GETDATE()
    , [game_id] uniqueidentifier NOT NULL
    , [category_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[game_category_assoc] ADD 
    CONSTRAINT [PK_game_category_assoc] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_type] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_type_date_modified DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_game_type_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_type_date_created DEFAULT GETDATE()
    , [type] varchar (50) NOT NULL
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_type] ADD 
    CONSTRAINT [PK_game_type] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_game] 
(
    [status] varchar (255)
    , [type_id] uniqueidentifier
    , [profile_id] uniqueidentifier
    , [game_profile] ntext
    , [active] bit
                CONSTRAINT DF_profile_game_active_bool DEFAULT 1
    , [game_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_profile_game_date_modified DEFAULT GETDATE()
    , [profile_version] varchar (50)
    , [date_created] DATETIME
                CONSTRAINT DF_profile_game_date_created DEFAULT GETDATE()
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[profile_game] ADD 
    CONSTRAINT [PK_profile_game] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_game_network] 
(
    [status] varchar (255)
    , [hash] varchar (500)
    , [profile_id] uniqueidentifier
    , [game_network_id] uniqueidentifier
    , [network_username] varchar (500)
    , [active] bit
                CONSTRAINT DF_profile_game_network_active_bool DEFAULT 1
    , [game_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_profile_game_network_date_modified DEFAULT GETDATE()
    , [secret] varchar (500)
    , [token] varchar (500)
    , [date_created] DATETIME
                CONSTRAINT DF_profile_game_network_date_created DEFAULT GETDATE()
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[profile_game_network] ADD 
    CONSTRAINT [PK_profile_game_network] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_game_data_attribute] 
(
    [code] varchar (500)
    , [uuid] uniqueidentifier
    , [val] ntext
    , [profile_id] uniqueidentifier
    , [otype] varchar (500)
    , [game_id] uniqueidentifier
    , [type] varchar (500)
    , [name] varchar (500)
)
GO
ALTER TABLE [dbo].[profile_game_data_attribute] ADD 
    CONSTRAINT [PK_profile_game_data_attribute] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_session] 
(
    [code] varchar (255)
    , [network_uuid] varchar (40)
    , [profile_id] uniqueidentifier
    , [game_area] varchar (255)
    , [profile_network] varchar (255)
    , [profile_device] varchar (50)
    , [display_name] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [network_external_port] int
    , [game_players_connected] int
    , [type] varchar (500)
    , [status] varchar (255)
    , [game_state] varchar (50)
    , [hash] varchar (255)
    , [description] varchar (255)
    , [network_external_ip] varchar (40)
    , [game_level] varchar (255)
    , [profile_username] varchar (500)
    , [active] bit
                CONSTRAINT DF_game_session_active_bool DEFAULT 1
    , [game_id] uniqueidentifier
    , [game_code] varchar (255)
    , [game_player_z] decimal
    , [game_player_x] decimal
    , [network_port] int
    , [game_players_allowed] int
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_session_date_modified DEFAULT GETDATE()
    , [game_type] varchar (255)
    , [date_created] DATETIME
                CONSTRAINT DF_game_session_date_created DEFAULT GETDATE()
    , [network_ip] varchar (40)
    , [network_use_nat] bit
                CONSTRAINT DF_game_session_network_use_nat_bool DEFAULT 1
)
GO
ALTER TABLE [dbo].[game_session] ADD 
    CONSTRAINT [PK_game_session] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_session_data] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_session_data_date_modified DEFAULT GETDATE()
    , [data_results] ntext
    , [data] ntext
    , [uuid] uniqueidentifier NOT NULL
    , [data_layer_projectile] ntext
    , [data_layer_actors] ntext
    , [active] bit
                CONSTRAINT DF_game_session_data_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_session_data_date_created DEFAULT GETDATE()
    , [data_layer_enemy] ntext
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_session_data] ADD 
    CONSTRAINT [PK_game_session_data] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_content] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [extension] varchar (50)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_content_date_modified DEFAULT GETDATE()
    , [data] ntext
    , [game_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [filename] varchar (500)
    , [source] varchar (255)
    , [version] varchar (255)
    , [platform] varchar (255)
    , [content_type] varchar (255)
    , [path] varchar (500)
    , [active] bit
                CONSTRAINT DF_game_content_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_content_date_created DEFAULT GETDATE()
    , [increment] int
    , [type] varchar (500)
    , [hash] varchar (255)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_content] ADD 
    CONSTRAINT [PK_game_content] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_profile_content] 
(
    [username] varchar (500)
    , [code] varchar (255)
    , [profile_id] uniqueidentifier NOT NULL
    , [increment] int
    , [path] varchar (500)
    , [display_name] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [platform] varchar (255)
    , [filename] varchar (500)
    , [source] varchar (255)
    , [version] varchar (255)
    , [game_network] varchar (500)
    , [type] varchar (500)
    , [status] varchar (255)
    , [hash] varchar (255)
    , [description] varchar (255)
    , [content_type] varchar (255)
    , [active] bit
                CONSTRAINT DF_game_profile_content_active_bool DEFAULT 1
    , [game_id] uniqueidentifier NOT NULL
    , [data] ntext
    , [name] varchar (255)
    , [extension] varchar (50)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_profile_content_date_modified DEFAULT GETDATE()
    , [date_created] DATETIME
                CONSTRAINT DF_game_profile_content_date_created DEFAULT GETDATE()
)
GO
ALTER TABLE [dbo].[game_profile_content] ADD 
    CONSTRAINT [PK_game_profile_content] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_app] 
(
    [status] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_game_app_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_game_app_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_app_date_created DEFAULT GETDATE()
    , [game_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
    , [app_id] uniqueidentifier NOT NULL
)
GO
ALTER TABLE [dbo].[game_app] ADD 
    CONSTRAINT [PK_game_app] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[offer] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_offer_date_modified DEFAULT GETDATE()
    , [url] varchar (500)
    , [type_id] uniqueidentifier NOT NULL
    , [org_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [usage_count] int
    , [active] bit
                CONSTRAINT DF_offer_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_offer_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[offer] ADD 
    CONSTRAINT [PK_offer] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[offer_type] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_offer_type_date_modified DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_offer_type_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_offer_type_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[offer_type] ADD 
    CONSTRAINT [PK_offer_type] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[offer_location] 
(
    [status] varchar (255)
    , [fax] varchar (30)
    , [code] varchar (255)
    , [description] varchar (255)
    , [address1] varchar (1000)
    , [twitter] varchar (50)
    , [phone] varchar (30)
    , [postal_code] varchar (30)
    , [offer_id] uniqueidentifier
    , [country_code] varchar (255)
    , [date_created] DATETIME
                CONSTRAINT DF_offer_location_date_created DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_offer_location_active_bool DEFAULT 1
    , [uuid] uniqueidentifier NOT NULL
    , [state_province] varchar (255)
    , [city] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_offer_location_date_modified DEFAULT GETDATE()
    , [dob] DATETIME
                CONSTRAINT DF_offer_location_dob DEFAULT GETDATE()
    , [date_start] DATETIME
                CONSTRAINT DF_offer_location_date_start DEFAULT GETDATE()
    , [longitude] double
    , [email] varchar (255)
    , [date_end] DATETIME
                CONSTRAINT DF_offer_location_date_end DEFAULT GETDATE()
    , [latitude] double
    , [facebook] varchar (255)
    , [type] varchar (500)
    , [address2] varchar (500)
)
GO
ALTER TABLE [dbo].[offer_location] ADD 
    CONSTRAINT [PK_offer_location] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[offer_category] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_offer_category_date_modified DEFAULT GETDATE()
    , [type_id] uniqueidentifier NOT NULL
    , [org_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_offer_category_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_offer_category_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[offer_category] ADD 
    CONSTRAINT [PK_offer_category] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[offer_category_tree] 
(
    [status] varchar (255)
    , [parent_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_offer_category_tree_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_offer_category_tree_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_offer_category_tree_date_created DEFAULT GETDATE()
    , [category_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[offer_category_tree] ADD 
    CONSTRAINT [PK_offer_category_tree] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[offer_category_assoc] 
(
    [status] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_offer_category_assoc_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_offer_category_assoc_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_offer_category_assoc_date_created DEFAULT GETDATE()
    , [offer_id] uniqueidentifier NOT NULL
    , [category_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[offer_category_assoc] ADD 
    CONSTRAINT [PK_offer_category_assoc] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[offer_game_location] 
(
    [status] varchar (255)
    , [game_location_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_offer_game_location_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_offer_game_location_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_offer_game_location_date_created DEFAULT GETDATE()
    , [offer_id] uniqueidentifier
    , [type_id] uniqueidentifier
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[offer_game_location] ADD 
    CONSTRAINT [PK_offer_game_location] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[event_info] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_event_info_date_modified DEFAULT GETDATE()
    , [url] varchar (500)
    , [org_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [usage_count] int
    , [active] bit
                CONSTRAINT DF_event_info_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_event_info_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[event_info] ADD 
    CONSTRAINT [PK_event_info] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[event_location] 
(
    [status] varchar (255)
    , [fax] varchar (30)
    , [code] varchar (255)
    , [description] varchar (255)
    , [address1] varchar (1000)
    , [twitter] varchar (50)
    , [phone] varchar (30)
    , [postal_code] varchar (30)
    , [country_code] varchar (255)
    , [date_created] DATETIME
                CONSTRAINT DF_event_location_date_created DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_event_location_active_bool DEFAULT 1
    , [uuid] uniqueidentifier NOT NULL
    , [state_province] varchar (255)
    , [city] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_event_location_date_modified DEFAULT GETDATE()
    , [dob] DATETIME
                CONSTRAINT DF_event_location_dob DEFAULT GETDATE()
    , [date_start] DATETIME
                CONSTRAINT DF_event_location_date_start DEFAULT GETDATE()
    , [longitude] double
    , [email] varchar (255)
    , [event_id] uniqueidentifier
    , [date_end] DATETIME
                CONSTRAINT DF_event_location_date_end DEFAULT GETDATE()
    , [latitude] double
    , [facebook] varchar (255)
    , [type] varchar (500)
    , [address2] varchar (500)
)
GO
ALTER TABLE [dbo].[event_location] ADD 
    CONSTRAINT [PK_event_location] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[event_category] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_event_category_date_modified DEFAULT GETDATE()
    , [type_id] uniqueidentifier NOT NULL
    , [org_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_event_category_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_event_category_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[event_category] ADD 
    CONSTRAINT [PK_event_category] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[event_category_tree] 
(
    [status] varchar (255)
    , [parent_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_event_category_tree_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_event_category_tree_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_event_category_tree_date_created DEFAULT GETDATE()
    , [category_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[event_category_tree] ADD 
    CONSTRAINT [PK_event_category_tree] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[event_category_assoc] 
(
    [status] varchar (255)
    , [event_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_event_category_assoc_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_event_category_assoc_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_event_category_assoc_date_created DEFAULT GETDATE()
    , [category_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[event_category_assoc] ADD 
    CONSTRAINT [PK_event_category_assoc] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[channel] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_channel_date_modified DEFAULT GETDATE()
    , [type_id] uniqueidentifier NOT NULL
    , [org_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_channel_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_channel_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[channel] ADD 
    CONSTRAINT [PK_channel] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[channel_type] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_channel_type_date_modified DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_channel_type_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_channel_type_date_created DEFAULT GETDATE()
    , [type] varchar (50) NOT NULL
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[channel_type] ADD 
    CONSTRAINT [PK_channel_type] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[question] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_question_date_modified DEFAULT GETDATE()
    , [org_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [choices] ntext
    , [channel_id] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_question_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_question_date_created DEFAULT GETDATE()
    , [type] varchar (50) NOT NULL
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[question] ADD 
    CONSTRAINT [PK_question] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_offer] 
(
    [status] varchar (255)
    , [redeem_code] varchar (128) NOT NULL
    , [offer_id] uniqueidentifier NOT NULL
    , [profile_id] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_profile_offer_active_bool DEFAULT 1
    , [uuid] uniqueidentifier NOT NULL
    , [redeemed] varchar (50) NOT NULL
    , [url] varchar (50)
    , [date_modified] DATETIME
                CONSTRAINT DF_profile_offer_date_modified DEFAULT GETDATE()
    , [date_created] DATETIME
                CONSTRAINT DF_profile_offer_date_created DEFAULT GETDATE()
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[profile_offer] ADD 
    CONSTRAINT [PK_profile_offer] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_app] 
(
    [status] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_profile_app_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_profile_app_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_profile_app_date_created DEFAULT GETDATE()
    , [profile_id] uniqueidentifier
    , [type] varchar (500)
    , [app_id] uniqueidentifier
)
GO
ALTER TABLE [dbo].[profile_app] ADD 
    CONSTRAINT [PK_profile_app] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_org] 
(
    [status] varchar (255)
    , [type_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_profile_org_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_profile_org_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_profile_org_date_created DEFAULT GETDATE()
    , [profile_id] uniqueidentifier
    , [type] varchar (500)
    , [org_id] uniqueidentifier
)
GO
ALTER TABLE [dbo].[profile_org] ADD 
    CONSTRAINT [PK_profile_org] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_game_location] 
(
    [status] varchar (255)
    , [game_location_id] uniqueidentifier
    , [type_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_profile_game_location_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_profile_game_location_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_profile_game_location_date_created DEFAULT GETDATE()
    , [profile_id] uniqueidentifier
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[profile_game_location] ADD 
    CONSTRAINT [PK_profile_game_location] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_question] 
(
    [status] varchar (255)
    , [profile_id] uniqueidentifier NOT NULL
    , [active] bit
                CONSTRAINT DF_profile_question_active_bool DEFAULT 1
    , [data] ntext NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_profile_question_date_modified DEFAULT GETDATE()
    , [org_id] uniqueidentifier NOT NULL
    , [channel_id] uniqueidentifier NOT NULL
    , [answer] varchar (1000) NOT NULL
    , [date_created] DATETIME
                CONSTRAINT DF_profile_question_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [question_id] uniqueidentifier NOT NULL
)
GO
ALTER TABLE [dbo].[profile_question] ADD 
    CONSTRAINT [PK_profile_question] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[profile_channel] 
(
    [status] varchar (255)
    , [channel_id] uniqueidentifier NOT NULL
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_profile_channel_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_profile_channel_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_profile_channel_date_created DEFAULT GETDATE()
    , [profile_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[profile_channel] ADD 
    CONSTRAINT [PK_profile_channel] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[org_site] 
(
    [status] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_org_site_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_org_site_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_org_site_date_created DEFAULT GETDATE()
    , [site_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
    , [org_id] uniqueidentifier NOT NULL
)
GO
ALTER TABLE [dbo].[org_site] ADD 
    CONSTRAINT [PK_org_site] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[site_app] 
(
    [status] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_site_app_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_site_app_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_site_app_date_created DEFAULT GETDATE()
    , [site_id] uniqueidentifier NOT NULL
    , [type] varchar (500)
    , [app_id] uniqueidentifier NOT NULL
)
GO
ALTER TABLE [dbo].[site_app] ADD 
    CONSTRAINT [PK_site_app] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[photo] 
(
    [status] varchar (255)
    , [third_party_oembed] varchar (500)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_photo_date_modified DEFAULT GETDATE()
    , [url] varchar (500)
    , [third_party_data] varchar (500)
    , [uuid] uniqueidentifier NOT NULL
    , [third_party_url] varchar (500)
    , [third_party_id] varchar (500)
    , [content_type] varchar (100)
    , [external_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_photo_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_photo_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[photo] ADD 
    CONSTRAINT [PK_photo] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[video] 
(
    [status] varchar (255)
    , [third_party_oembed] varchar (500)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_video_date_modified DEFAULT GETDATE()
    , [url] varchar (500)
    , [third_party_data] varchar (500)
    , [uuid] uniqueidentifier NOT NULL
    , [third_party_url] varchar (500)
    , [third_party_id] varchar (500)
    , [content_type] varchar (100)
    , [external_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_video_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_video_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[video] ADD 
    CONSTRAINT [PK_video] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_rpg_item_weapon] 
(
    [status] varchar (255)
    , [third_party_oembed] varchar (500)
    , [code] varchar (255)
    , [description] varchar (255)
    , [game_defense] decimal
    , [third_party_url] varchar (500)
    , [third_party_id] varchar (500)
    , [content_type] varchar (100)
    , [type] varchar (500)
    , [active] bit
                CONSTRAINT DF_game_rpg_item_weapon_active_bool DEFAULT 1
    , [game_id] uniqueidentifier
    , [game_attack] decimal
    , [uuid] uniqueidentifier NOT NULL
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_rpg_item_weapon_date_modified DEFAULT GETDATE()
    , [url] varchar (500)
    , [third_party_data] varchar (500)
    , [game_price] decimal
    , [game_type] decimal
    , [game_skill] decimal
    , [game_health] decimal
    , [date_created] DATETIME
                CONSTRAINT DF_game_rpg_item_weapon_date_created DEFAULT GETDATE()
    , [game_energy] decimal
    , [game_data] ntext
)
GO
ALTER TABLE [dbo].[game_rpg_item_weapon] ADD 
    CONSTRAINT [PK_game_rpg_item_weapon] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_rpg_item_skill] 
(
    [status] varchar (255)
    , [third_party_oembed] varchar (500)
    , [code] varchar (255)
    , [description] varchar (255)
    , [game_defense] decimal
    , [third_party_url] varchar (500)
    , [third_party_id] varchar (500)
    , [content_type] varchar (100)
    , [type] varchar (500)
    , [active] bit
                CONSTRAINT DF_game_rpg_item_skill_active_bool DEFAULT 1
    , [game_id] uniqueidentifier
    , [game_attack] decimal
    , [uuid] uniqueidentifier NOT NULL
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_rpg_item_skill_date_modified DEFAULT GETDATE()
    , [url] varchar (500)
    , [third_party_data] varchar (500)
    , [game_price] decimal
    , [game_type] decimal
    , [game_skill] decimal
    , [game_health] decimal
    , [date_created] DATETIME
                CONSTRAINT DF_game_rpg_item_skill_date_created DEFAULT GETDATE()
    , [game_energy] decimal
    , [game_data] ntext
)
GO
ALTER TABLE [dbo].[game_rpg_item_skill] ADD 
    CONSTRAINT [PK_game_rpg_item_skill] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_product] 
(
    [status] varchar (255)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_product_date_modified DEFAULT GETDATE()
    , [url] varchar (255)
    , [uuid] uniqueidentifier NOT NULL
    , [game_id] varchar (100)
    , [active] bit
                CONSTRAINT DF_game_product_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_product_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_product] ADD 
    CONSTRAINT [PK_game_product] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_statistic_leaderboard] 
(
    [status] varchar (255)
    , [username] varchar (500)
    , [key] uniqueidentifier
    , [stat_value_formatted] varchar (500)
    , [profile_id] uniqueidentifier
    , [rank] int
    , [rank_change] int
    , [game_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_game_statistic_leaderboard_active_bool DEFAULT 1
    , [rank_total_count] int
    , [data] ntext
    , [stat_value] float
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_game_statistic_leaderboard_date_modified DEFAULT GETDATE()
    , [level] varchar (500)
    , [timestamp] float
    , [date_created] DATETIME
                CONSTRAINT DF_game_statistic_leaderboard_date_created DEFAULT GETDATE()
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[game_statistic_leaderboard] ADD 
    CONSTRAINT [PK_game_statistic_leaderboard] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_live_queue] 
(
    [status] varchar (255)
    , [data_stat] ntext
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_game_live_queue_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_game_live_queue_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_live_queue_date_created DEFAULT GETDATE()
    , [game_id] uniqueidentifier
    , [profile_id] uniqueidentifier
    , [type] varchar (500)
    , [data_ad] ntext
)
GO
ALTER TABLE [dbo].[game_live_queue] ADD 
    CONSTRAINT [PK_game_live_queue] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_live_recent_queue] 
(
    [status] varchar (255)
    , [username] varchar (500)
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_live_recent_queue_date_modified DEFAULT GETDATE()
    , [data] ntext
    , [profile_id] uniqueidentifier
    , [uuid] uniqueidentifier NOT NULL
    , [game] varchar (500)
    , [game_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_game_live_recent_queue_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_live_recent_queue_date_created DEFAULT GETDATE()
    , [type] varchar (500)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_live_recent_queue] ADD 
    CONSTRAINT [PK_game_live_recent_queue] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_statistic] 
(
    [status] varchar (255)
    , [username] varchar (500)
    , [timestamp] float
    , [profile_id] uniqueidentifier
    , [key] varchar (50)
    , [active] bit
                CONSTRAINT DF_game_statistic_active_bool DEFAULT 1
    , [game_id] uniqueidentifier
    , [data] ntext
    , [stat_value] float
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_game_statistic_date_modified DEFAULT GETDATE()
    , [level] varchar (500)
    , [date_created] DATETIME
                CONSTRAINT DF_game_statistic_date_created DEFAULT GETDATE()
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[game_statistic] ADD 
    CONSTRAINT [PK_game_statistic] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_statistic_meta] 
(
    [status] varchar (255)
    , [sort] int
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_statistic_meta_date_modified DEFAULT GETDATE()
    , [data] ntext
    , [uuid] uniqueidentifier NOT NULL
    , [store_count] int
    , [key] varchar (50)
    , [game_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_game_statistic_meta_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_statistic_meta_date_created DEFAULT GETDATE()
    , [type] varchar (40)
    , [order] varchar (40)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_statistic_meta] ADD 
    CONSTRAINT [PK_game_statistic_meta] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_statistic_timestamp] 
(
    [status] varchar (255)
    , [timestamp] DATETIME
                CONSTRAINT DF_game_statistic_timestamp_timestamp DEFAULT GETDATE()
    , [uuid] uniqueidentifier NOT NULL
    , [key] varchar (50)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_statistic_timestamp_date_modified DEFAULT GETDATE()
    , [active] bit
                CONSTRAINT DF_game_statistic_timestamp_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_statistic_timestamp_date_created DEFAULT GETDATE()
    , [game_id] uniqueidentifier
    , [profile_id] uniqueidentifier
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[game_statistic_timestamp] ADD 
    CONSTRAINT [PK_game_statistic_timestamp] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_key_meta] 
(
    [status] varchar (255)
    , [sort] int
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_key_meta_date_modified DEFAULT GETDATE()
    , [data] ntext
    , [level] varchar (500)
    , [uuid] uniqueidentifier NOT NULL
    , [key_level] varchar (50)
    , [store_count] int
    , [key] varchar (50)
    , [game_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_game_key_meta_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_key_meta_date_created DEFAULT GETDATE()
    , [type] varchar (40)
    , [order] varchar (40)
    , [key_stat] varchar (50)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_key_meta] ADD 
    CONSTRAINT [PK_game_key_meta] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_level] 
(
    [status] varchar (255)
    , [sort] int
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [date_modified] DATETIME
                CONSTRAINT DF_game_level_date_modified DEFAULT GETDATE()
    , [data] ntext
    , [uuid] uniqueidentifier NOT NULL
    , [key] varchar (50)
    , [game_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_game_level_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_level_date_created DEFAULT GETDATE()
    , [type] varchar (40)
    , [order] varchar (40)
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_level] ADD 
    CONSTRAINT [PK_game_level] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_achievement] 
(
    [status] varchar (255)
    , [username] varchar (500)
    , [timestamp] float
    , [completed] bit
                CONSTRAINT DF_game_achievement_completed_bool DEFAULT 1
    , [profile_id] uniqueidentifier
    , [key] varchar (50)
    , [active] bit
                CONSTRAINT DF_game_achievement_active_bool DEFAULT 1
    , [game_id] uniqueidentifier
    , [achievement_value] decimal
    , [data] ntext
    , [uuid] uniqueidentifier NOT NULL
    , [date_modified] DATETIME
                CONSTRAINT DF_game_achievement_date_modified DEFAULT GETDATE()
    , [level] varchar (500)
    , [date_created] DATETIME
                CONSTRAINT DF_game_achievement_date_created DEFAULT GETDATE()
    , [type] varchar (500)
)
GO
ALTER TABLE [dbo].[game_achievement] ADD 
    CONSTRAINT [PK_game_achievement] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO
CREATE TABLE [dbo].[game_achievement_meta] 
(
    [status] varchar (255)
    , [sort] int
    , [code] varchar (255)
    , [display_name] varchar (255)
    , [name] varchar (255)
    , [game_stat] bit
                CONSTRAINT DF_game_achievement_meta_game_stat_bool DEFAULT 1
    , [date_modified] DATETIME
                CONSTRAINT DF_game_achievement_meta_date_modified DEFAULT GETDATE()
    , [data] ntext
    , [level] varchar (500)
    , [uuid] uniqueidentifier NOT NULL
    , [points] int
    , [key] varchar (50)
    , [game_id] uniqueidentifier
    , [active] bit
                CONSTRAINT DF_game_achievement_meta_active_bool DEFAULT 1
    , [date_created] DATETIME
                CONSTRAINT DF_game_achievement_meta_date_created DEFAULT GETDATE()
    , [type] varchar (40)
    , [leaderboard] bit
                CONSTRAINT DF_game_achievement_meta_leaderboard_bool DEFAULT 1
    , [description] varchar (255)
)
GO
ALTER TABLE [dbo].[game_achievement_meta] ADD 
    CONSTRAINT [PK_game_achievement_meta] PRIMARY KEY CLUSTERED 
    (
            [uuid]
    )
GO

   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[content_page]') AND name = N'IX_content_page_path')
DROP INDEX [IX_content_page_path] ON [dbo].[content_page]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[content_page]') AND name = N'IX_content_page_path_site_id')
DROP INDEX [IX_content_page_path_site_id] ON [dbo].[content_page]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[profile_game_data_attribute]') AND name = N'IX_profile_game_data_attribute_uuid')
DROP INDEX [IX_profile_game_data_attribute_uuid] ON [dbo].[profile_game_data_attribute]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[profile_game_data_attribute]') AND name = N'IX_profile_game_data_attribute_profile_id')
DROP INDEX [IX_profile_game_data_attribute_profile_id] ON [dbo].[profile_game_data_attribute]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[profile_game_data_attribute]') AND name = N'IX_profile_game_data_attribute_profile_id_game_id')
DROP INDEX [IX_profile_game_data_attribute_profile_id_game_id] ON [dbo].[profile_game_data_attribute]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[profile_game_data_attribute]') AND name = N'IX_profile_game_data_attribute_profile_id_game_id_code')
DROP INDEX [IX_profile_game_data_attribute_profile_id_game_id_code] ON [dbo].[profile_game_data_attribute]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key')
DROP INDEX [IX_game_statistic_leaderboard_key] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_profile_id')
DROP INDEX [IX_game_statistic_leaderboard_profile_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_username')
DROP INDEX [IX_game_statistic_leaderboard_username] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_game_id')
DROP INDEX [IX_game_statistic_leaderboard_game_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_game_id_level')
DROP INDEX [IX_game_statistic_leaderboard_key_game_id_level] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_profile_id_game_id')
DROP INDEX [IX_game_statistic_leaderboard_profile_id_game_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_username_game_id')
DROP INDEX [IX_game_statistic_leaderboard_username_game_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_username')
DROP INDEX [IX_game_statistic_leaderboard_key_username] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_username_game_id')
DROP INDEX [IX_game_statistic_leaderboard_key_username_game_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_username_game_id_type')
DROP INDEX [IX_game_statistic_leaderboard_key_username_game_id_type] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_profile_id')
DROP INDEX [IX_game_statistic_leaderboard_key_profile_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_profile_id_game_id')
DROP INDEX [IX_game_statistic_leaderboard_key_profile_id_game_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_profile_id_game_id_type')
DROP INDEX [IX_game_statistic_leaderboard_key_profile_id_game_id_type] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_game_id')
DROP INDEX [IX_game_statistic_leaderboard_key_game_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_game_id_profile_id')
DROP INDEX [IX_game_statistic_leaderboard_key_game_id_profile_id] ON [dbo].[game_statistic_leaderboard]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_leaderboard]') AND name = N'IX_game_statistic_leaderboard_key_game_id_type')
DROP INDEX [IX_game_statistic_leaderboard_key_game_id_type] ON [dbo].[game_statistic_leaderboard]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_live_queue]') AND name = N'IX_game_live_queue_profile_id')
DROP INDEX [IX_game_live_queue_profile_id] ON [dbo].[game_live_queue]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_live_queue]') AND name = N'IX_game_live_queue_game_id')
DROP INDEX [IX_game_live_queue_game_id] ON [dbo].[game_live_queue]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_live_queue]') AND name = N'IX_game_live_queue_profile_id_game_id')
DROP INDEX [IX_game_live_queue_profile_id_game_id] ON [dbo].[game_live_queue]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_live_recent_queue]') AND name = N'IX_game_live_recent_queue_profile_id')
DROP INDEX [IX_game_live_recent_queue_profile_id] ON [dbo].[game_live_recent_queue]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_live_recent_queue]') AND name = N'IX_game_live_recent_queue_game_id')
DROP INDEX [IX_game_live_recent_queue_game_id] ON [dbo].[game_live_recent_queue]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_live_recent_queue]') AND name = N'IX_game_live_recent_queue_profile_id_game_id')
DROP INDEX [IX_game_live_recent_queue_profile_id_game_id] ON [dbo].[game_live_recent_queue]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key')
DROP INDEX [IX_game_statistic_key] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_profile_id')
DROP INDEX [IX_game_statistic_profile_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_username')
DROP INDEX [IX_game_statistic_username] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_game_id')
DROP INDEX [IX_game_statistic_game_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_game_id')
DROP INDEX [IX_game_statistic_key_game_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_game_id_level')
DROP INDEX [IX_game_statistic_key_game_id_level] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_profile_id_game_id')
DROP INDEX [IX_game_statistic_profile_id_game_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_username_game_id')
DROP INDEX [IX_game_statistic_username_game_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_username')
DROP INDEX [IX_game_statistic_key_username] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_username_game_id')
DROP INDEX [IX_game_statistic_key_username_game_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_username_game_id_type')
DROP INDEX [IX_game_statistic_key_username_game_id_type] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_profile_id')
DROP INDEX [IX_game_statistic_key_profile_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_profile_id_game_id')
DROP INDEX [IX_game_statistic_key_profile_id_game_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_profile_id_game_id_type')
DROP INDEX [IX_game_statistic_key_profile_id_game_id_type] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_game_id_profile_id')
DROP INDEX [IX_game_statistic_key_game_id_profile_id] ON [dbo].[game_statistic]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic]') AND name = N'IX_game_statistic_key_game_id_type')
DROP INDEX [IX_game_statistic_key_game_id_type] ON [dbo].[game_statistic]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_meta]') AND name = N'IX_game_statistic_meta_key')
DROP INDEX [IX_game_statistic_meta_key] ON [dbo].[game_statistic_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_meta]') AND name = N'IX_game_statistic_meta_game_id')
DROP INDEX [IX_game_statistic_meta_game_id] ON [dbo].[game_statistic_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_meta]') AND name = N'IX_game_statistic_meta_key_game_id')
DROP INDEX [IX_game_statistic_meta_key_game_id] ON [dbo].[game_statistic_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_meta]') AND name = N'IX_game_statistic_meta_key_type')
DROP INDEX [IX_game_statistic_meta_key_type] ON [dbo].[game_statistic_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_meta]') AND name = N'IX_game_statistic_meta_game_id_type')
DROP INDEX [IX_game_statistic_meta_game_id_type] ON [dbo].[game_statistic_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_meta]') AND name = N'IX_game_statistic_meta_key_game_id_type')
DROP INDEX [IX_game_statistic_meta_key_game_id_type] ON [dbo].[game_statistic_meta]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_statistic_timestamp]') AND name = N'IX_game_statistic_timestamp_key_profile_id_game_id_timestamp')
DROP INDEX [IX_game_statistic_timestamp_key_profile_id_game_id_timestamp] ON [dbo].[game_statistic_timestamp]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_key')
DROP INDEX [IX_game_key_meta_key] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_game_id')
DROP INDEX [IX_game_key_meta_game_id] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_key_stat_key_level_game_id')
DROP INDEX [IX_game_key_meta_key_stat_key_level_game_id] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_key_stat_key_level_game_id_level')
DROP INDEX [IX_game_key_meta_key_stat_key_level_game_id_level] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_key_stat_key_level_type')
DROP INDEX [IX_game_key_meta_key_stat_key_level_type] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_key_game_id')
DROP INDEX [IX_game_key_meta_key_game_id] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_key_game_id_level')
DROP INDEX [IX_game_key_meta_key_game_id_level] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_key_type')
DROP INDEX [IX_game_key_meta_key_type] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_game_id_type')
DROP INDEX [IX_game_key_meta_game_id_type] ON [dbo].[game_key_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_key_meta]') AND name = N'IX_game_key_meta_key_game_id_type')
DROP INDEX [IX_game_key_meta_key_game_id_type] ON [dbo].[game_key_meta]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_level]') AND name = N'IX_game_level_key')
DROP INDEX [IX_game_level_key] ON [dbo].[game_level]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_level]') AND name = N'IX_game_level_key_game_id')
DROP INDEX [IX_game_level_key_game_id] ON [dbo].[game_level]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_level]') AND name = N'IX_game_level_key_game_id_type')
DROP INDEX [IX_game_level_key_game_id_type] ON [dbo].[game_level]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key')
DROP INDEX [IX_game_achievement_key] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_profile_id')
DROP INDEX [IX_game_achievement_profile_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_username')
DROP INDEX [IX_game_achievement_username] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_game_id')
DROP INDEX [IX_game_achievement_game_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_game_id')
DROP INDEX [IX_game_achievement_key_game_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_game_id_level')
DROP INDEX [IX_game_achievement_key_game_id_level] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_profile_id_game_id')
DROP INDEX [IX_game_achievement_profile_id_game_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_username_game_id')
DROP INDEX [IX_game_achievement_username_game_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_username')
DROP INDEX [IX_game_achievement_key_username] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_username_game_id')
DROP INDEX [IX_game_achievement_key_username_game_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_username_game_id_type')
DROP INDEX [IX_game_achievement_key_username_game_id_type] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_profile_id')
DROP INDEX [IX_game_achievement_key_profile_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_profile_id_game_id')
DROP INDEX [IX_game_achievement_key_profile_id_game_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_profile_id_game_id_type')
DROP INDEX [IX_game_achievement_key_profile_id_game_id_type] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_game_id_profile_id')
DROP INDEX [IX_game_achievement_key_game_id_profile_id] ON [dbo].[game_achievement]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement]') AND name = N'IX_game_achievement_key_game_id_type')
DROP INDEX [IX_game_achievement_key_game_id_type] ON [dbo].[game_achievement]
GO
   
-- -----------------------------------------------------------------------------
-- INDEXES

-- INDEX DROPS        
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement_meta]') AND name = N'IX_game_achievement_meta_key')
DROP INDEX [IX_game_achievement_meta_key] ON [dbo].[game_achievement_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement_meta]') AND name = N'IX_game_achievement_meta_game_id')
DROP INDEX [IX_game_achievement_meta_game_id] ON [dbo].[game_achievement_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement_meta]') AND name = N'IX_game_achievement_meta_key_game_id')
DROP INDEX [IX_game_achievement_meta_key_game_id] ON [dbo].[game_achievement_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement_meta]') AND name = N'IX_game_achievement_meta_key_game_id_level')
DROP INDEX [IX_game_achievement_meta_key_game_id_level] ON [dbo].[game_achievement_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement_meta]') AND name = N'IX_game_achievement_meta_key_type')
DROP INDEX [IX_game_achievement_meta_key_type] ON [dbo].[game_achievement_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement_meta]') AND name = N'IX_game_achievement_meta_game_id_type')
DROP INDEX [IX_game_achievement_meta_game_id_type] ON [dbo].[game_achievement_meta]
GO
-- -----------------------------------------------------------------------------                
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[game_achievement_meta]') AND name = N'IX_game_achievement_meta_key_game_id_type')
DROP INDEX [IX_game_achievement_meta_key_game_id_type] ON [dbo].[game_achievement_meta]
GO

        
-- INDEX CREATES

        
-- INDEX CREATES

        
-- INDEX CREATES

        
-- INDEX CREATES

        
        
-- INDEX CREATES

        
        
-- INDEX CREATES

        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_content_page_path] ON [dbo].[content_page] 
(
                    
    [path] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_content_page_path_site_id] ON [dbo].[content_page] 
(
                    
    [path] ASC
                    
    , [site_id] ASC
)
GO
        
-- INDEX CREATES

        
-- INDEX CREATES

        
        
        
        
        
-- INDEX CREATES

        
-- INDEX CREATES

        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_profile_game_data_attribute_uuid] ON [dbo].[profile_game_data_attribute] 
(
                    
    [uuid] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_profile_game_data_attribute_profile_id] ON [dbo].[profile_game_data_attribute] 
(
                    
    [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_profile_game_data_attribute_profile_id_game_id] ON [dbo].[profile_game_data_attribute] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_profile_game_data_attribute_profile_id_game_id_code] ON [dbo].[profile_game_data_attribute] 
(
                    
    [code] ASC
                    
    , [game_id] ASC
                    
    , [profile_id] ASC
)
GO
        
-- INDEX CREATES

        
-- INDEX CREATES

        
-- INDEX CREATES

        
-- INDEX CREATES

        
        
        
        
-- INDEX CREATES

        
        
        
        
-- INDEX CREATES

        
        
-- INDEX CREATES

        
        
        
        
        
        
        
        
-- INDEX CREATES

        
-- INDEX CREATES

        
-- INDEX CREATES

        
        
        
        
        
        
        
        
        
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_profile_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_username] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [username] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_game_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_game_id_level] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
                    
    , [level] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_profile_id_game_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_username_game_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_username] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [username] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_username_game_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_username_game_id_type] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_profile_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_profile_id_game_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_profile_id_game_id_type] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_game_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_game_id_profile_id] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_leaderboard_key_game_id_type] ON [dbo].[game_statistic_leaderboard] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_live_queue_profile_id] ON [dbo].[game_live_queue] 
(
                    
    [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_live_queue_game_id] ON [dbo].[game_live_queue] 
(
                    
    [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_live_queue_profile_id_game_id] ON [dbo].[game_live_queue] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_live_recent_queue_profile_id] ON [dbo].[game_live_recent_queue] 
(
                    
    [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_live_recent_queue_game_id] ON [dbo].[game_live_recent_queue] 
(
                    
    [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_live_recent_queue_profile_id_game_id] ON [dbo].[game_live_recent_queue] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_statistic_key] ON [dbo].[game_statistic] 
(
                    
    [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_profile_id] ON [dbo].[game_statistic] 
(
                    
    [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_username] ON [dbo].[game_statistic] 
(
                    
    [username] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_game_id] ON [dbo].[game_statistic] 
(
                    
    [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_game_id] ON [dbo].[game_statistic] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_game_id_level] ON [dbo].[game_statistic] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
                    
    , [level] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_profile_id_game_id] ON [dbo].[game_statistic] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_username_game_id] ON [dbo].[game_statistic] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_username] ON [dbo].[game_statistic] 
(
                    
    [username] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_username_game_id] ON [dbo].[game_statistic] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_username_game_id_type] ON [dbo].[game_statistic] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_profile_id] ON [dbo].[game_statistic] 
(
                    
    [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_profile_id_game_id] ON [dbo].[game_statistic] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_profile_id_game_id_type] ON [dbo].[game_statistic] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_game_id_profile_id] ON [dbo].[game_statistic] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_key_game_id_type] ON [dbo].[game_statistic] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_statistic_meta_key] ON [dbo].[game_statistic_meta] 
(
                    
    [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_meta_game_id] ON [dbo].[game_statistic_meta] 
(
                    
    [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_meta_key_game_id] ON [dbo].[game_statistic_meta] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_meta_key_type] ON [dbo].[game_statistic_meta] 
(
                    
    [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_meta_game_id_type] ON [dbo].[game_statistic_meta] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_statistic_meta_key_game_id_type] ON [dbo].[game_statistic_meta] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_statistic_timestamp_key_profile_id_game_id_timestamp] ON [dbo].[game_statistic_timestamp] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [key] ASC
                    
    , [timestamp] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_key_meta_key] ON [dbo].[game_key_meta] 
(
                    
    [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_game_id] ON [dbo].[game_key_meta] 
(
                    
    [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_key_stat_key_level_game_id] ON [dbo].[game_key_meta] 
(
                    
    [game_id] ASC
                    
    , [key_level] ASC
                    
    , [key_stat] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_key_stat_key_level_game_id_level] ON [dbo].[game_key_meta] 
(
                    
    [game_id] ASC
                    
    , [key_level] ASC
                    
    , [key_stat] ASC
                    
    , [level] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_key_stat_key_level_type] ON [dbo].[game_key_meta] 
(
                    
    [key_level] ASC
                    
    , [type] ASC
                    
    , [key_stat] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_key_game_id] ON [dbo].[game_key_meta] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_key_game_id_level] ON [dbo].[game_key_meta] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
                    
    , [level] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_key_type] ON [dbo].[game_key_meta] 
(
                    
    [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_game_id_type] ON [dbo].[game_key_meta] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_key_meta_key_game_id_type] ON [dbo].[game_key_meta] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_level_key] ON [dbo].[game_level] 
(
                    
    [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_level_key_game_id] ON [dbo].[game_level] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_level_key_game_id_type] ON [dbo].[game_level] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_achievement_key] ON [dbo].[game_achievement] 
(
                    
    [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_profile_id] ON [dbo].[game_achievement] 
(
                    
    [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_username] ON [dbo].[game_achievement] 
(
                    
    [username] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_game_id] ON [dbo].[game_achievement] 
(
                    
    [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_game_id] ON [dbo].[game_achievement] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_game_id_level] ON [dbo].[game_achievement] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
                    
    , [level] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_profile_id_game_id] ON [dbo].[game_achievement] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_username_game_id] ON [dbo].[game_achievement] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_username] ON [dbo].[game_achievement] 
(
                    
    [username] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_username_game_id] ON [dbo].[game_achievement] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_username_game_id_type] ON [dbo].[game_achievement] 
(
                    
    [username] ASC
                    
    , [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_profile_id] ON [dbo].[game_achievement] 
(
                    
    [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_profile_id_game_id] ON [dbo].[game_achievement] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_profile_id_game_id_type] ON [dbo].[game_achievement] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_game_id_profile_id] ON [dbo].[game_achievement] 
(
                    
    [game_id] ASC
                    
    , [profile_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_key_game_id_type] ON [dbo].[game_achievement] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO
        
-- INDEX CREATES

CREATE NONCLUSTERED INDEX [IX_game_achievement_meta_key] ON [dbo].[game_achievement_meta] 
(
                    
    [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_meta_game_id] ON [dbo].[game_achievement_meta] 
(
                    
    [game_id] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_meta_key_game_id] ON [dbo].[game_achievement_meta] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_meta_key_game_id_level] ON [dbo].[game_achievement_meta] 
(
                    
    [game_id] ASC
                    
    , [key] ASC
                    
    , [level] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_meta_key_type] ON [dbo].[game_achievement_meta] 
(
                    
    [type] ASC
                    
    , [key] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_meta_game_id_type] ON [dbo].[game_achievement_meta] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
)
GO
CREATE NONCLUSTERED INDEX [IX_game_achievement_meta_key_game_id_type] ON [dbo].[game_achievement_meta] 
(
                    
    [game_id] ASC
                    
    , [type] ASC
                    
    , [key] ASC
)
GO

-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: App - app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_count]

GO

CREATE PROCEDURE usp_app_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_count_by_uuid]

GO

CREATE PROCEDURE usp_app_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_count_by_code]

GO

CREATE PROCEDURE usp_app_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_count_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_count_by_type_id]

GO

CREATE PROCEDURE usp_app_count_by_type_id
(
    @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_count_by_code_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_count_by_code_by_type_id]

GO

CREATE PROCEDURE usp_app_count_by_code_by_type_id
(
    @code varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_count_by_platform_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_count_by_platform_by_type_id]

GO

CREATE PROCEDURE usp_app_count_by_platform_by_type_id
(
    @platform varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app]
    WHERE 1=1
    AND LOWER([platform]) = LOWER(@platform)
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_count_by_platform]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_count_by_platform]

GO

CREATE PROCEDURE usp_app_count_by_platform
(
    @platform varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app]
    WHERE 1=1
    AND LOWER([platform]) = LOWER(@platform)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: App - app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_browse_by_filter]

GO

CREATE PROCEDURE usp_app_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [platform]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[app] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: App - app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_set_by_uuid]

GO

CREATE PROCEDURE usp_app_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[app]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[app] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[app]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [uuid]
                    , [platform]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @uuid
                    , @platform
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_set_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_set_by_code]

GO

CREATE PROCEDURE usp_app_set_by_code
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[app]  
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[app] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[app]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [uuid]
                    , [platform]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @uuid
                    , @platform
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: App - app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_del_by_uuid]

GO

CREATE PROCEDURE usp_app_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[app]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_del_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_del_by_code]

GO

CREATE PROCEDURE usp_app_del_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[app]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: App - app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_get]

GO

CREATE PROCEDURE usp_app_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [platform]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_get_by_uuid]

GO

CREATE PROCEDURE usp_app_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [platform]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_get_by_code]

GO

CREATE PROCEDURE usp_app_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [platform]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_get_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_get_by_type_id]

GO

CREATE PROCEDURE usp_app_get_by_type_id
(
    @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [platform]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_get_by_code_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_get_by_code_by_type_id]

GO

CREATE PROCEDURE usp_app_get_by_code_by_type_id
(
    @code varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [platform]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_get_by_platform_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_get_by_platform_by_type_id]

GO

CREATE PROCEDURE usp_app_get_by_platform_by_type_id
(
    @platform varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [platform]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app]
    WHERE 1=1
    AND LOWER([platform]) = LOWER(@platform)
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_get_by_platform]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_get_by_platform]

GO

CREATE PROCEDURE usp_app_get_by_platform
(
    @platform varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [platform]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app]
    WHERE 1=1
    AND LOWER([platform]) = LOWER(@platform)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: AppType - app_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_count]

GO

CREATE PROCEDURE usp_app_type_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_count_by_uuid]

GO

CREATE PROCEDURE usp_app_type_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_count_by_code]

GO

CREATE PROCEDURE usp_app_type_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[app_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: AppType - app_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_browse_by_filter]

GO

CREATE PROCEDURE usp_app_type_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[app_type] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: AppType - app_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_set_by_uuid]

GO

CREATE PROCEDURE usp_app_type_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[app_type]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[app_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[app_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_set_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_set_by_code]

GO

CREATE PROCEDURE usp_app_type_set_by_code
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[app_type]  
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[app_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[app_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: AppType - app_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_del_by_uuid]

GO

CREATE PROCEDURE usp_app_type_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[app_type]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_del_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_del_by_code]

GO

CREATE PROCEDURE usp_app_type_del_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[app_type]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: AppType - app_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_get]

GO

CREATE PROCEDURE usp_app_type_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_get_by_uuid]

GO

CREATE PROCEDURE usp_app_type_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_app_type_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_app_type_get_by_code]

GO

CREATE PROCEDURE usp_app_type_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[app_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Site - site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_count]

GO

CREATE PROCEDURE usp_site_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_count_by_uuid]

GO

CREATE PROCEDURE usp_site_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_count_by_code]

GO

CREATE PROCEDURE usp_site_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_count_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_count_by_type_id]

GO

CREATE PROCEDURE usp_site_count_by_type_id
(
    @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_count_by_code_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_count_by_code_by_type_id]

GO

CREATE PROCEDURE usp_site_count_by_code_by_type_id
(
    @code varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_count_by_domain_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_count_by_domain_by_type_id]

GO

CREATE PROCEDURE usp_site_count_by_domain_by_type_id
(
    @domain varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site]
    WHERE 1=1
    AND LOWER([domain]) = LOWER(@domain)
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_count_by_domain]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_count_by_domain]

GO

CREATE PROCEDURE usp_site_count_by_domain
(
    @domain varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site]
    WHERE 1=1
    AND LOWER([domain]) = LOWER(@domain)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Site - site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_browse_by_filter]

GO

CREATE PROCEDURE usp_site_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [domain]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[site] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Site - site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_set_by_uuid]

GO

CREATE PROCEDURE usp_site_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @domain varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[site]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[site] 
                SET
                    [status] = @status
                    , [domain] = @domain
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[site]
                (
                    [status]
                    , [domain]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @domain
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_set_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_set_by_code]

GO

CREATE PROCEDURE usp_site_set_by_code
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @domain varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[site]  
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[site] 
                SET
                    [status] = @status
                    , [domain] = @domain
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[site]
                (
                    [status]
                    , [domain]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @domain
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Site - site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_del_by_uuid]

GO

CREATE PROCEDURE usp_site_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[site]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_del_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_del_by_code]

GO

CREATE PROCEDURE usp_site_del_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[site]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Site - site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_get]

GO

CREATE PROCEDURE usp_site_get
AS
BEGIN
    SELECT
        [status]
        , [domain]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_get_by_uuid]

GO

CREATE PROCEDURE usp_site_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [domain]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_get_by_code]

GO

CREATE PROCEDURE usp_site_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [domain]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_get_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_get_by_type_id]

GO

CREATE PROCEDURE usp_site_get_by_type_id
(
    @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [domain]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_get_by_code_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_get_by_code_by_type_id]

GO

CREATE PROCEDURE usp_site_get_by_code_by_type_id
(
    @code varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [domain]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_get_by_domain_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_get_by_domain_by_type_id]

GO

CREATE PROCEDURE usp_site_get_by_domain_by_type_id
(
    @domain varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [domain]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site]
    WHERE 1=1
    AND LOWER([domain]) = LOWER(@domain)
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_get_by_domain]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_get_by_domain]

GO

CREATE PROCEDURE usp_site_get_by_domain
(
    @domain varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [domain]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site]
    WHERE 1=1
    AND LOWER([domain]) = LOWER(@domain)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: SiteType - site_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_count]

GO

CREATE PROCEDURE usp_site_type_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_count_by_uuid]

GO

CREATE PROCEDURE usp_site_type_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_count_by_code]

GO

CREATE PROCEDURE usp_site_type_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: SiteType - site_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_browse_by_filter]

GO

CREATE PROCEDURE usp_site_type_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[site_type] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: SiteType - site_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_set_by_uuid]

GO

CREATE PROCEDURE usp_site_type_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[site_type]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[site_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[site_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_set_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_set_by_code]

GO

CREATE PROCEDURE usp_site_type_set_by_code
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[site_type]  
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[site_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[site_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: SiteType - site_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_del_by_uuid]

GO

CREATE PROCEDURE usp_site_type_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[site_type]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_del_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_del_by_code]

GO

CREATE PROCEDURE usp_site_type_del_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[site_type]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: SiteType - site_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_get]

GO

CREATE PROCEDURE usp_site_type_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_get_by_uuid]

GO

CREATE PROCEDURE usp_site_type_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_type_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_type_get_by_code]

GO

CREATE PROCEDURE usp_site_type_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[site_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Org - org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_count]

GO

CREATE PROCEDURE usp_org_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_count_by_uuid]

GO

CREATE PROCEDURE usp_org_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_count_by_code]

GO

CREATE PROCEDURE usp_org_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_count_by_name]

GO

CREATE PROCEDURE usp_org_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Org - org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_browse_by_filter]

GO

CREATE PROCEDURE usp_org_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[org] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Org - org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_set_by_uuid]

GO

CREATE PROCEDURE usp_org_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[org]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[org] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[org]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Org - org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_del_by_uuid]

GO

CREATE PROCEDURE usp_org_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[org]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Org - org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_get]

GO

CREATE PROCEDURE usp_org_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[org]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_get_by_uuid]

GO

CREATE PROCEDURE usp_org_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[org]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_get_by_code]

GO

CREATE PROCEDURE usp_org_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[org]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_get_by_name]

GO

CREATE PROCEDURE usp_org_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[org]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: OrgType - org_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_count]

GO

CREATE PROCEDURE usp_org_type_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_count_by_uuid]

GO

CREATE PROCEDURE usp_org_type_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_count_by_code]

GO

CREATE PROCEDURE usp_org_type_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: OrgType - org_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_browse_by_filter]

GO

CREATE PROCEDURE usp_org_type_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[org_type] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: OrgType - org_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_set_by_uuid]

GO

CREATE PROCEDURE usp_org_type_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[org_type]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[org_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[org_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_set_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_set_by_code]

GO

CREATE PROCEDURE usp_org_type_set_by_code
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[org_type]  
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[org_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[org_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: OrgType - org_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_del_by_uuid]

GO

CREATE PROCEDURE usp_org_type_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[org_type]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_del_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_del_by_code]

GO

CREATE PROCEDURE usp_org_type_del_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[org_type]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: OrgType - org_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_get]

GO

CREATE PROCEDURE usp_org_type_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[org_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_get_by_uuid]

GO

CREATE PROCEDURE usp_org_type_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[org_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_type_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_type_get_by_code]

GO

CREATE PROCEDURE usp_org_type_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[org_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ContentItem - content_item
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_count]

GO

CREATE PROCEDURE usp_content_item_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_item]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_count_by_uuid]

GO

CREATE PROCEDURE usp_content_item_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_item]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_count_by_code]

GO

CREATE PROCEDURE usp_content_item_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_item]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_count_by_name]

GO

CREATE PROCEDURE usp_content_item_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_item]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_count_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_count_by_path]

GO

CREATE PROCEDURE usp_content_item_count_by_path
(
    @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_item]
    WHERE 1=1
    AND LOWER([path]) = LOWER(@path)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ContentItem - content_item
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_browse_by_filter]

GO

CREATE PROCEDURE usp_content_item_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [date_end]'
    SET @sql = @sql + ', [date_start]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [path]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[content_item] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ContentItem - content_item
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_set_by_uuid]

GO

CREATE PROCEDURE usp_content_item_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @date_end DATETIME = GETDATE
    , @date_start DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @path varchar (500) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[content_item]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[content_item] 
                SET
                    [status] = @status
                    , [type_id] = @type_id
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [date_end] = @date_end
                    , [date_start] = @date_start
                    , [uuid] = @uuid
                    , [path] = @path
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[content_item]
                (
                    [status]
                    , [type_id]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [date_end]
                    , [date_start]
                    , [uuid]
                    , [path]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @type_id
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @date_end
                    , @date_start
                    , @uuid
                    , @path
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ContentItem - content_item
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_del_by_uuid]

GO

CREATE PROCEDURE usp_content_item_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[content_item]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_del_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_del_by_path]

GO

CREATE PROCEDURE usp_content_item_del_by_path
(
    @path varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[content_item]
    WHERE 1=1                        
    AND LOWER([path]) = LOWER(@path)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ContentItem - content_item
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_get]

GO

CREATE PROCEDURE usp_content_item_get
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [date_end]
        , [date_start]
        , [uuid]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_item]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_get_by_uuid]

GO

CREATE PROCEDURE usp_content_item_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [date_end]
        , [date_start]
        , [uuid]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_item]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_get_by_code]

GO

CREATE PROCEDURE usp_content_item_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [date_end]
        , [date_start]
        , [uuid]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_item]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_get_by_name]

GO

CREATE PROCEDURE usp_content_item_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [date_end]
        , [date_start]
        , [uuid]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_item]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_get_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_get_by_path]

GO

CREATE PROCEDURE usp_content_item_get_by_path
(
    @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [date_end]
        , [date_start]
        , [uuid]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_item]
    WHERE 1=1
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ContentItemType - content_item_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_count]

GO

CREATE PROCEDURE usp_content_item_type_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_item_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_count_by_uuid]

GO

CREATE PROCEDURE usp_content_item_type_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_item_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_count_by_code]

GO

CREATE PROCEDURE usp_content_item_type_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_item_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ContentItemType - content_item_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_browse_by_filter]

GO

CREATE PROCEDURE usp_content_item_type_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[content_item_type] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ContentItemType - content_item_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_set_by_uuid]

GO

CREATE PROCEDURE usp_content_item_type_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[content_item_type]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[content_item_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[content_item_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_set_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_set_by_code]

GO

CREATE PROCEDURE usp_content_item_type_set_by_code
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[content_item_type]  
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[content_item_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[content_item_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ContentItemType - content_item_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_del_by_uuid]

GO

CREATE PROCEDURE usp_content_item_type_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[content_item_type]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_del_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_del_by_code]

GO

CREATE PROCEDURE usp_content_item_type_del_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[content_item_type]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ContentItemType - content_item_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_get]

GO

CREATE PROCEDURE usp_content_item_type_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_item_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_get_by_uuid]

GO

CREATE PROCEDURE usp_content_item_type_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_item_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_item_type_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_item_type_get_by_code]

GO

CREATE PROCEDURE usp_content_item_type_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_item_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ContentPage - content_page
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_count]

GO

CREATE PROCEDURE usp_content_page_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_page]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_count_by_uuid]

GO

CREATE PROCEDURE usp_content_page_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_page]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_count_by_code]

GO

CREATE PROCEDURE usp_content_page_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_page]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_count_by_name]

GO

CREATE PROCEDURE usp_content_page_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_page]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_count_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_count_by_path]

GO

CREATE PROCEDURE usp_content_page_count_by_path
(
    @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[content_page]
    WHERE 1=1
    AND LOWER([path]) = LOWER(@path)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ContentPage - content_page
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_browse_by_filter]

GO

CREATE PROCEDURE usp_content_page_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [date_end]'
    SET @sql = @sql + ', [date_start]'
    SET @sql = @sql + ', [site_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [template]'
    SET @sql = @sql + ', [path]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[content_page] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ContentPage - content_page
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_set_by_uuid]

GO

CREATE PROCEDURE usp_content_page_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_end DATETIME = GETDATE
    , @date_start DATETIME = GETDATE
    , @site_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @template ntext = NULL
    , @path varchar (500) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[content_page]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[content_page] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [date_end] = @date_end
                    , [date_start] = @date_start
                    , [site_id] = @site_id
                    , [uuid] = @uuid
                    , [template] = @template
                    , [path] = @path
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[content_page]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [date_end]
                    , [date_start]
                    , [site_id]
                    , [uuid]
                    , [template]
                    , [path]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @date_end
                    , @date_start
                    , @site_id
                    , @uuid
                    , @template
                    , @path
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ContentPage - content_page
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_del_by_uuid]

GO

CREATE PROCEDURE usp_content_page_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[content_page]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_del_by_path_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_del_by_path_by_site_id]

GO

CREATE PROCEDURE usp_content_page_del_by_path_by_site_id
(
    @path varchar (500) = NULL
    , @site_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[content_page]
    WHERE 1=1                        
    AND LOWER([path]) = LOWER(@path)
    AND [site_id] = @site_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_del_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_del_by_path]

GO

CREATE PROCEDURE usp_content_page_del_by_path
(
    @path varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[content_page]
    WHERE 1=1                        
    AND LOWER([path]) = LOWER(@path)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ContentPage - content_page
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_get]

GO

CREATE PROCEDURE usp_content_page_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [date_end]
        , [date_start]
        , [site_id]
        , [uuid]
        , [template]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_page]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_get_by_uuid]

GO

CREATE PROCEDURE usp_content_page_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [date_end]
        , [date_start]
        , [site_id]
        , [uuid]
        , [template]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_page]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_get_by_code]

GO

CREATE PROCEDURE usp_content_page_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [date_end]
        , [date_start]
        , [site_id]
        , [uuid]
        , [template]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_page]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_get_by_name]

GO

CREATE PROCEDURE usp_content_page_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [date_end]
        , [date_start]
        , [site_id]
        , [uuid]
        , [template]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_page]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_get_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_get_by_path]

GO

CREATE PROCEDURE usp_content_page_get_by_path
(
    @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [date_end]
        , [date_start]
        , [site_id]
        , [uuid]
        , [template]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_page]
    WHERE 1=1
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_get_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_get_by_site_id]

GO

CREATE PROCEDURE usp_content_page_get_by_site_id
(
    @site_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [date_end]
        , [date_start]
        , [site_id]
        , [uuid]
        , [template]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_page]
    WHERE 1=1
    AND [site_id] = @site_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_content_page_get_by_site_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_content_page_get_by_site_id_by_path]

GO

CREATE PROCEDURE usp_content_page_get_by_site_id_by_path
(
    @site_id uniqueidentifier = NULL
    , @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [date_end]
        , [date_start]
        , [site_id]
        , [uuid]
        , [template]
        , [path]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[content_page]
    WHERE 1=1
    AND [site_id] = @site_id
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Message - message
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_message_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_message_count]

GO

CREATE PROCEDURE usp_message_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[message]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_message_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_message_count_by_uuid]

GO

CREATE PROCEDURE usp_message_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[message]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Message - message
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_message_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_message_browse_by_filter]

GO

CREATE PROCEDURE usp_message_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [profile_from_name]'
    SET @sql = @sql + ', [read]'
    SET @sql = @sql + ', [profile_from_id]'
    SET @sql = @sql + ', [profile_to_token]'
    SET @sql = @sql + ', [app_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [subject]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [profile_to_id]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [profile_to_name]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [sent]'

    SET @sql = @sql + ' FROM [dbo].[message] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Message - message
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_message_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_message_set_by_uuid]

GO

CREATE PROCEDURE usp_message_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @profile_from_name varchar (500) = NULL
    , @read bit = 1
    , @profile_from_id uniqueidentifier = NULL
    , @profile_to_token varchar (500) = NULL
    , @app_id uniqueidentifier = NULL
    , @active bit = NULL
    , @subject varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @profile_to_id uniqueidentifier = NULL
    , @date_created DATETIME = GETDATE
    , @profile_to_name varchar (500) = NULL
    , @type varchar (500) = NULL
    , @sent bit = 1
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[message]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[message] 
                SET
                    [status] = @status
                    , [profile_from_name] = @profile_from_name
                    , [read] = @read
                    , [profile_from_id] = @profile_from_id
                    , [profile_to_token] = @profile_to_token
                    , [app_id] = @app_id
                    , [active] = @active
                    , [subject] = @subject
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [profile_to_id] = @profile_to_id
                    , [date_created] = @date_created
                    , [profile_to_name] = @profile_to_name
                    , [type] = @type
                    , [sent] = @sent
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[message]
                (
                    [status]
                    , [profile_from_name]
                    , [read]
                    , [profile_from_id]
                    , [profile_to_token]
                    , [app_id]
                    , [active]
                    , [subject]
                    , [uuid]
                    , [date_modified]
                    , [profile_to_id]
                    , [date_created]
                    , [profile_to_name]
                    , [type]
                    , [sent]
                )
                VALUES
                (
                    @status
                    , @profile_from_name
                    , @read
                    , @profile_from_id
                    , @profile_to_token
                    , @app_id
                    , @active
                    , @subject
                    , @uuid
                    , @date_modified
                    , @profile_to_id
                    , @date_created
                    , @profile_to_name
                    , @type
                    , @sent
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Message - message
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_message_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_message_del_by_uuid]

GO

CREATE PROCEDURE usp_message_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[message]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Message - message
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_message_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_message_get]

GO

CREATE PROCEDURE usp_message_get
AS
BEGIN
    SELECT
        [status]
        , [profile_from_name]
        , [read]
        , [profile_from_id]
        , [profile_to_token]
        , [app_id]
        , [active]
        , [subject]
        , [uuid]
        , [date_modified]
        , [profile_to_id]
        , [date_created]
        , [profile_to_name]
        , [type]
        , [sent]
    FROM [dbo].[message]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_message_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_message_get_by_uuid]

GO

CREATE PROCEDURE usp_message_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_from_name]
        , [read]
        , [profile_from_id]
        , [profile_to_token]
        , [app_id]
        , [active]
        , [subject]
        , [uuid]
        , [date_modified]
        , [profile_to_id]
        , [date_created]
        , [profile_to_name]
        , [type]
        , [sent]
    FROM [dbo].[message]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Game - game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_count]

GO

CREATE PROCEDURE usp_game_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_count_by_uuid]

GO

CREATE PROCEDURE usp_game_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_count_by_code]

GO

CREATE PROCEDURE usp_game_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_count_by_name]

GO

CREATE PROCEDURE usp_game_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_count_by_org_id]

GO

CREATE PROCEDURE usp_game_count_by_org_id
(
    @org_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_count_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_count_by_app_id]

GO

CREATE PROCEDURE usp_game_count_by_app_id
(
    @app_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game]
    WHERE 1=1
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_count_by_org_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_count_by_org_id_by_app_id]

GO

CREATE PROCEDURE usp_game_count_by_org_id_by_app_id
(
    @org_id uniqueidentifier = NULL
    , @app_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [app_id] = @app_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Game - game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_browse_by_filter]

GO

CREATE PROCEDURE usp_game_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [app_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Game - game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_set_by_uuid]

GO

CREATE PROCEDURE usp_game_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @app_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [app_id] = @app_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [org_id]
                    , [uuid]
                    , [app_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @org_id
                    , @uuid
                    , @app_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_set_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_set_by_code]

GO

CREATE PROCEDURE usp_game_set_by_code
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @app_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game]  
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [app_id] = @app_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [org_id]
                    , [uuid]
                    , [app_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @org_id
                    , @uuid
                    , @app_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_set_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_set_by_name]

GO

CREATE PROCEDURE usp_game_set_by_name
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @app_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game]  
                WHERE 1=1
                AND LOWER([name]) = LOWER(@name)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [app_id] = @app_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([name]) = LOWER(@name)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [org_id]
                    , [uuid]
                    , [app_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @org_id
                    , @uuid
                    , @app_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_set_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_set_by_org_id]

GO

CREATE PROCEDURE usp_game_set_by_org_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @app_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game]  
                WHERE 1=1
                AND [org_id] = @org_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [app_id] = @app_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [org_id] = @org_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [org_id]
                    , [uuid]
                    , [app_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @org_id
                    , @uuid
                    , @app_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_set_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_set_by_app_id]

GO

CREATE PROCEDURE usp_game_set_by_app_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @app_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game]  
                WHERE 1=1
                AND [app_id] = @app_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [app_id] = @app_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [app_id] = @app_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [org_id]
                    , [uuid]
                    , [app_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @org_id
                    , @uuid
                    , @app_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_set_by_org_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_set_by_org_id_by_app_id]

GO

CREATE PROCEDURE usp_game_set_by_org_id_by_app_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @app_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game]  
                WHERE 1=1
                AND [org_id] = @org_id
                AND [app_id] = @app_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [app_id] = @app_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [org_id] = @org_id
                AND [app_id] = @app_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [org_id]
                    , [uuid]
                    , [app_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @org_id
                    , @uuid
                    , @app_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Game - game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_del_by_uuid]

GO

CREATE PROCEDURE usp_game_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_del_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_del_by_code]

GO

CREATE PROCEDURE usp_game_del_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_del_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_del_by_name]

GO

CREATE PROCEDURE usp_game_del_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game]
    WHERE 1=1                        
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_del_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_del_by_org_id]

GO

CREATE PROCEDURE usp_game_del_by_org_id
(
    @org_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game]
    WHERE 1=1                        
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_del_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_del_by_app_id]

GO

CREATE PROCEDURE usp_game_del_by_app_id
(
    @app_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game]
    WHERE 1=1                        
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_del_by_org_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_del_by_org_id_by_app_id]

GO

CREATE PROCEDURE usp_game_del_by_org_id_by_app_id
(
    @org_id uniqueidentifier = NULL
    , @app_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game]
    WHERE 1=1                        
    AND [org_id] = @org_id
    AND [app_id] = @app_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Game - game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_get]

GO

CREATE PROCEDURE usp_game_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [app_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_get_by_uuid]

GO

CREATE PROCEDURE usp_game_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [app_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_get_by_code]

GO

CREATE PROCEDURE usp_game_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [app_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_get_by_name]

GO

CREATE PROCEDURE usp_game_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [app_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_get_by_org_id]

GO

CREATE PROCEDURE usp_game_get_by_org_id
(
    @org_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [app_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_get_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_get_by_app_id]

GO

CREATE PROCEDURE usp_game_get_by_app_id
(
    @app_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [app_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game]
    WHERE 1=1
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_get_by_org_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_get_by_org_id_by_app_id]

GO

CREATE PROCEDURE usp_game_get_by_org_id_by_app_id
(
    @org_id uniqueidentifier = NULL
    , @app_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [app_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameCategory - game_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_count]

GO

CREATE PROCEDURE usp_game_category_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_count_by_uuid]

GO

CREATE PROCEDURE usp_game_category_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_count_by_code]

GO

CREATE PROCEDURE usp_game_category_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_count_by_name]

GO

CREATE PROCEDURE usp_game_category_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_count_by_org_id]

GO

CREATE PROCEDURE usp_game_category_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_count_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_count_by_type_id]

GO

CREATE PROCEDURE usp_game_category_count_by_type_id
(
    @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_count_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_count_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_game_category_count_by_org_id_by_type_id
(
    @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameCategory - game_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_browse_by_filter]

GO

CREATE PROCEDURE usp_game_category_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_category] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameCategory - game_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_set_by_uuid]

GO

CREATE PROCEDURE usp_game_category_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier 
    , @org_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_category]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_category] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_category]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [org_id]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @org_id
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameCategory - game_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_del_by_uuid]

GO

CREATE PROCEDURE usp_game_category_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_category]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_del_by_code_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_del_by_code_by_org_id]

GO

CREATE PROCEDURE usp_game_category_del_by_code_by_org_id
(
    @code varchar (255) = NULL
    , @org_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_category]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_del_by_code_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_del_by_code_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_game_category_del_by_code_by_org_id_by_type_id
(
    @code varchar (255) = NULL
    , @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_category]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameCategory - game_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_get]

GO

CREATE PROCEDURE usp_game_category_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_category]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_get_by_uuid]

GO

CREATE PROCEDURE usp_game_category_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_category]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_get_by_code]

GO

CREATE PROCEDURE usp_game_category_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_category]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_get_by_name]

GO

CREATE PROCEDURE usp_game_category_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_category]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_get_by_org_id]

GO

CREATE PROCEDURE usp_game_category_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_category]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_get_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_get_by_type_id]

GO

CREATE PROCEDURE usp_game_category_get_by_type_id
(
    @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_category]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_get_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_get_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_game_category_get_by_org_id_by_type_id
(
    @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_category]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameCategoryTree - game_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_count]

GO

CREATE PROCEDURE usp_game_category_tree_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_tree]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_count_by_uuid]

GO

CREATE PROCEDURE usp_game_category_tree_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_tree]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_count_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_count_by_parent_id]

GO

CREATE PROCEDURE usp_game_category_tree_count_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_count_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_count_by_category_id]

GO

CREATE PROCEDURE usp_game_category_tree_count_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_tree]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_count_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_count_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_game_category_tree_count_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameCategoryTree - game_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_browse_by_filter]

GO

CREATE PROCEDURE usp_game_category_tree_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [parent_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [category_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[game_category_tree] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameCategoryTree - game_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_set_by_uuid]

GO

CREATE PROCEDURE usp_game_category_tree_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @parent_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @category_id uniqueidentifier 
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_category_tree]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_category_tree] 
                SET
                    [status] = @status
                    , [parent_id] = @parent_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [category_id] = @category_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_category_tree]
                (
                    [status]
                    , [parent_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [category_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @parent_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @category_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameCategoryTree - game_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_del_by_uuid]

GO

CREATE PROCEDURE usp_game_category_tree_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_category_tree]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_del_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_del_by_parent_id]

GO

CREATE PROCEDURE usp_game_category_tree_del_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_category_tree]
    WHERE 1=1                        
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_del_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_del_by_category_id]

GO

CREATE PROCEDURE usp_game_category_tree_del_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_category_tree]
    WHERE 1=1                        
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_del_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_del_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_game_category_tree_del_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_category_tree]
    WHERE 1=1                        
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameCategoryTree - game_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_get]

GO

CREATE PROCEDURE usp_game_category_tree_get
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_tree]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_get_by_uuid]

GO

CREATE PROCEDURE usp_game_category_tree_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_tree]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_get_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_get_by_parent_id]

GO

CREATE PROCEDURE usp_game_category_tree_get_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_get_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_get_by_category_id]

GO

CREATE PROCEDURE usp_game_category_tree_get_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_tree]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_tree_get_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_tree_get_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_game_category_tree_get_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameCategoryAssoc - game_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_count]

GO

CREATE PROCEDURE usp_game_category_assoc_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_count_by_uuid]

GO

CREATE PROCEDURE usp_game_category_assoc_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_count_by_game_id]

GO

CREATE PROCEDURE usp_game_category_assoc_count_by_game_id
(
    @game_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_count_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_count_by_category_id]

GO

CREATE PROCEDURE usp_game_category_assoc_count_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_count_by_game_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_count_by_game_id_by_category_id]

GO

CREATE PROCEDURE usp_game_category_assoc_count_by_game_id_by_category_id
(
    @game_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameCategoryAssoc - game_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_browse_by_filter]

GO

CREATE PROCEDURE usp_game_category_assoc_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [category_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[game_category_assoc] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameCategoryAssoc - game_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_set_by_uuid]

GO

CREATE PROCEDURE usp_game_category_assoc_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @game_id uniqueidentifier 
    , @category_id uniqueidentifier 
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_category_assoc]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_category_assoc] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [game_id] = @game_id
                    , [category_id] = @category_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_category_assoc]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [game_id]
                    , [category_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @game_id
                    , @category_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameCategoryAssoc - game_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_del_by_uuid]

GO

CREATE PROCEDURE usp_game_category_assoc_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_category_assoc]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameCategoryAssoc - game_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_get]

GO

CREATE PROCEDURE usp_game_category_assoc_get
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_get_by_uuid]

GO

CREATE PROCEDURE usp_game_category_assoc_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_get_by_game_id]

GO

CREATE PROCEDURE usp_game_category_assoc_get_by_game_id
(
    @game_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_get_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_get_by_category_id]

GO

CREATE PROCEDURE usp_game_category_assoc_get_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_category_assoc_get_by_game_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_category_assoc_get_by_game_id_by_category_id]

GO

CREATE PROCEDURE usp_game_category_assoc_get_by_game_id_by_category_id
(
    @game_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [category_id]
        , [type]
    FROM [dbo].[game_category_assoc]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameType - game_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_count]

GO

CREATE PROCEDURE usp_game_type_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_count_by_uuid]

GO

CREATE PROCEDURE usp_game_type_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_count_by_code]

GO

CREATE PROCEDURE usp_game_type_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_count_by_name]

GO

CREATE PROCEDURE usp_game_type_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_type]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameType - game_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_browse_by_filter]

GO

CREATE PROCEDURE usp_game_type_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_type] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameType - game_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_set_by_uuid]

GO

CREATE PROCEDURE usp_game_type_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (50) 
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_type]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameType - game_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_del_by_uuid]

GO

CREATE PROCEDURE usp_game_type_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_type]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameType - game_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_get]

GO

CREATE PROCEDURE usp_game_type_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_get_by_uuid]

GO

CREATE PROCEDURE usp_game_type_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_get_by_code]

GO

CREATE PROCEDURE usp_game_type_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_type_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_type_get_by_name]

GO

CREATE PROCEDURE usp_game_type_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_type]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileGame - profile_game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_count]

GO

CREATE PROCEDURE usp_profile_game_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_count_by_game_id]

GO

CREATE PROCEDURE usp_profile_game_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_count_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_count_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_count_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_count_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_profile_game_count_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileGame - profile_game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_game_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [game_profile]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [profile_version]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[profile_game] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileGame - profile_game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_profile ntext = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @profile_version varchar (50) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_game]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_game] 
                SET
                    [status] = @status
                    , [type_id] = @type_id
                    , [profile_id] = @profile_id
                    , [game_profile] = @game_profile
                    , [active] = @active
                    , [game_id] = @game_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [profile_version] = @profile_version
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_game]
                (
                    [status]
                    , [type_id]
                    , [profile_id]
                    , [game_profile]
                    , [active]
                    , [game_id]
                    , [uuid]
                    , [date_modified]
                    , [profile_version]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @type_id
                    , @profile_id
                    , @game_profile
                    , @active
                    , @game_id
                    , @uuid
                    , @date_modified
                    , @profile_version
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileGame - profile_game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_game]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileGame - profile_game
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_get]

GO

CREATE PROCEDURE usp_profile_game_get
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [profile_id]
        , [game_profile]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [profile_version]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [profile_id]
        , [game_profile]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [profile_version]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_get_by_game_id]

GO

CREATE PROCEDURE usp_profile_game_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [profile_id]
        , [game_profile]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [profile_version]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_get_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [profile_id]
        , [game_profile]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [profile_version]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_get_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_get_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_profile_game_get_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [profile_id]
        , [game_profile]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [profile_version]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileGameNetwork - profile_game_network
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_count]

GO

CREATE PROCEDURE usp_profile_game_network_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_network]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_network_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_network]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_count_by_game_id]

GO

CREATE PROCEDURE usp_profile_game_network_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_network]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_count_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_network_count_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_network]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_count_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_count_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_profile_game_network_count_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_network]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileGameNetwork - profile_game_network
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_game_network_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [hash]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [game_network_id]'
    SET @sql = @sql + ', [network_username]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [secret]'
    SET @sql = @sql + ', [token]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[profile_game_network] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileGameNetwork - profile_game_network
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_network_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @hash varchar (500) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_network_id uniqueidentifier = NULL
    , @network_username varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @secret varchar (500) = NULL
    , @token varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_game_network]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_game_network] 
                SET
                    [status] = @status
                    , [hash] = @hash
                    , [profile_id] = @profile_id
                    , [game_network_id] = @game_network_id
                    , [network_username] = @network_username
                    , [active] = @active
                    , [game_id] = @game_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [secret] = @secret
                    , [token] = @token
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_game_network]
                (
                    [status]
                    , [hash]
                    , [profile_id]
                    , [game_network_id]
                    , [network_username]
                    , [active]
                    , [game_id]
                    , [uuid]
                    , [date_modified]
                    , [secret]
                    , [token]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @hash
                    , @profile_id
                    , @game_network_id
                    , @network_username
                    , @active
                    , @game_id
                    , @uuid
                    , @date_modified
                    , @secret
                    , @token
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileGameNetwork - profile_game_network
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_network_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_game_network]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileGameNetwork - profile_game_network
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_get]

GO

CREATE PROCEDURE usp_profile_game_network_get
AS
BEGIN
    SELECT
        [status]
        , [hash]
        , [profile_id]
        , [game_network_id]
        , [network_username]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [secret]
        , [token]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game_network]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_network_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [hash]
        , [profile_id]
        , [game_network_id]
        , [network_username]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [secret]
        , [token]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game_network]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_get_by_game_id]

GO

CREATE PROCEDURE usp_profile_game_network_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [hash]
        , [profile_id]
        , [game_network_id]
        , [network_username]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [secret]
        , [token]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game_network]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_network_get_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [hash]
        , [profile_id]
        , [game_network_id]
        , [network_username]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [secret]
        , [token]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game_network]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_network_get_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_network_get_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_profile_game_network_get_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [hash]
        , [profile_id]
        , [game_network_id]
        , [network_username]
        , [active]
        , [game_id]
        , [uuid]
        , [date_modified]
        , [secret]
        , [token]
        , [date_created]
        , [type]
    FROM [dbo].[profile_game_network]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileGameDataAttribute - profile_game_data_attribute
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_count]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_count_by_uuid
(
    @uuid uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_count_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_count_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_count_by_profile_id_by_game_id_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_count_by_profile_id_by_game_id_by_code]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_count_by_profile_id_by_game_id_by_code
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @code varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileGameDataAttribute - profile_game_data_attribute
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [val]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [otype]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [name]'

    SET @sql = @sql + ' FROM [dbo].[profile_game_data_attribute] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileGameDataAttribute - profile_game_data_attribute
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @code varchar (500) = NULL
    , @uuid uniqueidentifier = NULL
    , @val ntext = NULL
    , @profile_id uniqueidentifier = NULL
    , @otype varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
    , @name varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_game_data_attribute]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_game_data_attribute] 
                SET
                    [code] = @code
                    , [uuid] = @uuid
                    , [val] = @val
                    , [profile_id] = @profile_id
                    , [otype] = @otype
                    , [game_id] = @game_id
                    , [type] = @type
                    , [name] = @name
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_game_data_attribute]
                (
                    [code]
                    , [uuid]
                    , [val]
                    , [profile_id]
                    , [otype]
                    , [game_id]
                    , [type]
                    , [name]
                )
                VALUES
                (
                    @code
                    , @uuid
                    , @val
                    , @profile_id
                    , @otype
                    , @game_id
                    , @type
                    , @name
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_set_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_set_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_set_by_profile_id
(
    @set_type varchar (50) = 'full'                        
    , @code varchar (500) = NULL
    , @uuid uniqueidentifier = NULL
    , @val ntext = NULL
    , @profile_id uniqueidentifier = NULL
    , @otype varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
    , @name varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_game_data_attribute]  
                WHERE 1=1
                AND [profile_id] = @profile_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_game_data_attribute] 
                SET
                    [code] = @code
                    , [uuid] = @uuid
                    , [val] = @val
                    , [profile_id] = @profile_id
                    , [otype] = @otype
                    , [game_id] = @game_id
                    , [type] = @type
                    , [name] = @name
                WHERE 1=1
                AND [profile_id] = @profile_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_game_data_attribute]
                (
                    [code]
                    , [uuid]
                    , [val]
                    , [profile_id]
                    , [otype]
                    , [game_id]
                    , [type]
                    , [name]
                )
                VALUES
                (
                    @code
                    , @uuid
                    , @val
                    , @profile_id
                    , @otype
                    , @game_id
                    , @type
                    , @name
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_set_by_profile_id_by_game_id_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_set_by_profile_id_by_game_id_by_code]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_set_by_profile_id_by_game_id_by_code
(
    @set_type varchar (50) = 'full'                        
    , @code varchar (500) = NULL
    , @uuid uniqueidentifier = NULL
    , @val ntext = NULL
    , @profile_id uniqueidentifier = NULL
    , @otype varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
    , @name varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_game_data_attribute]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_game_data_attribute] 
                SET
                    [code] = @code
                    , [uuid] = @uuid
                    , [val] = @val
                    , [profile_id] = @profile_id
                    , [otype] = @otype
                    , [game_id] = @game_id
                    , [type] = @type
                    , [name] = @name
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_game_data_attribute]
                (
                    [code]
                    , [uuid]
                    , [val]
                    , [profile_id]
                    , [otype]
                    , [game_id]
                    , [type]
                    , [name]
                )
                VALUES
                (
                    @code
                    , @uuid
                    , @val
                    , @profile_id
                    , @otype
                    , @game_id
                    , @type
                    , @name
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileGameDataAttribute - profile_game_data_attribute
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_del_by_uuid
(
    @uuid uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_del_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_del_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_del_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_del_by_profile_id_by_game_id_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_del_by_profile_id_by_game_id_by_code]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_del_by_profile_id_by_game_id_by_code
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @code varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileGameDataAttribute - profile_game_data_attribute
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_get_by_uuid
(
    @uuid uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [code]
        , [uuid]
        , [val]
        , [profile_id]
        , [otype]
        , [game_id]
        , [type]
        , [name]
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_get_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [code]
        , [uuid]
        , [val]
        , [profile_id]
        , [otype]
        , [game_id]
        , [type]
        , [name]
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_data_attribute_get_by_profile_id_by_game_id_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_data_attribute_get_by_profile_id_by_game_id_by_code]

GO

CREATE PROCEDURE usp_profile_game_data_attribute_get_by_profile_id_by_game_id_by_code
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @code varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [code]
        , [uuid]
        , [val]
        , [profile_id]
        , [otype]
        , [game_id]
        , [type]
        , [name]
    FROM [dbo].[profile_game_data_attribute]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameSession - game_session
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_count]

GO

CREATE PROCEDURE usp_game_session_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_session]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_count_by_uuid]

GO

CREATE PROCEDURE usp_game_session_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_session]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_count_by_game_id]

GO

CREATE PROCEDURE usp_game_session_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_session]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_count_by_profile_id]

GO

CREATE PROCEDURE usp_game_session_count_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_session]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_count_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_count_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_session_count_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_session]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameSession - game_session
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_browse_by_filter]

GO

CREATE PROCEDURE usp_game_session_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [network_uuid]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [game_area]'
    SET @sql = @sql + ', [profile_network]'
    SET @sql = @sql + ', [profile_device]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [network_external_port]'
    SET @sql = @sql + ', [game_players_connected]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [game_state]'
    SET @sql = @sql + ', [hash]'
    SET @sql = @sql + ', [description]'
    SET @sql = @sql + ', [network_external_ip]'
    SET @sql = @sql + ', [game_level]'
    SET @sql = @sql + ', [profile_username]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [game_code]'
    SET @sql = @sql + ', [game_player_z]'
    SET @sql = @sql + ', [game_player_x]'
    SET @sql = @sql + ', [network_port]'
    SET @sql = @sql + ', [game_players_allowed]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [game_type]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [network_ip]'
    SET @sql = @sql + ', [network_use_nat]'

    SET @sql = @sql + ' FROM [dbo].[game_session] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameSession - game_session
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_set_by_uuid]

GO

CREATE PROCEDURE usp_game_session_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @code varchar (255) = NULL
    , @network_uuid varchar (40) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_area varchar (255) = NULL
    , @profile_network varchar (255) = NULL
    , @profile_device varchar (50) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @network_external_port int = NULL
    , @game_players_connected int = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @game_state varchar (50) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @network_external_ip varchar (40) = NULL
    , @game_level varchar (255) = NULL
    , @profile_username varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_code varchar (255) = NULL
    , @game_player_z decimal = NULL
    , @game_player_x decimal = NULL
    , @network_port int = NULL
    , @game_players_allowed int = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @game_type varchar (255) = NULL
    , @date_created DATETIME = GETDATE
    , @network_ip varchar (40) = NULL
    , @network_use_nat bit = 1
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_session]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_session] 
                SET
                    [code] = @code
                    , [network_uuid] = @network_uuid
                    , [profile_id] = @profile_id
                    , [game_area] = @game_area
                    , [profile_network] = @profile_network
                    , [profile_device] = @profile_device
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [network_external_port] = @network_external_port
                    , [game_players_connected] = @game_players_connected
                    , [type] = @type
                    , [status] = @status
                    , [game_state] = @game_state
                    , [hash] = @hash
                    , [description] = @description
                    , [network_external_ip] = @network_external_ip
                    , [game_level] = @game_level
                    , [profile_username] = @profile_username
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_code] = @game_code
                    , [game_player_z] = @game_player_z
                    , [game_player_x] = @game_player_x
                    , [network_port] = @network_port
                    , [game_players_allowed] = @game_players_allowed
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [game_type] = @game_type
                    , [date_created] = @date_created
                    , [network_ip] = @network_ip
                    , [network_use_nat] = @network_use_nat
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_session]
                (
                    [code]
                    , [network_uuid]
                    , [profile_id]
                    , [game_area]
                    , [profile_network]
                    , [profile_device]
                    , [display_name]
                    , [uuid]
                    , [network_external_port]
                    , [game_players_connected]
                    , [type]
                    , [status]
                    , [game_state]
                    , [hash]
                    , [description]
                    , [network_external_ip]
                    , [game_level]
                    , [profile_username]
                    , [active]
                    , [game_id]
                    , [game_code]
                    , [game_player_z]
                    , [game_player_x]
                    , [network_port]
                    , [game_players_allowed]
                    , [name]
                    , [date_modified]
                    , [game_type]
                    , [date_created]
                    , [network_ip]
                    , [network_use_nat]
                )
                VALUES
                (
                    @code
                    , @network_uuid
                    , @profile_id
                    , @game_area
                    , @profile_network
                    , @profile_device
                    , @display_name
                    , @uuid
                    , @network_external_port
                    , @game_players_connected
                    , @type
                    , @status
                    , @game_state
                    , @hash
                    , @description
                    , @network_external_ip
                    , @game_level
                    , @profile_username
                    , @active
                    , @game_id
                    , @game_code
                    , @game_player_z
                    , @game_player_x
                    , @network_port
                    , @game_players_allowed
                    , @name
                    , @date_modified
                    , @game_type
                    , @date_created
                    , @network_ip
                    , @network_use_nat
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameSession - game_session
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_del_by_uuid]

GO

CREATE PROCEDURE usp_game_session_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_session]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameSession - game_session
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_get]

GO

CREATE PROCEDURE usp_game_session_get
AS
BEGIN
    SELECT
        [code]
        , [network_uuid]
        , [profile_id]
        , [game_area]
        , [profile_network]
        , [profile_device]
        , [display_name]
        , [uuid]
        , [network_external_port]
        , [game_players_connected]
        , [type]
        , [status]
        , [game_state]
        , [hash]
        , [description]
        , [network_external_ip]
        , [game_level]
        , [profile_username]
        , [active]
        , [game_id]
        , [game_code]
        , [game_player_z]
        , [game_player_x]
        , [network_port]
        , [game_players_allowed]
        , [name]
        , [date_modified]
        , [game_type]
        , [date_created]
        , [network_ip]
        , [network_use_nat]
    FROM [dbo].[game_session]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_get_by_uuid]

GO

CREATE PROCEDURE usp_game_session_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [code]
        , [network_uuid]
        , [profile_id]
        , [game_area]
        , [profile_network]
        , [profile_device]
        , [display_name]
        , [uuid]
        , [network_external_port]
        , [game_players_connected]
        , [type]
        , [status]
        , [game_state]
        , [hash]
        , [description]
        , [network_external_ip]
        , [game_level]
        , [profile_username]
        , [active]
        , [game_id]
        , [game_code]
        , [game_player_z]
        , [game_player_x]
        , [network_port]
        , [game_players_allowed]
        , [name]
        , [date_modified]
        , [game_type]
        , [date_created]
        , [network_ip]
        , [network_use_nat]
    FROM [dbo].[game_session]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_get_by_game_id]

GO

CREATE PROCEDURE usp_game_session_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [code]
        , [network_uuid]
        , [profile_id]
        , [game_area]
        , [profile_network]
        , [profile_device]
        , [display_name]
        , [uuid]
        , [network_external_port]
        , [game_players_connected]
        , [type]
        , [status]
        , [game_state]
        , [hash]
        , [description]
        , [network_external_ip]
        , [game_level]
        , [profile_username]
        , [active]
        , [game_id]
        , [game_code]
        , [game_player_z]
        , [game_player_x]
        , [network_port]
        , [game_players_allowed]
        , [name]
        , [date_modified]
        , [game_type]
        , [date_created]
        , [network_ip]
        , [network_use_nat]
    FROM [dbo].[game_session]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_get_by_profile_id]

GO

CREATE PROCEDURE usp_game_session_get_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [code]
        , [network_uuid]
        , [profile_id]
        , [game_area]
        , [profile_network]
        , [profile_device]
        , [display_name]
        , [uuid]
        , [network_external_port]
        , [game_players_connected]
        , [type]
        , [status]
        , [game_state]
        , [hash]
        , [description]
        , [network_external_ip]
        , [game_level]
        , [profile_username]
        , [active]
        , [game_id]
        , [game_code]
        , [game_player_z]
        , [game_player_x]
        , [network_port]
        , [game_players_allowed]
        , [name]
        , [date_modified]
        , [game_type]
        , [date_created]
        , [network_ip]
        , [network_use_nat]
    FROM [dbo].[game_session]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_get_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_get_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_session_get_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [code]
        , [network_uuid]
        , [profile_id]
        , [game_area]
        , [profile_network]
        , [profile_device]
        , [display_name]
        , [uuid]
        , [network_external_port]
        , [game_players_connected]
        , [type]
        , [status]
        , [game_state]
        , [hash]
        , [description]
        , [network_external_ip]
        , [game_level]
        , [profile_username]
        , [active]
        , [game_id]
        , [game_code]
        , [game_player_z]
        , [game_player_x]
        , [network_port]
        , [game_players_allowed]
        , [name]
        , [date_modified]
        , [game_type]
        , [date_created]
        , [network_ip]
        , [network_use_nat]
    FROM [dbo].[game_session]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameSessionData - game_session_data
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_data_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_data_count]

GO

CREATE PROCEDURE usp_game_session_data_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_session_data]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_data_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_data_count_by_uuid]

GO

CREATE PROCEDURE usp_game_session_data_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_session_data]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameSessionData - game_session_data
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_data_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_data_browse_by_filter]

GO

CREATE PROCEDURE usp_game_session_data_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [data_results]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [data_layer_projectile]'
    SET @sql = @sql + ', [data_layer_actors]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [data_layer_enemy]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_session_data] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameSessionData - game_session_data
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_data_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_data_set_by_uuid]

GO

CREATE PROCEDURE usp_game_session_data_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data_results ntext = NULL
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @data_layer_projectile ntext = NULL
    , @data_layer_actors ntext = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @data_layer_enemy ntext = NULL
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_session_data]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_session_data] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data_results] = @data_results
                    , [data] = @data
                    , [uuid] = @uuid
                    , [data_layer_projectile] = @data_layer_projectile
                    , [data_layer_actors] = @data_layer_actors
                    , [active] = @active
                    , [date_created] = @date_created
                    , [data_layer_enemy] = @data_layer_enemy
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_session_data]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data_results]
                    , [data]
                    , [uuid]
                    , [data_layer_projectile]
                    , [data_layer_actors]
                    , [active]
                    , [date_created]
                    , [data_layer_enemy]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data_results
                    , @data
                    , @uuid
                    , @data_layer_projectile
                    , @data_layer_actors
                    , @active
                    , @date_created
                    , @data_layer_enemy
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameSessionData - game_session_data
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_data_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_data_del_by_uuid]

GO

CREATE PROCEDURE usp_game_session_data_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_session_data]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameSessionData - game_session_data
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_data_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_data_get]

GO

CREATE PROCEDURE usp_game_session_data_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data_results]
        , [data]
        , [uuid]
        , [data_layer_projectile]
        , [data_layer_actors]
        , [active]
        , [date_created]
        , [data_layer_enemy]
        , [type]
        , [description]
    FROM [dbo].[game_session_data]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_session_data_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_session_data_get_by_uuid]

GO

CREATE PROCEDURE usp_game_session_data_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data_results]
        , [data]
        , [uuid]
        , [data_layer_projectile]
        , [data_layer_actors]
        , [active]
        , [date_created]
        , [data_layer_enemy]
        , [type]
        , [description]
    FROM [dbo].[game_session_data]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameContent - game_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_count]

GO

CREATE PROCEDURE usp_game_content_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_content]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_count_by_uuid]

GO

CREATE PROCEDURE usp_game_content_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_count_by_game_id]

GO

CREATE PROCEDURE usp_game_content_count_by_game_id
(
    @game_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_count_by_game_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_count_by_game_id_by_path]

GO

CREATE PROCEDURE usp_game_content_count_by_game_id_by_path
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_count_by_game_id_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_count_by_game_id_by_path_by_version]

GO

CREATE PROCEDURE usp_game_content_count_by_game_id_by_path_by_version
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_count_by_game_id_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_count_by_game_id_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_content_count_by_game_id_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameContent - game_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_browse_by_filter]

GO

CREATE PROCEDURE usp_game_content_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [extension]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [filename]'
    SET @sql = @sql + ', [source]'
    SET @sql = @sql + ', [version]'
    SET @sql = @sql + ', [platform]'
    SET @sql = @sql + ', [content_type]'
    SET @sql = @sql + ', [path]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [increment]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [hash]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_content] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameContent - game_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_set_by_uuid]

GO

CREATE PROCEDURE usp_game_content_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @game_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @path varchar (500) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @increment int = NULL
    , @type varchar (500) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_content]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_content] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [game_id] = @game_id
                    , [uuid] = @uuid
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [platform] = @platform
                    , [content_type] = @content_type
                    , [path] = @path
                    , [active] = @active
                    , [date_created] = @date_created
                    , [increment] = @increment
                    , [type] = @type
                    , [hash] = @hash
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_content]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [data]
                    , [game_id]
                    , [uuid]
                    , [filename]
                    , [source]
                    , [version]
                    , [platform]
                    , [content_type]
                    , [path]
                    , [active]
                    , [date_created]
                    , [increment]
                    , [type]
                    , [hash]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @extension
                    , @date_modified
                    , @data
                    , @game_id
                    , @uuid
                    , @filename
                    , @source
                    , @version
                    , @platform
                    , @content_type
                    , @path
                    , @active
                    , @date_created
                    , @increment
                    , @type
                    , @hash
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_set_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_set_by_game_id]

GO

CREATE PROCEDURE usp_game_content_set_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @game_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @path varchar (500) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @increment int = NULL
    , @type varchar (500) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_content]  
                WHERE 1=1
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_content] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [game_id] = @game_id
                    , [uuid] = @uuid
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [platform] = @platform
                    , [content_type] = @content_type
                    , [path] = @path
                    , [active] = @active
                    , [date_created] = @date_created
                    , [increment] = @increment
                    , [type] = @type
                    , [hash] = @hash
                    , [description] = @description
                WHERE 1=1
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_content]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [data]
                    , [game_id]
                    , [uuid]
                    , [filename]
                    , [source]
                    , [version]
                    , [platform]
                    , [content_type]
                    , [path]
                    , [active]
                    , [date_created]
                    , [increment]
                    , [type]
                    , [hash]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @extension
                    , @date_modified
                    , @data
                    , @game_id
                    , @uuid
                    , @filename
                    , @source
                    , @version
                    , @platform
                    , @content_type
                    , @path
                    , @active
                    , @date_created
                    , @increment
                    , @type
                    , @hash
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_set_by_game_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_set_by_game_id_by_path]

GO

CREATE PROCEDURE usp_game_content_set_by_game_id_by_path
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @game_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @path varchar (500) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @increment int = NULL
    , @type varchar (500) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([path]) = LOWER(@path)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_content] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [game_id] = @game_id
                    , [uuid] = @uuid
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [platform] = @platform
                    , [content_type] = @content_type
                    , [path] = @path
                    , [active] = @active
                    , [date_created] = @date_created
                    , [increment] = @increment
                    , [type] = @type
                    , [hash] = @hash
                    , [description] = @description
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([path]) = LOWER(@path)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_content]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [data]
                    , [game_id]
                    , [uuid]
                    , [filename]
                    , [source]
                    , [version]
                    , [platform]
                    , [content_type]
                    , [path]
                    , [active]
                    , [date_created]
                    , [increment]
                    , [type]
                    , [hash]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @extension
                    , @date_modified
                    , @data
                    , @game_id
                    , @uuid
                    , @filename
                    , @source
                    , @version
                    , @platform
                    , @content_type
                    , @path
                    , @active
                    , @date_created
                    , @increment
                    , @type
                    , @hash
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_set_by_game_id_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_set_by_game_id_by_path_by_version]

GO

CREATE PROCEDURE usp_game_content_set_by_game_id_by_path_by_version
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @game_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @path varchar (500) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @increment int = NULL
    , @type varchar (500) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_content] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [game_id] = @game_id
                    , [uuid] = @uuid
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [platform] = @platform
                    , [content_type] = @content_type
                    , [path] = @path
                    , [active] = @active
                    , [date_created] = @date_created
                    , [increment] = @increment
                    , [type] = @type
                    , [hash] = @hash
                    , [description] = @description
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_content]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [data]
                    , [game_id]
                    , [uuid]
                    , [filename]
                    , [source]
                    , [version]
                    , [platform]
                    , [content_type]
                    , [path]
                    , [active]
                    , [date_created]
                    , [increment]
                    , [type]
                    , [hash]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @extension
                    , @date_modified
                    , @data
                    , @game_id
                    , @uuid
                    , @filename
                    , @source
                    , @version
                    , @platform
                    , @content_type
                    , @path
                    , @active
                    , @date_created
                    , @increment
                    , @type
                    , @hash
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_set_by_game_id_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_set_by_game_id_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_content_set_by_game_id_by_path_by_version_by_platform_by_increment
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @game_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @path varchar (500) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @increment int = NULL
    , @type varchar (500) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                AND LOWER([platform]) = LOWER(@platform)
                AND [increment] = @increment
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_content] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [game_id] = @game_id
                    , [uuid] = @uuid
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [platform] = @platform
                    , [content_type] = @content_type
                    , [path] = @path
                    , [active] = @active
                    , [date_created] = @date_created
                    , [increment] = @increment
                    , [type] = @type
                    , [hash] = @hash
                    , [description] = @description
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                AND LOWER([platform]) = LOWER(@platform)
                AND [increment] = @increment
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_content]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [data]
                    , [game_id]
                    , [uuid]
                    , [filename]
                    , [source]
                    , [version]
                    , [platform]
                    , [content_type]
                    , [path]
                    , [active]
                    , [date_created]
                    , [increment]
                    , [type]
                    , [hash]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @extension
                    , @date_modified
                    , @data
                    , @game_id
                    , @uuid
                    , @filename
                    , @source
                    , @version
                    , @platform
                    , @content_type
                    , @path
                    , @active
                    , @date_created
                    , @increment
                    , @type
                    , @hash
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameContent - game_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_del_by_uuid]

GO

CREATE PROCEDURE usp_game_content_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_content]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_del_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_del_by_game_id]

GO

CREATE PROCEDURE usp_game_content_del_by_game_id
(
    @game_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_del_by_game_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_del_by_game_id_by_path]

GO

CREATE PROCEDURE usp_game_content_del_by_game_id_by_path
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_del_by_game_id_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_del_by_game_id_by_path_by_version]

GO

CREATE PROCEDURE usp_game_content_del_by_game_id_by_path_by_version
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_del_by_game_id_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_del_by_game_id_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_content_del_by_game_id_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameContent - game_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_get]

GO

CREATE PROCEDURE usp_game_content_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [extension]
        , [date_modified]
        , [data]
        , [game_id]
        , [uuid]
        , [filename]
        , [source]
        , [version]
        , [platform]
        , [content_type]
        , [path]
        , [active]
        , [date_created]
        , [increment]
        , [type]
        , [hash]
        , [description]
    FROM [dbo].[game_content]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_get_by_uuid]

GO

CREATE PROCEDURE usp_game_content_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [extension]
        , [date_modified]
        , [data]
        , [game_id]
        , [uuid]
        , [filename]
        , [source]
        , [version]
        , [platform]
        , [content_type]
        , [path]
        , [active]
        , [date_created]
        , [increment]
        , [type]
        , [hash]
        , [description]
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_get_by_game_id]

GO

CREATE PROCEDURE usp_game_content_get_by_game_id
(
    @game_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [extension]
        , [date_modified]
        , [data]
        , [game_id]
        , [uuid]
        , [filename]
        , [source]
        , [version]
        , [platform]
        , [content_type]
        , [path]
        , [active]
        , [date_created]
        , [increment]
        , [type]
        , [hash]
        , [description]
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_get_by_game_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_get_by_game_id_by_path]

GO

CREATE PROCEDURE usp_game_content_get_by_game_id_by_path
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [extension]
        , [date_modified]
        , [data]
        , [game_id]
        , [uuid]
        , [filename]
        , [source]
        , [version]
        , [platform]
        , [content_type]
        , [path]
        , [active]
        , [date_created]
        , [increment]
        , [type]
        , [hash]
        , [description]
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_get_by_game_id_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_get_by_game_id_by_path_by_version]

GO

CREATE PROCEDURE usp_game_content_get_by_game_id_by_path_by_version
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [extension]
        , [date_modified]
        , [data]
        , [game_id]
        , [uuid]
        , [filename]
        , [source]
        , [version]
        , [platform]
        , [content_type]
        , [path]
        , [active]
        , [date_created]
        , [increment]
        , [type]
        , [hash]
        , [description]
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_content_get_by_game_id_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_content_get_by_game_id_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_content_get_by_game_id_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [extension]
        , [date_modified]
        , [data]
        , [game_id]
        , [uuid]
        , [filename]
        , [source]
        , [version]
        , [platform]
        , [content_type]
        , [path]
        , [active]
        , [date_created]
        , [increment]
        , [type]
        , [hash]
        , [description]
    FROM [dbo].[game_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameProfileContent - game_profile_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count]

GO

CREATE PROCEDURE usp_game_profile_content_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_uuid]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_game_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_game_id_by_profile_id]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_game_id_by_profile_id
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_game_id_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_game_id_by_username]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_game_id_by_username
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_username]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_username
(
    @username varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND LOWER([username]) = LOWER(@username)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_game_id_by_profile_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_game_id_by_profile_id_by_path]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_game_id_by_profile_id_by_path
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_game_id_by_profile_id_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_game_id_by_profile_id_by_path_by_version]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_game_id_by_profile_id_by_path_by_version
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_game_id_by_username_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_game_id_by_username_by_path]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_game_id_by_username_by_path
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_game_id_by_username_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_game_id_by_username_by_path_by_version]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_game_id_by_username_by_path_by_version
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_count_by_game_id_by_username_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_count_by_game_id_by_username_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_profile_content_count_by_game_id_by_username_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameProfileContent - game_profile_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_browse_by_filter]

GO

CREATE PROCEDURE usp_game_profile_content_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [username]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [increment]'
    SET @sql = @sql + ', [path]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [platform]'
    SET @sql = @sql + ', [filename]'
    SET @sql = @sql + ', [source]'
    SET @sql = @sql + ', [version]'
    SET @sql = @sql + ', [game_network]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [hash]'
    SET @sql = @sql + ', [description]'
    SET @sql = @sql + ', [content_type]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [extension]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [date_created]'

    SET @sql = @sql + ' FROM [dbo].[game_profile_content] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameProfileContent - game_profile_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_uuid]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_game_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_game_id_by_profile_id]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_game_id_by_profile_id
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND [profile_id] = @profile_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [game_id] = @game_id
                AND [profile_id] = @profile_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_game_id_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_game_id_by_username]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_game_id_by_username
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([username]) = LOWER(@username)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([username]) = LOWER(@username)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_username]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_username
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND LOWER([username]) = LOWER(@username)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND LOWER([username]) = LOWER(@username)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_game_id_by_profile_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_game_id_by_profile_id_by_path]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_game_id_by_profile_id_by_path
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND [profile_id] = @profile_id
                AND LOWER([path]) = LOWER(@path)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [game_id] = @game_id
                AND [profile_id] = @profile_id
                AND LOWER([path]) = LOWER(@path)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_game_id_by_profile_id_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_game_id_by_profile_id_by_path_by_version]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_game_id_by_profile_id_by_path_by_version
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND [profile_id] = @profile_id
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [game_id] = @game_id
                AND [profile_id] = @profile_id
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND [profile_id] = @profile_id
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                AND LOWER([platform]) = LOWER(@platform)
                AND [increment] = @increment
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [game_id] = @game_id
                AND [profile_id] = @profile_id
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                AND LOWER([platform]) = LOWER(@platform)
                AND [increment] = @increment
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_game_id_by_username_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_game_id_by_username_by_path]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_game_id_by_username_by_path
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([username]) = LOWER(@username)
                AND LOWER([path]) = LOWER(@path)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([username]) = LOWER(@username)
                AND LOWER([path]) = LOWER(@path)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_game_id_by_username_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_game_id_by_username_by_path_by_version]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_game_id_by_username_by_path_by_version
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([username]) = LOWER(@username)
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([username]) = LOWER(@username)
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_set_by_game_id_by_username_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_set_by_game_id_by_username_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_profile_content_set_by_game_id_by_username_by_path_by_version_by_platform_by_increment
(
    @set_type varchar (50) = 'full'                        
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @increment int = NULL
    , @path varchar (500) = NULL
    , @display_name varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @platform varchar (255) = NULL
    , @filename varchar (500) = NULL
    , @source varchar (255) = NULL
    , @version varchar (255) = NULL
    , @game_network varchar (500) = NULL
    , @type varchar (500) = NULL
    , @status varchar (255) = NULL
    , @hash varchar (255) = NULL
    , @description varchar (255) = NULL
    , @content_type varchar (255) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier 
    , @data ntext = NULL
    , @name varchar (255) = NULL
    , @extension varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_profile_content]  
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([username]) = LOWER(@username)
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                AND LOWER([platform]) = LOWER(@platform)
                AND [increment] = @increment
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_profile_content] 
                SET
                    [username] = @username
                    , [code] = @code
                    , [profile_id] = @profile_id
                    , [increment] = @increment
                    , [path] = @path
                    , [display_name] = @display_name
                    , [uuid] = @uuid
                    , [platform] = @platform
                    , [filename] = @filename
                    , [source] = @source
                    , [version] = @version
                    , [game_network] = @game_network
                    , [type] = @type
                    , [status] = @status
                    , [hash] = @hash
                    , [description] = @description
                    , [content_type] = @content_type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [name] = @name
                    , [extension] = @extension
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                WHERE 1=1
                AND [game_id] = @game_id
                AND LOWER([username]) = LOWER(@username)
                AND LOWER([path]) = LOWER(@path)
                AND LOWER([version]) = LOWER(@version)
                AND LOWER([platform]) = LOWER(@platform)
                AND [increment] = @increment
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_profile_content]
                (
                    [username]
                    , [code]
                    , [profile_id]
                    , [increment]
                    , [path]
                    , [display_name]
                    , [uuid]
                    , [platform]
                    , [filename]
                    , [source]
                    , [version]
                    , [game_network]
                    , [type]
                    , [status]
                    , [hash]
                    , [description]
                    , [content_type]
                    , [active]
                    , [game_id]
                    , [data]
                    , [name]
                    , [extension]
                    , [date_modified]
                    , [date_created]
                )
                VALUES
                (
                    @username
                    , @code
                    , @profile_id
                    , @increment
                    , @path
                    , @display_name
                    , @uuid
                    , @platform
                    , @filename
                    , @source
                    , @version
                    , @game_network
                    , @type
                    , @status
                    , @hash
                    , @description
                    , @content_type
                    , @active
                    , @game_id
                    , @data
                    , @name
                    , @extension
                    , @date_modified
                    , @date_created
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameProfileContent - game_profile_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_uuid]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_game_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_game_id_by_profile_id]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_game_id_by_profile_id
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_game_id_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_game_id_by_username]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_game_id_by_username
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_username]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_username
(
    @username varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND LOWER([username]) = LOWER(@username)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_game_id_by_profile_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_game_id_by_profile_id_by_path]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_game_id_by_profile_id_by_path
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_game_id_by_profile_id_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_game_id_by_profile_id_by_path_by_version]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_game_id_by_profile_id_by_path_by_version
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_game_id_by_username_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_game_id_by_username_by_path]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_game_id_by_username_by_path
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_game_id_by_username_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_game_id_by_username_by_path_by_version]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_game_id_by_username_by_path_by_version
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_del_by_game_id_by_username_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_del_by_game_id_by_username_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_profile_content_del_by_game_id_by_username_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_profile_content]
    WHERE 1=1                        
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameProfileContent - game_profile_content
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get]

GO

CREATE PROCEDURE usp_game_profile_content_get
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_uuid]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_game_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_game_id_by_profile_id]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_game_id_by_profile_id
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_game_id_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_game_id_by_username]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_game_id_by_username
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_username]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_username
(
    @username varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND LOWER([username]) = LOWER(@username)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_game_id_by_profile_id_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_game_id_by_profile_id_by_path]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_game_id_by_profile_id_by_path
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_game_id_by_profile_id_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_game_id_by_profile_id_by_path_by_version]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_game_id_by_profile_id_by_path_by_version
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_game_id_by_profile_id_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [profile_id] = @profile_id
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_game_id_by_username_by_path]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_game_id_by_username_by_path]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_game_id_by_username_by_path
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_game_id_by_username_by_path_by_version]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_game_id_by_username_by_path_by_version]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_game_id_by_username_by_path_by_version
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_profile_content_get_by_game_id_by_username_by_path_by_version_by_platform_by_increment]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_profile_content_get_by_game_id_by_username_by_path_by_version_by_platform_by_increment]

GO

CREATE PROCEDURE usp_game_profile_content_get_by_game_id_by_username_by_path_by_version_by_platform_by_increment
(
    @game_id uniqueidentifier 
    , @username varchar (500) = NULL
    , @path varchar (500) = NULL
    , @version varchar (255) = NULL
    , @platform varchar (255) = NULL
    , @increment int = NULL
)
AS
BEGIN
    SELECT
        [username]
        , [code]
        , [profile_id]
        , [increment]
        , [path]
        , [display_name]
        , [uuid]
        , [platform]
        , [filename]
        , [source]
        , [version]
        , [game_network]
        , [type]
        , [status]
        , [hash]
        , [description]
        , [content_type]
        , [active]
        , [game_id]
        , [data]
        , [name]
        , [extension]
        , [date_modified]
        , [date_created]
    FROM [dbo].[game_profile_content]
    WHERE 1=1
    AND [game_id] = @game_id
    AND LOWER([username]) = LOWER(@username)
    AND LOWER([path]) = LOWER(@path)
    AND LOWER([version]) = LOWER(@version)
    AND LOWER([platform]) = LOWER(@platform)
    AND [increment] = @increment
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameApp - game_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_count]

GO

CREATE PROCEDURE usp_game_app_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_app]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_count_by_uuid]

GO

CREATE PROCEDURE usp_game_app_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_app]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_count_by_game_id]

GO

CREATE PROCEDURE usp_game_app_count_by_game_id
(
    @game_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_app]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_count_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_count_by_app_id]

GO

CREATE PROCEDURE usp_game_app_count_by_app_id
(
    @app_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_app]
    WHERE 1=1
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_count_by_game_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_count_by_game_id_by_app_id]

GO

CREATE PROCEDURE usp_game_app_count_by_game_id_by_app_id
(
    @game_id uniqueidentifier 
    , @app_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_app]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [app_id] = @app_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameApp - game_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_browse_by_filter]

GO

CREATE PROCEDURE usp_game_app_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [app_id]'

    SET @sql = @sql + ' FROM [dbo].[game_app] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameApp - game_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_set_by_uuid]

GO

CREATE PROCEDURE usp_game_app_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @game_id uniqueidentifier 
    , @type varchar (500) = NULL
    , @app_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_app]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_app] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [game_id] = @game_id
                    , [type] = @type
                    , [app_id] = @app_id
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_app]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [game_id]
                    , [type]
                    , [app_id]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @game_id
                    , @type
                    , @app_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameApp - game_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_del_by_uuid]

GO

CREATE PROCEDURE usp_game_app_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_app]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameApp - game_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_get]

GO

CREATE PROCEDURE usp_game_app_get
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [type]
        , [app_id]
    FROM [dbo].[game_app]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_get_by_uuid]

GO

CREATE PROCEDURE usp_game_app_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [type]
        , [app_id]
    FROM [dbo].[game_app]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_get_by_game_id]

GO

CREATE PROCEDURE usp_game_app_get_by_game_id
(
    @game_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [type]
        , [app_id]
    FROM [dbo].[game_app]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_get_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_get_by_app_id]

GO

CREATE PROCEDURE usp_game_app_get_by_app_id
(
    @app_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [type]
        , [app_id]
    FROM [dbo].[game_app]
    WHERE 1=1
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_app_get_by_game_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_app_get_by_game_id_by_app_id]

GO

CREATE PROCEDURE usp_game_app_get_by_game_id_by_app_id
(
    @game_id uniqueidentifier 
    , @app_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [type]
        , [app_id]
    FROM [dbo].[game_app]
    WHERE 1=1
    AND [game_id] = @game_id
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Offer - offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_count]

GO

CREATE PROCEDURE usp_offer_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_count_by_uuid]

GO

CREATE PROCEDURE usp_offer_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_count_by_code]

GO

CREATE PROCEDURE usp_offer_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_count_by_name]

GO

CREATE PROCEDURE usp_offer_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_count_by_org_id]

GO

CREATE PROCEDURE usp_offer_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Offer - offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_browse_by_filter]

GO

CREATE PROCEDURE usp_offer_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [url]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [usage_count]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[offer] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Offer - offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_set_by_uuid]

GO

CREATE PROCEDURE usp_offer_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @type_id uniqueidentifier 
    , @org_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @usage_count int = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[offer]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[offer] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [type_id] = @type_id
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [usage_count] = @usage_count
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[offer]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [type_id]
                    , [org_id]
                    , [uuid]
                    , [usage_count]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @type_id
                    , @org_id
                    , @uuid
                    , @usage_count
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Offer - offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_del_by_uuid]

GO

CREATE PROCEDURE usp_offer_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_del_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_del_by_org_id]

GO

CREATE PROCEDURE usp_offer_del_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer]
    WHERE 1=1                        
    AND [org_id] = @org_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Offer - offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_get]

GO

CREATE PROCEDURE usp_offer_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [type_id]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_get_by_uuid]

GO

CREATE PROCEDURE usp_offer_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [type_id]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_get_by_code]

GO

CREATE PROCEDURE usp_offer_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [type_id]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_get_by_name]

GO

CREATE PROCEDURE usp_offer_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [type_id]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_get_by_org_id]

GO

CREATE PROCEDURE usp_offer_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [type_id]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: OfferType - offer_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_count]

GO

CREATE PROCEDURE usp_offer_type_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_count_by_uuid]

GO

CREATE PROCEDURE usp_offer_type_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_count_by_code]

GO

CREATE PROCEDURE usp_offer_type_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_count_by_name]

GO

CREATE PROCEDURE usp_offer_type_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_type]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: OfferType - offer_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_browse_by_filter]

GO

CREATE PROCEDURE usp_offer_type_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[offer_type] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: OfferType - offer_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_set_by_uuid]

GO

CREATE PROCEDURE usp_offer_type_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[offer_type]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[offer_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[offer_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: OfferType - offer_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_del_by_uuid]

GO

CREATE PROCEDURE usp_offer_type_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_type]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: OfferType - offer_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_get]

GO

CREATE PROCEDURE usp_offer_type_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_get_by_uuid]

GO

CREATE PROCEDURE usp_offer_type_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_get_by_code]

GO

CREATE PROCEDURE usp_offer_type_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_type_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_type_get_by_name]

GO

CREATE PROCEDURE usp_offer_type_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_type]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: OfferLocation - offer_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_count]

GO

CREATE PROCEDURE usp_offer_location_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_location]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_count_by_uuid]

GO

CREATE PROCEDURE usp_offer_location_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_count_by_offer_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_count_by_offer_id]

GO

CREATE PROCEDURE usp_offer_location_count_by_offer_id
(
    @offer_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND [offer_id] = @offer_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_count_by_city]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_count_by_city]

GO

CREATE PROCEDURE usp_offer_location_count_by_city
(
    @city varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND LOWER([city]) = LOWER(@city)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_count_by_country_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_count_by_country_code]

GO

CREATE PROCEDURE usp_offer_location_count_by_country_code
(
    @country_code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND LOWER([country_code]) = LOWER(@country_code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_count_by_postal_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_count_by_postal_code]

GO

CREATE PROCEDURE usp_offer_location_count_by_postal_code
(
    @postal_code varchar (30) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND LOWER([postal_code]) = LOWER(@postal_code)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: OfferLocation - offer_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_browse_by_filter]

GO

CREATE PROCEDURE usp_offer_location_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [fax]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [description]'
    SET @sql = @sql + ', [address1]'
    SET @sql = @sql + ', [twitter]'
    SET @sql = @sql + ', [phone]'
    SET @sql = @sql + ', [postal_code]'
    SET @sql = @sql + ', [offer_id]'
    SET @sql = @sql + ', [country_code]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [state_province]'
    SET @sql = @sql + ', [city]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [dob]'
    SET @sql = @sql + ', [date_start]'
    SET @sql = @sql + ', [longitude]'
    SET @sql = @sql + ', [email]'
    SET @sql = @sql + ', [date_end]'
    SET @sql = @sql + ', [latitude]'
    SET @sql = @sql + ', [facebook]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [address2]'

    SET @sql = @sql + ' FROM [dbo].[offer_location] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: OfferLocation - offer_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_set_by_uuid]

GO

CREATE PROCEDURE usp_offer_location_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @fax varchar (30) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @address1 varchar (1000) = NULL
    , @twitter varchar (50) = NULL
    , @phone varchar (30) = NULL
    , @postal_code varchar (30) = NULL
    , @offer_id uniqueidentifier = NULL
    , @country_code varchar (255) = NULL
    , @date_created DATETIME = GETDATE
    , @active bit = NULL
    , @uuid uniqueidentifier 
    , @state_province varchar (255) = NULL
    , @city varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @dob DATETIME = GETDATE
    , @date_start DATETIME = GETDATE
    , @longitude double = NULL
    , @email varchar (255) = NULL
    , @date_end DATETIME = GETDATE
    , @latitude double = NULL
    , @facebook varchar (255) = NULL
    , @type varchar (500) = NULL
    , @address2 varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[offer_location]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[offer_location] 
                SET
                    [status] = @status
                    , [fax] = @fax
                    , [code] = @code
                    , [description] = @description
                    , [address1] = @address1
                    , [twitter] = @twitter
                    , [phone] = @phone
                    , [postal_code] = @postal_code
                    , [offer_id] = @offer_id
                    , [country_code] = @country_code
                    , [date_created] = @date_created
                    , [active] = @active
                    , [uuid] = @uuid
                    , [state_province] = @state_province
                    , [city] = @city
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [dob] = @dob
                    , [date_start] = @date_start
                    , [longitude] = @longitude
                    , [email] = @email
                    , [date_end] = @date_end
                    , [latitude] = @latitude
                    , [facebook] = @facebook
                    , [type] = @type
                    , [address2] = @address2
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[offer_location]
                (
                    [status]
                    , [fax]
                    , [code]
                    , [description]
                    , [address1]
                    , [twitter]
                    , [phone]
                    , [postal_code]
                    , [offer_id]
                    , [country_code]
                    , [date_created]
                    , [active]
                    , [uuid]
                    , [state_province]
                    , [city]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [dob]
                    , [date_start]
                    , [longitude]
                    , [email]
                    , [date_end]
                    , [latitude]
                    , [facebook]
                    , [type]
                    , [address2]
                )
                VALUES
                (
                    @status
                    , @fax
                    , @code
                    , @description
                    , @address1
                    , @twitter
                    , @phone
                    , @postal_code
                    , @offer_id
                    , @country_code
                    , @date_created
                    , @active
                    , @uuid
                    , @state_province
                    , @city
                    , @display_name
                    , @name
                    , @date_modified
                    , @dob
                    , @date_start
                    , @longitude
                    , @email
                    , @date_end
                    , @latitude
                    , @facebook
                    , @type
                    , @address2
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: OfferLocation - offer_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_del_by_uuid]

GO

CREATE PROCEDURE usp_offer_location_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_location]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: OfferLocation - offer_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_get]

GO

CREATE PROCEDURE usp_offer_location_get
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [offer_id]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[offer_location]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_get_by_uuid]

GO

CREATE PROCEDURE usp_offer_location_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [offer_id]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_get_by_offer_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_get_by_offer_id]

GO

CREATE PROCEDURE usp_offer_location_get_by_offer_id
(
    @offer_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [offer_id]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND [offer_id] = @offer_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_get_by_city]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_get_by_city]

GO

CREATE PROCEDURE usp_offer_location_get_by_city
(
    @city varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [offer_id]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND LOWER([city]) = LOWER(@city)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_get_by_country_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_get_by_country_code]

GO

CREATE PROCEDURE usp_offer_location_get_by_country_code
(
    @country_code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [offer_id]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND LOWER([country_code]) = LOWER(@country_code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_location_get_by_postal_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_location_get_by_postal_code]

GO

CREATE PROCEDURE usp_offer_location_get_by_postal_code
(
    @postal_code varchar (30) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [offer_id]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[offer_location]
    WHERE 1=1
    AND LOWER([postal_code]) = LOWER(@postal_code)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: OfferCategory - offer_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_count]

GO

CREATE PROCEDURE usp_offer_category_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_count_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_count_by_code]

GO

CREATE PROCEDURE usp_offer_category_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_count_by_name]

GO

CREATE PROCEDURE usp_offer_category_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_count_by_org_id]

GO

CREATE PROCEDURE usp_offer_category_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_count_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_count_by_type_id]

GO

CREATE PROCEDURE usp_offer_category_count_by_type_id
(
    @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_count_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_count_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_offer_category_count_by_org_id_by_type_id
(
    @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: OfferCategory - offer_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_browse_by_filter]

GO

CREATE PROCEDURE usp_offer_category_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[offer_category] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: OfferCategory - offer_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_set_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier 
    , @org_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[offer_category]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[offer_category] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[offer_category]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [org_id]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @org_id
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: OfferCategory - offer_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_del_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_category]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_del_by_code_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_del_by_code_by_org_id]

GO

CREATE PROCEDURE usp_offer_category_del_by_code_by_org_id
(
    @code varchar (255) = NULL
    , @org_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_category]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_del_by_code_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_del_by_code_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_offer_category_del_by_code_by_org_id_by_type_id
(
    @code varchar (255) = NULL
    , @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_category]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: OfferCategory - offer_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_get]

GO

CREATE PROCEDURE usp_offer_category_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_category]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_get_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_get_by_code]

GO

CREATE PROCEDURE usp_offer_category_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_get_by_name]

GO

CREATE PROCEDURE usp_offer_category_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_get_by_org_id]

GO

CREATE PROCEDURE usp_offer_category_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_get_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_get_by_type_id]

GO

CREATE PROCEDURE usp_offer_category_get_by_type_id
(
    @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_get_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_get_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_offer_category_get_by_org_id_by_type_id
(
    @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[offer_category]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: OfferCategoryTree - offer_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_count]

GO

CREATE PROCEDURE usp_offer_category_tree_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_count_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_tree_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_count_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_count_by_parent_id]

GO

CREATE PROCEDURE usp_offer_category_tree_count_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_count_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_count_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_tree_count_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_count_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_count_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_tree_count_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: OfferCategoryTree - offer_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_browse_by_filter]

GO

CREATE PROCEDURE usp_offer_category_tree_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [parent_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [category_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[offer_category_tree] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: OfferCategoryTree - offer_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_set_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_tree_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @parent_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @category_id uniqueidentifier 
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[offer_category_tree]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[offer_category_tree] 
                SET
                    [status] = @status
                    , [parent_id] = @parent_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [category_id] = @category_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[offer_category_tree]
                (
                    [status]
                    , [parent_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [category_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @parent_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @category_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: OfferCategoryTree - offer_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_del_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_tree_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_category_tree]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_del_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_del_by_parent_id]

GO

CREATE PROCEDURE usp_offer_category_tree_del_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_category_tree]
    WHERE 1=1                        
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_del_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_del_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_tree_del_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_category_tree]
    WHERE 1=1                        
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_del_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_del_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_tree_del_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_category_tree]
    WHERE 1=1                        
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: OfferCategoryTree - offer_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_get]

GO

CREATE PROCEDURE usp_offer_category_tree_get
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_get_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_tree_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_get_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_get_by_parent_id]

GO

CREATE PROCEDURE usp_offer_category_tree_get_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_get_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_get_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_tree_get_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_tree_get_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_tree_get_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_tree_get_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: OfferCategoryAssoc - offer_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_count]

GO

CREATE PROCEDURE usp_offer_category_assoc_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_count_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_assoc_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_count_by_offer_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_count_by_offer_id]

GO

CREATE PROCEDURE usp_offer_category_assoc_count_by_offer_id
(
    @offer_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
    AND [offer_id] = @offer_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_count_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_count_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_assoc_count_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_count_by_offer_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_count_by_offer_id_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_assoc_count_by_offer_id_by_category_id
(
    @offer_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
    AND [offer_id] = @offer_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: OfferCategoryAssoc - offer_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_browse_by_filter]

GO

CREATE PROCEDURE usp_offer_category_assoc_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [offer_id]'
    SET @sql = @sql + ', [category_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[offer_category_assoc] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: OfferCategoryAssoc - offer_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_set_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_assoc_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @offer_id uniqueidentifier 
    , @category_id uniqueidentifier 
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[offer_category_assoc]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[offer_category_assoc] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [offer_id] = @offer_id
                    , [category_id] = @category_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[offer_category_assoc]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [offer_id]
                    , [category_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @offer_id
                    , @category_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: OfferCategoryAssoc - offer_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_del_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_assoc_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: OfferCategoryAssoc - offer_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_get]

GO

CREATE PROCEDURE usp_offer_category_assoc_get
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_get_by_uuid]

GO

CREATE PROCEDURE usp_offer_category_assoc_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_get_by_offer_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_get_by_offer_id]

GO

CREATE PROCEDURE usp_offer_category_assoc_get_by_offer_id
(
    @offer_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
    AND [offer_id] = @offer_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_get_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_get_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_assoc_get_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_category_assoc_get_by_offer_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_category_assoc_get_by_offer_id_by_category_id]

GO

CREATE PROCEDURE usp_offer_category_assoc_get_by_offer_id_by_category_id
(
    @offer_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [category_id]
        , [type]
    FROM [dbo].[offer_category_assoc]
    WHERE 1=1
    AND [offer_id] = @offer_id
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: OfferGameLocation - offer_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_count]

GO

CREATE PROCEDURE usp_offer_game_location_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_game_location]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_count_by_uuid]

GO

CREATE PROCEDURE usp_offer_game_location_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_game_location]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_count_by_game_location_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_count_by_game_location_id]

GO

CREATE PROCEDURE usp_offer_game_location_count_by_game_location_id
(
    @game_location_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_game_location]
    WHERE 1=1
    AND [game_location_id] = @game_location_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_count_by_offer_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_count_by_offer_id]

GO

CREATE PROCEDURE usp_offer_game_location_count_by_offer_id
(
    @offer_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_game_location]
    WHERE 1=1
    AND [offer_id] = @offer_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_count_by_offer_id_by_game_location_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_count_by_offer_id_by_game_location_id]

GO

CREATE PROCEDURE usp_offer_game_location_count_by_offer_id_by_game_location_id
(
    @offer_id uniqueidentifier = NULL
    , @game_location_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[offer_game_location]
    WHERE 1=1
    AND [offer_id] = @offer_id
    AND [game_location_id] = @game_location_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: OfferGameLocation - offer_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_browse_by_filter]

GO

CREATE PROCEDURE usp_offer_game_location_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [game_location_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [offer_id]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[offer_game_location] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: OfferGameLocation - offer_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_set_by_uuid]

GO

CREATE PROCEDURE usp_offer_game_location_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @game_location_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @offer_id uniqueidentifier = NULL
    , @type_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[offer_game_location]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[offer_game_location] 
                SET
                    [status] = @status
                    , [game_location_id] = @game_location_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [offer_id] = @offer_id
                    , [type_id] = @type_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[offer_game_location]
                (
                    [status]
                    , [game_location_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [offer_id]
                    , [type_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @game_location_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @offer_id
                    , @type_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: OfferGameLocation - offer_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_del_by_uuid]

GO

CREATE PROCEDURE usp_offer_game_location_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[offer_game_location]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: OfferGameLocation - offer_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_get]

GO

CREATE PROCEDURE usp_offer_game_location_get
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [type_id]
        , [type]
    FROM [dbo].[offer_game_location]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_get_by_uuid]

GO

CREATE PROCEDURE usp_offer_game_location_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [type_id]
        , [type]
    FROM [dbo].[offer_game_location]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_get_by_game_location_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_get_by_game_location_id]

GO

CREATE PROCEDURE usp_offer_game_location_get_by_game_location_id
(
    @game_location_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [type_id]
        , [type]
    FROM [dbo].[offer_game_location]
    WHERE 1=1
    AND [game_location_id] = @game_location_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_get_by_offer_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_get_by_offer_id]

GO

CREATE PROCEDURE usp_offer_game_location_get_by_offer_id
(
    @offer_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [type_id]
        , [type]
    FROM [dbo].[offer_game_location]
    WHERE 1=1
    AND [offer_id] = @offer_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_offer_game_location_get_by_offer_id_by_game_location_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_offer_game_location_get_by_offer_id_by_game_location_id]

GO

CREATE PROCEDURE usp_offer_game_location_get_by_offer_id_by_game_location_id
(
    @offer_id uniqueidentifier = NULL
    , @game_location_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [offer_id]
        , [type_id]
        , [type]
    FROM [dbo].[offer_game_location]
    WHERE 1=1
    AND [offer_id] = @offer_id
    AND [game_location_id] = @game_location_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: EventInfo - event_info
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_count]

GO

CREATE PROCEDURE usp_event_info_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_info]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_count_by_uuid]

GO

CREATE PROCEDURE usp_event_info_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_info]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_count_by_code]

GO

CREATE PROCEDURE usp_event_info_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_info]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_count_by_name]

GO

CREATE PROCEDURE usp_event_info_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_info]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_count_by_org_id]

GO

CREATE PROCEDURE usp_event_info_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_info]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: EventInfo - event_info
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_browse_by_filter]

GO

CREATE PROCEDURE usp_event_info_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [url]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [usage_count]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[event_info] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: EventInfo - event_info
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_set_by_uuid]

GO

CREATE PROCEDURE usp_event_info_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @org_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @usage_count int = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[event_info]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[event_info] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [usage_count] = @usage_count
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[event_info]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [org_id]
                    , [uuid]
                    , [usage_count]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @org_id
                    , @uuid
                    , @usage_count
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: EventInfo - event_info
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_del_by_uuid]

GO

CREATE PROCEDURE usp_event_info_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_info]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_del_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_del_by_org_id]

GO

CREATE PROCEDURE usp_event_info_del_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_info]
    WHERE 1=1                        
    AND [org_id] = @org_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: EventInfo - event_info
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_get]

GO

CREATE PROCEDURE usp_event_info_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_info]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_get_by_uuid]

GO

CREATE PROCEDURE usp_event_info_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_info]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_get_by_code]

GO

CREATE PROCEDURE usp_event_info_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_info]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_get_by_name]

GO

CREATE PROCEDURE usp_event_info_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_info]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_info_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_info_get_by_org_id]

GO

CREATE PROCEDURE usp_event_info_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [org_id]
        , [uuid]
        , [usage_count]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_info]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: EventLocation - event_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_count]

GO

CREATE PROCEDURE usp_event_location_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_location]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_count_by_uuid]

GO

CREATE PROCEDURE usp_event_location_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_location]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_count_by_event_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_count_by_event_id]

GO

CREATE PROCEDURE usp_event_location_count_by_event_id
(
    @event_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_location]
    WHERE 1=1
    AND [event_id] = @event_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_count_by_city]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_count_by_city]

GO

CREATE PROCEDURE usp_event_location_count_by_city
(
    @city varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_location]
    WHERE 1=1
    AND LOWER([city]) = LOWER(@city)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_count_by_country_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_count_by_country_code]

GO

CREATE PROCEDURE usp_event_location_count_by_country_code
(
    @country_code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_location]
    WHERE 1=1
    AND LOWER([country_code]) = LOWER(@country_code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_count_by_postal_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_count_by_postal_code]

GO

CREATE PROCEDURE usp_event_location_count_by_postal_code
(
    @postal_code varchar (30) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_location]
    WHERE 1=1
    AND LOWER([postal_code]) = LOWER(@postal_code)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: EventLocation - event_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_browse_by_filter]

GO

CREATE PROCEDURE usp_event_location_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [fax]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [description]'
    SET @sql = @sql + ', [address1]'
    SET @sql = @sql + ', [twitter]'
    SET @sql = @sql + ', [phone]'
    SET @sql = @sql + ', [postal_code]'
    SET @sql = @sql + ', [country_code]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [state_province]'
    SET @sql = @sql + ', [city]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [dob]'
    SET @sql = @sql + ', [date_start]'
    SET @sql = @sql + ', [longitude]'
    SET @sql = @sql + ', [email]'
    SET @sql = @sql + ', [event_id]'
    SET @sql = @sql + ', [date_end]'
    SET @sql = @sql + ', [latitude]'
    SET @sql = @sql + ', [facebook]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [address2]'

    SET @sql = @sql + ' FROM [dbo].[event_location] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: EventLocation - event_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_set_by_uuid]

GO

CREATE PROCEDURE usp_event_location_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @fax varchar (30) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @address1 varchar (1000) = NULL
    , @twitter varchar (50) = NULL
    , @phone varchar (30) = NULL
    , @postal_code varchar (30) = NULL
    , @country_code varchar (255) = NULL
    , @date_created DATETIME = GETDATE
    , @active bit = NULL
    , @uuid uniqueidentifier 
    , @state_province varchar (255) = NULL
    , @city varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @dob DATETIME = GETDATE
    , @date_start DATETIME = GETDATE
    , @longitude double = NULL
    , @email varchar (255) = NULL
    , @event_id uniqueidentifier = NULL
    , @date_end DATETIME = GETDATE
    , @latitude double = NULL
    , @facebook varchar (255) = NULL
    , @type varchar (500) = NULL
    , @address2 varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[event_location]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[event_location] 
                SET
                    [status] = @status
                    , [fax] = @fax
                    , [code] = @code
                    , [description] = @description
                    , [address1] = @address1
                    , [twitter] = @twitter
                    , [phone] = @phone
                    , [postal_code] = @postal_code
                    , [country_code] = @country_code
                    , [date_created] = @date_created
                    , [active] = @active
                    , [uuid] = @uuid
                    , [state_province] = @state_province
                    , [city] = @city
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [dob] = @dob
                    , [date_start] = @date_start
                    , [longitude] = @longitude
                    , [email] = @email
                    , [event_id] = @event_id
                    , [date_end] = @date_end
                    , [latitude] = @latitude
                    , [facebook] = @facebook
                    , [type] = @type
                    , [address2] = @address2
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[event_location]
                (
                    [status]
                    , [fax]
                    , [code]
                    , [description]
                    , [address1]
                    , [twitter]
                    , [phone]
                    , [postal_code]
                    , [country_code]
                    , [date_created]
                    , [active]
                    , [uuid]
                    , [state_province]
                    , [city]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [dob]
                    , [date_start]
                    , [longitude]
                    , [email]
                    , [event_id]
                    , [date_end]
                    , [latitude]
                    , [facebook]
                    , [type]
                    , [address2]
                )
                VALUES
                (
                    @status
                    , @fax
                    , @code
                    , @description
                    , @address1
                    , @twitter
                    , @phone
                    , @postal_code
                    , @country_code
                    , @date_created
                    , @active
                    , @uuid
                    , @state_province
                    , @city
                    , @display_name
                    , @name
                    , @date_modified
                    , @dob
                    , @date_start
                    , @longitude
                    , @email
                    , @event_id
                    , @date_end
                    , @latitude
                    , @facebook
                    , @type
                    , @address2
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: EventLocation - event_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_del_by_uuid]

GO

CREATE PROCEDURE usp_event_location_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_location]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: EventLocation - event_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_get]

GO

CREATE PROCEDURE usp_event_location_get
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [event_id]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[event_location]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_get_by_uuid]

GO

CREATE PROCEDURE usp_event_location_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [event_id]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[event_location]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_get_by_event_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_get_by_event_id]

GO

CREATE PROCEDURE usp_event_location_get_by_event_id
(
    @event_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [event_id]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[event_location]
    WHERE 1=1
    AND [event_id] = @event_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_get_by_city]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_get_by_city]

GO

CREATE PROCEDURE usp_event_location_get_by_city
(
    @city varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [event_id]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[event_location]
    WHERE 1=1
    AND LOWER([city]) = LOWER(@city)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_get_by_country_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_get_by_country_code]

GO

CREATE PROCEDURE usp_event_location_get_by_country_code
(
    @country_code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [event_id]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[event_location]
    WHERE 1=1
    AND LOWER([country_code]) = LOWER(@country_code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_location_get_by_postal_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_location_get_by_postal_code]

GO

CREATE PROCEDURE usp_event_location_get_by_postal_code
(
    @postal_code varchar (30) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [fax]
        , [code]
        , [description]
        , [address1]
        , [twitter]
        , [phone]
        , [postal_code]
        , [country_code]
        , [date_created]
        , [active]
        , [uuid]
        , [state_province]
        , [city]
        , [display_name]
        , [name]
        , [date_modified]
        , [dob]
        , [date_start]
        , [longitude]
        , [email]
        , [event_id]
        , [date_end]
        , [latitude]
        , [facebook]
        , [type]
        , [address2]
    FROM [dbo].[event_location]
    WHERE 1=1
    AND LOWER([postal_code]) = LOWER(@postal_code)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: EventCategory - event_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_count]

GO

CREATE PROCEDURE usp_event_category_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_count_by_uuid]

GO

CREATE PROCEDURE usp_event_category_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_count_by_code]

GO

CREATE PROCEDURE usp_event_category_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_count_by_name]

GO

CREATE PROCEDURE usp_event_category_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_count_by_org_id]

GO

CREATE PROCEDURE usp_event_category_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_count_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_count_by_type_id]

GO

CREATE PROCEDURE usp_event_category_count_by_type_id
(
    @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_count_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_count_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_event_category_count_by_org_id_by_type_id
(
    @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: EventCategory - event_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_browse_by_filter]

GO

CREATE PROCEDURE usp_event_category_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[event_category] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: EventCategory - event_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_set_by_uuid]

GO

CREATE PROCEDURE usp_event_category_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier 
    , @org_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[event_category]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[event_category] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[event_category]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [org_id]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @org_id
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: EventCategory - event_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_del_by_uuid]

GO

CREATE PROCEDURE usp_event_category_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_category]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_del_by_code_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_del_by_code_by_org_id]

GO

CREATE PROCEDURE usp_event_category_del_by_code_by_org_id
(
    @code varchar (255) = NULL
    , @org_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_category]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_del_by_code_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_del_by_code_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_event_category_del_by_code_by_org_id_by_type_id
(
    @code varchar (255) = NULL
    , @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_category]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: EventCategory - event_category
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_get]

GO

CREATE PROCEDURE usp_event_category_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_category]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_get_by_uuid]

GO

CREATE PROCEDURE usp_event_category_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_category]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_get_by_code]

GO

CREATE PROCEDURE usp_event_category_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_category]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_get_by_name]

GO

CREATE PROCEDURE usp_event_category_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_category]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_get_by_org_id]

GO

CREATE PROCEDURE usp_event_category_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_category]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_get_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_get_by_type_id]

GO

CREATE PROCEDURE usp_event_category_get_by_type_id
(
    @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_category]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_get_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_get_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_event_category_get_by_org_id_by_type_id
(
    @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[event_category]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: EventCategoryTree - event_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_count]

GO

CREATE PROCEDURE usp_event_category_tree_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_tree]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_count_by_uuid]

GO

CREATE PROCEDURE usp_event_category_tree_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_tree]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_count_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_count_by_parent_id]

GO

CREATE PROCEDURE usp_event_category_tree_count_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_count_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_count_by_category_id]

GO

CREATE PROCEDURE usp_event_category_tree_count_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_tree]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_count_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_count_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_event_category_tree_count_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: EventCategoryTree - event_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_browse_by_filter]

GO

CREATE PROCEDURE usp_event_category_tree_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [parent_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [category_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[event_category_tree] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: EventCategoryTree - event_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_set_by_uuid]

GO

CREATE PROCEDURE usp_event_category_tree_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @parent_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @category_id uniqueidentifier 
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[event_category_tree]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[event_category_tree] 
                SET
                    [status] = @status
                    , [parent_id] = @parent_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [category_id] = @category_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[event_category_tree]
                (
                    [status]
                    , [parent_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [category_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @parent_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @category_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: EventCategoryTree - event_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_del_by_uuid]

GO

CREATE PROCEDURE usp_event_category_tree_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_category_tree]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_del_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_del_by_parent_id]

GO

CREATE PROCEDURE usp_event_category_tree_del_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_category_tree]
    WHERE 1=1                        
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_del_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_del_by_category_id]

GO

CREATE PROCEDURE usp_event_category_tree_del_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_category_tree]
    WHERE 1=1                        
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_del_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_del_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_event_category_tree_del_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_category_tree]
    WHERE 1=1                        
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: EventCategoryTree - event_category_tree
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_get]

GO

CREATE PROCEDURE usp_event_category_tree_get
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_tree]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_get_by_uuid]

GO

CREATE PROCEDURE usp_event_category_tree_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_tree]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_get_by_parent_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_get_by_parent_id]

GO

CREATE PROCEDURE usp_event_category_tree_get_by_parent_id
(
    @parent_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_get_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_get_by_category_id]

GO

CREATE PROCEDURE usp_event_category_tree_get_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_tree]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_tree_get_by_parent_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_tree_get_by_parent_id_by_category_id]

GO

CREATE PROCEDURE usp_event_category_tree_get_by_parent_id_by_category_id
(
    @parent_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [parent_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_tree]
    WHERE 1=1
    AND [parent_id] = @parent_id
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: EventCategoryAssoc - event_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_count]

GO

CREATE PROCEDURE usp_event_category_assoc_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_count_by_uuid]

GO

CREATE PROCEDURE usp_event_category_assoc_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_count_by_event_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_count_by_event_id]

GO

CREATE PROCEDURE usp_event_category_assoc_count_by_event_id
(
    @event_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
    AND [event_id] = @event_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_count_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_count_by_category_id]

GO

CREATE PROCEDURE usp_event_category_assoc_count_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_count_by_event_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_count_by_event_id_by_category_id]

GO

CREATE PROCEDURE usp_event_category_assoc_count_by_event_id_by_category_id
(
    @event_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
    AND [event_id] = @event_id
    AND [category_id] = @category_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: EventCategoryAssoc - event_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_browse_by_filter]

GO

CREATE PROCEDURE usp_event_category_assoc_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [event_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [category_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[event_category_assoc] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: EventCategoryAssoc - event_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_set_by_uuid]

GO

CREATE PROCEDURE usp_event_category_assoc_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @event_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @category_id uniqueidentifier 
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[event_category_assoc]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[event_category_assoc] 
                SET
                    [status] = @status
                    , [event_id] = @event_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [category_id] = @category_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[event_category_assoc]
                (
                    [status]
                    , [event_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [category_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @event_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @category_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: EventCategoryAssoc - event_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_del_by_uuid]

GO

CREATE PROCEDURE usp_event_category_assoc_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[event_category_assoc]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: EventCategoryAssoc - event_category_assoc
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_get]

GO

CREATE PROCEDURE usp_event_category_assoc_get
AS
BEGIN
    SELECT
        [status]
        , [event_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_get_by_uuid]

GO

CREATE PROCEDURE usp_event_category_assoc_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [event_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_get_by_event_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_get_by_event_id]

GO

CREATE PROCEDURE usp_event_category_assoc_get_by_event_id
(
    @event_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [event_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
    AND [event_id] = @event_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_get_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_get_by_category_id]

GO

CREATE PROCEDURE usp_event_category_assoc_get_by_category_id
(
    @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [event_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_event_category_assoc_get_by_event_id_by_category_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_event_category_assoc_get_by_event_id_by_category_id]

GO

CREATE PROCEDURE usp_event_category_assoc_get_by_event_id_by_category_id
(
    @event_id uniqueidentifier 
    , @category_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [event_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [category_id]
        , [type]
    FROM [dbo].[event_category_assoc]
    WHERE 1=1
    AND [event_id] = @event_id
    AND [category_id] = @category_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Channel - channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_count]

GO

CREATE PROCEDURE usp_channel_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_count_by_uuid]

GO

CREATE PROCEDURE usp_channel_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_count_by_code]

GO

CREATE PROCEDURE usp_channel_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_count_by_name]

GO

CREATE PROCEDURE usp_channel_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_count_by_org_id]

GO

CREATE PROCEDURE usp_channel_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_count_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_count_by_type_id]

GO

CREATE PROCEDURE usp_channel_count_by_type_id
(
    @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_count_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_count_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_channel_count_by_org_id_by_type_id
(
    @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Channel - channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_browse_by_filter]

GO

CREATE PROCEDURE usp_channel_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[channel] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Channel - channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_set_by_uuid]

GO

CREATE PROCEDURE usp_channel_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @type_id uniqueidentifier 
    , @org_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[channel]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[channel] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [type_id] = @type_id
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[channel]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [type_id]
                    , [org_id]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @type_id
                    , @org_id
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Channel - channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_del_by_uuid]

GO

CREATE PROCEDURE usp_channel_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[channel]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_del_by_code_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_del_by_code_by_org_id]

GO

CREATE PROCEDURE usp_channel_del_by_code_by_org_id
(
    @code varchar (255) = NULL
    , @org_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[channel]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_del_by_code_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_del_by_code_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_channel_del_by_code_by_org_id_by_type_id
(
    @code varchar (255) = NULL
    , @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[channel]
    WHERE 1=1                        
    AND LOWER([code]) = LOWER(@code)
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Channel - channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_get]

GO

CREATE PROCEDURE usp_channel_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_get_by_uuid]

GO

CREATE PROCEDURE usp_channel_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_get_by_code]

GO

CREATE PROCEDURE usp_channel_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_get_by_name]

GO

CREATE PROCEDURE usp_channel_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_get_by_org_id]

GO

CREATE PROCEDURE usp_channel_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_get_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_get_by_type_id]

GO

CREATE PROCEDURE usp_channel_get_by_type_id
(
    @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel]
    WHERE 1=1
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_get_by_org_id_by_type_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_get_by_org_id_by_type_id]

GO

CREATE PROCEDURE usp_channel_get_by_org_id_by_type_id
(
    @org_id uniqueidentifier 
    , @type_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [type_id]
        , [org_id]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [type_id] = @type_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ChannelType - channel_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_count]

GO

CREATE PROCEDURE usp_channel_type_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_count_by_uuid]

GO

CREATE PROCEDURE usp_channel_type_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_count_by_code]

GO

CREATE PROCEDURE usp_channel_type_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_count_by_name]

GO

CREATE PROCEDURE usp_channel_type_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[channel_type]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ChannelType - channel_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_browse_by_filter]

GO

CREATE PROCEDURE usp_channel_type_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[channel_type] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ChannelType - channel_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_set_by_uuid]

GO

CREATE PROCEDURE usp_channel_type_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (50) 
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[channel_type]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[channel_type] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [uuid] = @uuid
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[channel_type]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [uuid]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @uuid
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ChannelType - channel_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_del_by_uuid]

GO

CREATE PROCEDURE usp_channel_type_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[channel_type]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ChannelType - channel_type
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_get]

GO

CREATE PROCEDURE usp_channel_type_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel_type]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_get_by_uuid]

GO

CREATE PROCEDURE usp_channel_type_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel_type]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_get_by_code]

GO

CREATE PROCEDURE usp_channel_type_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel_type]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_channel_type_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_channel_type_get_by_name]

GO

CREATE PROCEDURE usp_channel_type_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [uuid]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[channel_type]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Question - question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_count]

GO

CREATE PROCEDURE usp_question_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[question]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_count_by_uuid]

GO

CREATE PROCEDURE usp_question_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[question]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_count_by_code]

GO

CREATE PROCEDURE usp_question_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[question]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_count_by_name]

GO

CREATE PROCEDURE usp_question_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[question]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_count_by_channel_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_count_by_channel_id]

GO

CREATE PROCEDURE usp_question_count_by_channel_id
(
    @channel_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[question]
    WHERE 1=1
    AND [channel_id] = @channel_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_count_by_org_id]

GO

CREATE PROCEDURE usp_question_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[question]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_count_by_channel_id_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_count_by_channel_id_by_org_id]

GO

CREATE PROCEDURE usp_question_count_by_channel_id_by_org_id
(
    @channel_id uniqueidentifier 
    , @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[question]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_count_by_channel_id_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_count_by_channel_id_by_code]

GO

CREATE PROCEDURE usp_question_count_by_channel_id_by_code
(
    @channel_id uniqueidentifier 
    , @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[question]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND LOWER([code]) = LOWER(@code)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Question - question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_browse_by_filter]

GO

CREATE PROCEDURE usp_question_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [choices]'
    SET @sql = @sql + ', [channel_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[question] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Question - question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_set_by_uuid]

GO

CREATE PROCEDURE usp_question_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @choices ntext = NULL
    , @channel_id uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (50) 
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[question]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[question] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [choices] = @choices
                    , [channel_id] = @channel_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[question]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [org_id]
                    , [uuid]
                    , [choices]
                    , [channel_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @org_id
                    , @uuid
                    , @choices
                    , @channel_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_set_by_channel_id_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_set_by_channel_id_by_code]

GO

CREATE PROCEDURE usp_question_set_by_channel_id_by_code
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @choices ntext = NULL
    , @channel_id uniqueidentifier 
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (50) 
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[question]  
                WHERE 1=1
                AND [channel_id] = @channel_id
                AND LOWER([code]) = LOWER(@code)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[question] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [uuid] = @uuid
                    , [choices] = @choices
                    , [channel_id] = @channel_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [channel_id] = @channel_id
                AND LOWER([code]) = LOWER(@code)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[question]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [org_id]
                    , [uuid]
                    , [choices]
                    , [channel_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @org_id
                    , @uuid
                    , @choices
                    , @channel_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Question - question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_del_by_uuid]

GO

CREATE PROCEDURE usp_question_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[question]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_del_by_channel_id_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_del_by_channel_id_by_org_id]

GO

CREATE PROCEDURE usp_question_del_by_channel_id_by_org_id
(
    @channel_id uniqueidentifier 
    , @org_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[question]
    WHERE 1=1                        
    AND [channel_id] = @channel_id
    AND [org_id] = @org_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Question - question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get]

GO

CREATE PROCEDURE usp_question_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get_by_uuid]

GO

CREATE PROCEDURE usp_question_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get_by_code]

GO

CREATE PROCEDURE usp_question_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get_by_name]

GO

CREATE PROCEDURE usp_question_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get_by_type]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get_by_type]

GO

CREATE PROCEDURE usp_question_get_by_type
(
    @type varchar (50) 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
    AND LOWER([type]) = LOWER(@type)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get_by_channel_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get_by_channel_id]

GO

CREATE PROCEDURE usp_question_get_by_channel_id
(
    @channel_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
    AND [channel_id] = @channel_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get_by_org_id]

GO

CREATE PROCEDURE usp_question_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get_by_channel_id_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get_by_channel_id_by_org_id]

GO

CREATE PROCEDURE usp_question_get_by_channel_id_by_org_id
(
    @channel_id uniqueidentifier 
    , @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_question_get_by_channel_id_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_question_get_by_channel_id_by_code]

GO

CREATE PROCEDURE usp_question_get_by_channel_id_by_code
(
    @channel_id uniqueidentifier 
    , @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [org_id]
        , [uuid]
        , [choices]
        , [channel_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[question]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileOffer - profile_offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_count]

GO

CREATE PROCEDURE usp_profile_offer_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_offer]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_offer_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_offer]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_count_by_profile_id]

GO

CREATE PROCEDURE usp_profile_offer_count_by_profile_id
(
    @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_offer]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileOffer - profile_offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_offer_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [redeem_code]'
    SET @sql = @sql + ', [offer_id]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [redeemed]'
    SET @sql = @sql + ', [url]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[profile_offer] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileOffer - profile_offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_offer_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @redeem_code varchar (128) 
    , @offer_id uniqueidentifier 
    , @profile_id uniqueidentifier 
    , @active bit = NULL
    , @uuid uniqueidentifier 
    , @redeemed varchar (50) 
    , @url varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_offer]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_offer] 
                SET
                    [status] = @status
                    , [redeem_code] = @redeem_code
                    , [offer_id] = @offer_id
                    , [profile_id] = @profile_id
                    , [active] = @active
                    , [uuid] = @uuid
                    , [redeemed] = @redeemed
                    , [url] = @url
                    , [date_modified] = @date_modified
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_offer]
                (
                    [status]
                    , [redeem_code]
                    , [offer_id]
                    , [profile_id]
                    , [active]
                    , [uuid]
                    , [redeemed]
                    , [url]
                    , [date_modified]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @redeem_code
                    , @offer_id
                    , @profile_id
                    , @active
                    , @uuid
                    , @redeemed
                    , @url
                    , @date_modified
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileOffer - profile_offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_offer_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_offer]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_del_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_del_by_profile_id]

GO

CREATE PROCEDURE usp_profile_offer_del_by_profile_id
(
    @profile_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_offer]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileOffer - profile_offer
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_get]

GO

CREATE PROCEDURE usp_profile_offer_get
AS
BEGIN
    SELECT
        [status]
        , [redeem_code]
        , [offer_id]
        , [profile_id]
        , [active]
        , [uuid]
        , [redeemed]
        , [url]
        , [date_modified]
        , [date_created]
        , [type]
    FROM [dbo].[profile_offer]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_offer_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [redeem_code]
        , [offer_id]
        , [profile_id]
        , [active]
        , [uuid]
        , [redeemed]
        , [url]
        , [date_modified]
        , [date_created]
        , [type]
    FROM [dbo].[profile_offer]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_offer_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_offer_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_offer_get_by_profile_id
(
    @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [redeem_code]
        , [offer_id]
        , [profile_id]
        , [active]
        , [uuid]
        , [redeemed]
        , [url]
        , [date_modified]
        , [date_created]
        , [type]
    FROM [dbo].[profile_offer]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileApp - profile_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_count]

GO

CREATE PROCEDURE usp_profile_app_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_app]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_app_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_app]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_count_by_profile_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_count_by_profile_id_by_app_id]

GO

CREATE PROCEDURE usp_profile_app_count_by_profile_id_by_app_id
(
    @profile_id uniqueidentifier = NULL
    , @app_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_app]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [app_id] = @app_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileApp - profile_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_app_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [app_id]'

    SET @sql = @sql + ' FROM [dbo].[profile_app] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileApp - profile_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_app_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @profile_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
    , @app_id uniqueidentifier = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_app]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_app] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [profile_id] = @profile_id
                    , [type] = @type
                    , [app_id] = @app_id
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_app]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [profile_id]
                    , [type]
                    , [app_id]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @profile_id
                    , @type
                    , @app_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_set_by_profile_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_set_by_profile_id_by_app_id]

GO

CREATE PROCEDURE usp_profile_app_set_by_profile_id_by_app_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @profile_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
    , @app_id uniqueidentifier = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_app]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [app_id] = @app_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_app] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [profile_id] = @profile_id
                    , [type] = @type
                    , [app_id] = @app_id
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [app_id] = @app_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_app]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [profile_id]
                    , [type]
                    , [app_id]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @profile_id
                    , @type
                    , @app_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileApp - profile_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_app_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_app]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_del_by_profile_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_del_by_profile_id_by_app_id]

GO

CREATE PROCEDURE usp_profile_app_del_by_profile_id_by_app_id
(
    @profile_id uniqueidentifier = NULL
    , @app_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_app]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
    AND [app_id] = @app_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileApp - profile_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_get]

GO

CREATE PROCEDURE usp_profile_app_get
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [app_id]
    FROM [dbo].[profile_app]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_app_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [app_id]
    FROM [dbo].[profile_app]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_get_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_get_by_app_id]

GO

CREATE PROCEDURE usp_profile_app_get_by_app_id
(
    @app_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [app_id]
    FROM [dbo].[profile_app]
    WHERE 1=1
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_app_get_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [app_id]
    FROM [dbo].[profile_app]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_app_get_by_profile_id_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_app_get_by_profile_id_by_app_id]

GO

CREATE PROCEDURE usp_profile_app_get_by_profile_id_by_app_id
(
    @profile_id uniqueidentifier = NULL
    , @app_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [app_id]
    FROM [dbo].[profile_app]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileOrg - profile_org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_count]

GO

CREATE PROCEDURE usp_profile_org_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_org]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_org_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_org]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_count_by_org_id]

GO

CREATE PROCEDURE usp_profile_org_count_by_org_id
(
    @org_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_org]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_count_by_profile_id]

GO

CREATE PROCEDURE usp_profile_org_count_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_org]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileOrg - profile_org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_org_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [org_id]'

    SET @sql = @sql + ' FROM [dbo].[profile_org] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileOrg - profile_org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_org_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @type_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @profile_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
    , @org_id uniqueidentifier = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_org]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_org] 
                SET
                    [status] = @status
                    , [type_id] = @type_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [profile_id] = @profile_id
                    , [type] = @type
                    , [org_id] = @org_id
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_org]
                (
                    [status]
                    , [type_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [profile_id]
                    , [type]
                    , [org_id]
                )
                VALUES
                (
                    @status
                    , @type_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @profile_id
                    , @type
                    , @org_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileOrg - profile_org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_org_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_org]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileOrg - profile_org
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_get]

GO

CREATE PROCEDURE usp_profile_org_get
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [org_id]
    FROM [dbo].[profile_org]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_org_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [org_id]
    FROM [dbo].[profile_org]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_get_by_org_id]

GO

CREATE PROCEDURE usp_profile_org_get_by_org_id
(
    @org_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [org_id]
    FROM [dbo].[profile_org]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_org_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_org_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_org_get_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
        , [org_id]
    FROM [dbo].[profile_org]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileGameLocation - profile_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_count]

GO

CREATE PROCEDURE usp_profile_game_location_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_location]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_location_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_location]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_count_by_game_location_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_count_by_game_location_id]

GO

CREATE PROCEDURE usp_profile_game_location_count_by_game_location_id
(
    @game_location_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_location]
    WHERE 1=1
    AND [game_location_id] = @game_location_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_count_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_location_count_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_location]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_count_by_profile_id_by_game_location_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_count_by_profile_id_by_game_location_id]

GO

CREATE PROCEDURE usp_profile_game_location_count_by_profile_id_by_game_location_id
(
    @profile_id uniqueidentifier = NULL
    , @game_location_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_game_location]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_location_id] = @game_location_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileGameLocation - profile_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_game_location_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [game_location_id]'
    SET @sql = @sql + ', [type_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[profile_game_location] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileGameLocation - profile_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_location_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @game_location_id uniqueidentifier = NULL
    , @type_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @profile_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_game_location]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_game_location] 
                SET
                    [status] = @status
                    , [game_location_id] = @game_location_id
                    , [type_id] = @type_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [profile_id] = @profile_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_game_location]
                (
                    [status]
                    , [game_location_id]
                    , [type_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [profile_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @game_location_id
                    , @type_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @profile_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileGameLocation - profile_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_location_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_game_location]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileGameLocation - profile_game_location
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_get]

GO

CREATE PROCEDURE usp_profile_game_location_get
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_game_location]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_game_location_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_game_location]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_get_by_game_location_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_get_by_game_location_id]

GO

CREATE PROCEDURE usp_profile_game_location_get_by_game_location_id
(
    @game_location_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_game_location]
    WHERE 1=1
    AND [game_location_id] = @game_location_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_game_location_get_by_profile_id
(
    @profile_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_game_location]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_game_location_get_by_profile_id_by_game_location_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_game_location_get_by_profile_id_by_game_location_id]

GO

CREATE PROCEDURE usp_profile_game_location_get_by_profile_id_by_game_location_id
(
    @profile_id uniqueidentifier = NULL
    , @game_location_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [game_location_id]
        , [type_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_game_location]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_location_id] = @game_location_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileQuestion - profile_question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count]

GO

CREATE PROCEDURE usp_profile_question_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_question_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count_by_channel_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count_by_channel_id]

GO

CREATE PROCEDURE usp_profile_question_count_by_channel_id
(
    @channel_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [channel_id] = @channel_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count_by_org_id]

GO

CREATE PROCEDURE usp_profile_question_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_count_by_profile_id
(
    @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count_by_question_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count_by_question_id]

GO

CREATE PROCEDURE usp_profile_question_count_by_question_id
(
    @question_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [question_id] = @question_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count_by_channel_id_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count_by_channel_id_by_org_id]

GO

CREATE PROCEDURE usp_profile_question_count_by_channel_id_by_org_id
(
    @channel_id uniqueidentifier 
    , @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count_by_channel_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count_by_channel_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_count_by_channel_id_by_profile_id
(
    @channel_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_count_by_question_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_count_by_question_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_count_by_question_id_by_profile_id
(
    @question_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [question_id] = @question_id
    AND [profile_id] = @profile_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileQuestion - profile_question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_question_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [org_id]'
    SET @sql = @sql + ', [channel_id]'
    SET @sql = @sql + ', [answer]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [question_id]'

    SET @sql = @sql + ' FROM [dbo].[profile_question] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileQuestion - profile_question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_question_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @active bit = NULL
    , @data ntext 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier 
    , @channel_id uniqueidentifier 
    , @answer varchar (1000) 
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @question_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_question]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_question] 
                SET
                    [status] = @status
                    , [profile_id] = @profile_id
                    , [active] = @active
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [channel_id] = @channel_id
                    , [answer] = @answer
                    , [date_created] = @date_created
                    , [type] = @type
                    , [question_id] = @question_id
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_question]
                (
                    [status]
                    , [profile_id]
                    , [active]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [org_id]
                    , [channel_id]
                    , [answer]
                    , [date_created]
                    , [type]
                    , [question_id]
                )
                VALUES
                (
                    @status
                    , @profile_id
                    , @active
                    , @data
                    , @uuid
                    , @date_modified
                    , @org_id
                    , @channel_id
                    , @answer
                    , @date_created
                    , @type
                    , @question_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_set_by_channel_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_set_by_channel_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_set_by_channel_id_by_profile_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @active bit = NULL
    , @data ntext 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier 
    , @channel_id uniqueidentifier 
    , @answer varchar (1000) 
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @question_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_question]  
                WHERE 1=1
                AND [channel_id] = @channel_id
                AND [profile_id] = @profile_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_question] 
                SET
                    [status] = @status
                    , [profile_id] = @profile_id
                    , [active] = @active
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [channel_id] = @channel_id
                    , [answer] = @answer
                    , [date_created] = @date_created
                    , [type] = @type
                    , [question_id] = @question_id
                WHERE 1=1
                AND [channel_id] = @channel_id
                AND [profile_id] = @profile_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_question]
                (
                    [status]
                    , [profile_id]
                    , [active]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [org_id]
                    , [channel_id]
                    , [answer]
                    , [date_created]
                    , [type]
                    , [question_id]
                )
                VALUES
                (
                    @status
                    , @profile_id
                    , @active
                    , @data
                    , @uuid
                    , @date_modified
                    , @org_id
                    , @channel_id
                    , @answer
                    , @date_created
                    , @type
                    , @question_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_set_by_question_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_set_by_question_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_set_by_question_id_by_profile_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @active bit = NULL
    , @data ntext 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier 
    , @channel_id uniqueidentifier 
    , @answer varchar (1000) 
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @question_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_question]  
                WHERE 1=1
                AND [question_id] = @question_id
                AND [profile_id] = @profile_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_question] 
                SET
                    [status] = @status
                    , [profile_id] = @profile_id
                    , [active] = @active
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [channel_id] = @channel_id
                    , [answer] = @answer
                    , [date_created] = @date_created
                    , [type] = @type
                    , [question_id] = @question_id
                WHERE 1=1
                AND [question_id] = @question_id
                AND [profile_id] = @profile_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_question]
                (
                    [status]
                    , [profile_id]
                    , [active]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [org_id]
                    , [channel_id]
                    , [answer]
                    , [date_created]
                    , [type]
                    , [question_id]
                )
                VALUES
                (
                    @status
                    , @profile_id
                    , @active
                    , @data
                    , @uuid
                    , @date_modified
                    , @org_id
                    , @channel_id
                    , @answer
                    , @date_created
                    , @type
                    , @question_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_set_by_channel_id_by_question_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_set_by_channel_id_by_question_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_set_by_channel_id_by_question_id_by_profile_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @profile_id uniqueidentifier 
    , @active bit = NULL
    , @data ntext 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @org_id uniqueidentifier 
    , @channel_id uniqueidentifier 
    , @answer varchar (1000) 
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @question_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_question]  
                WHERE 1=1
                AND [channel_id] = @channel_id
                AND [question_id] = @question_id
                AND [profile_id] = @profile_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_question] 
                SET
                    [status] = @status
                    , [profile_id] = @profile_id
                    , [active] = @active
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [org_id] = @org_id
                    , [channel_id] = @channel_id
                    , [answer] = @answer
                    , [date_created] = @date_created
                    , [type] = @type
                    , [question_id] = @question_id
                WHERE 1=1
                AND [channel_id] = @channel_id
                AND [question_id] = @question_id
                AND [profile_id] = @profile_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_question]
                (
                    [status]
                    , [profile_id]
                    , [active]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [org_id]
                    , [channel_id]
                    , [answer]
                    , [date_created]
                    , [type]
                    , [question_id]
                )
                VALUES
                (
                    @status
                    , @profile_id
                    , @active
                    , @data
                    , @uuid
                    , @date_modified
                    , @org_id
                    , @channel_id
                    , @answer
                    , @date_created
                    , @type
                    , @question_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileQuestion - profile_question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_question_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_question]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_del_by_channel_id_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_del_by_channel_id_by_org_id]

GO

CREATE PROCEDURE usp_profile_question_del_by_channel_id_by_org_id
(
    @channel_id uniqueidentifier 
    , @org_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_question]
    WHERE 1=1                        
    AND [channel_id] = @channel_id
    AND [org_id] = @org_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileQuestion - profile_question
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get]

GO

CREATE PROCEDURE usp_profile_question_get
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_question_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get_by_channel_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get_by_channel_id]

GO

CREATE PROCEDURE usp_profile_question_get_by_channel_id
(
    @channel_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [channel_id] = @channel_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get_by_org_id]

GO

CREATE PROCEDURE usp_profile_question_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_get_by_profile_id
(
    @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get_by_question_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get_by_question_id]

GO

CREATE PROCEDURE usp_profile_question_get_by_question_id
(
    @question_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [question_id] = @question_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get_by_channel_id_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get_by_channel_id_by_org_id]

GO

CREATE PROCEDURE usp_profile_question_get_by_channel_id_by_org_id
(
    @channel_id uniqueidentifier 
    , @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get_by_channel_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get_by_channel_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_get_by_channel_id_by_profile_id
(
    @channel_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_question_get_by_question_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_question_get_by_question_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_question_get_by_question_id_by_profile_id
(
    @question_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [profile_id]
        , [active]
        , [data]
        , [uuid]
        , [date_modified]
        , [org_id]
        , [channel_id]
        , [answer]
        , [date_created]
        , [type]
        , [question_id]
    FROM [dbo].[profile_question]
    WHERE 1=1
    AND [question_id] = @question_id
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: ProfileChannel - profile_channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_count]

GO

CREATE PROCEDURE usp_profile_channel_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_channel]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_count_by_uuid]

GO

CREATE PROCEDURE usp_profile_channel_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_channel]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_count_by_channel_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_count_by_channel_id]

GO

CREATE PROCEDURE usp_profile_channel_count_by_channel_id
(
    @channel_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_channel]
    WHERE 1=1
    AND [channel_id] = @channel_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_count_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_count_by_profile_id]

GO

CREATE PROCEDURE usp_profile_channel_count_by_profile_id
(
    @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_channel]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_count_by_channel_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_count_by_channel_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_channel_count_by_channel_id_by_profile_id
(
    @channel_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[profile_channel]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND [profile_id] = @profile_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: ProfileChannel - profile_channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_browse_by_filter]

GO

CREATE PROCEDURE usp_profile_channel_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [channel_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[profile_channel] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: ProfileChannel - profile_channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_set_by_uuid]

GO

CREATE PROCEDURE usp_profile_channel_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @channel_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @profile_id uniqueidentifier 
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_channel]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_channel] 
                SET
                    [status] = @status
                    , [channel_id] = @channel_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [profile_id] = @profile_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_channel]
                (
                    [status]
                    , [channel_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [profile_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @channel_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @profile_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_set_by_channel_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_set_by_channel_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_channel_set_by_channel_id_by_profile_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @channel_id uniqueidentifier 
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @profile_id uniqueidentifier 
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[profile_channel]  
                WHERE 1=1
                AND [channel_id] = @channel_id
                AND [profile_id] = @profile_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[profile_channel] 
                SET
                    [status] = @status
                    , [channel_id] = @channel_id
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [profile_id] = @profile_id
                    , [type] = @type
                WHERE 1=1
                AND [channel_id] = @channel_id
                AND [profile_id] = @profile_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[profile_channel]
                (
                    [status]
                    , [channel_id]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [profile_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @channel_id
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @profile_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: ProfileChannel - profile_channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_del_by_uuid]

GO

CREATE PROCEDURE usp_profile_channel_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_channel]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_del_by_channel_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_del_by_channel_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_channel_del_by_channel_id_by_profile_id
(
    @channel_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[profile_channel]
    WHERE 1=1                        
    AND [channel_id] = @channel_id
    AND [profile_id] = @profile_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: ProfileChannel - profile_channel
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_get]

GO

CREATE PROCEDURE usp_profile_channel_get
AS
BEGIN
    SELECT
        [status]
        , [channel_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_channel]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_get_by_uuid]

GO

CREATE PROCEDURE usp_profile_channel_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [channel_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_channel]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_get_by_channel_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_get_by_channel_id]

GO

CREATE PROCEDURE usp_profile_channel_get_by_channel_id
(
    @channel_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [channel_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_channel]
    WHERE 1=1
    AND [channel_id] = @channel_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_get_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_get_by_profile_id]

GO

CREATE PROCEDURE usp_profile_channel_get_by_profile_id
(
    @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [channel_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_channel]
    WHERE 1=1
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_profile_channel_get_by_channel_id_by_profile_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_profile_channel_get_by_channel_id_by_profile_id]

GO

CREATE PROCEDURE usp_profile_channel_get_by_channel_id_by_profile_id
(
    @channel_id uniqueidentifier 
    , @profile_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [channel_id]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [profile_id]
        , [type]
    FROM [dbo].[profile_channel]
    WHERE 1=1
    AND [channel_id] = @channel_id
    AND [profile_id] = @profile_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: OrgSite - org_site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_count]

GO

CREATE PROCEDURE usp_org_site_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org_site]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_count_by_uuid]

GO

CREATE PROCEDURE usp_org_site_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org_site]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_count_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_count_by_org_id]

GO

CREATE PROCEDURE usp_org_site_count_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org_site]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_count_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_count_by_site_id]

GO

CREATE PROCEDURE usp_org_site_count_by_site_id
(
    @site_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org_site]
    WHERE 1=1
    AND [site_id] = @site_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_count_by_org_id_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_count_by_org_id_by_site_id]

GO

CREATE PROCEDURE usp_org_site_count_by_org_id_by_site_id
(
    @org_id uniqueidentifier 
    , @site_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[org_site]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [site_id] = @site_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: OrgSite - org_site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_browse_by_filter]

GO

CREATE PROCEDURE usp_org_site_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [site_id]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [org_id]'

    SET @sql = @sql + ' FROM [dbo].[org_site] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: OrgSite - org_site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_set_by_uuid]

GO

CREATE PROCEDURE usp_org_site_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @site_id uniqueidentifier 
    , @type varchar (500) = NULL
    , @org_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[org_site]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[org_site] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [site_id] = @site_id
                    , [type] = @type
                    , [org_id] = @org_id
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[org_site]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [site_id]
                    , [type]
                    , [org_id]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @site_id
                    , @type
                    , @org_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_set_by_org_id_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_set_by_org_id_by_site_id]

GO

CREATE PROCEDURE usp_org_site_set_by_org_id_by_site_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @site_id uniqueidentifier 
    , @type varchar (500) = NULL
    , @org_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[org_site]  
                WHERE 1=1
                AND [org_id] = @org_id
                AND [site_id] = @site_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[org_site] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [site_id] = @site_id
                    , [type] = @type
                    , [org_id] = @org_id
                WHERE 1=1
                AND [org_id] = @org_id
                AND [site_id] = @site_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[org_site]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [site_id]
                    , [type]
                    , [org_id]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @site_id
                    , @type
                    , @org_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: OrgSite - org_site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_del_by_uuid]

GO

CREATE PROCEDURE usp_org_site_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[org_site]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_del_by_org_id_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_del_by_org_id_by_site_id]

GO

CREATE PROCEDURE usp_org_site_del_by_org_id_by_site_id
(
    @org_id uniqueidentifier 
    , @site_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[org_site]
    WHERE 1=1                        
    AND [org_id] = @org_id
    AND [site_id] = @site_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: OrgSite - org_site
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_get]

GO

CREATE PROCEDURE usp_org_site_get
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [org_id]
    FROM [dbo].[org_site]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_get_by_uuid]

GO

CREATE PROCEDURE usp_org_site_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [org_id]
    FROM [dbo].[org_site]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_get_by_org_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_get_by_org_id]

GO

CREATE PROCEDURE usp_org_site_get_by_org_id
(
    @org_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [org_id]
    FROM [dbo].[org_site]
    WHERE 1=1
    AND [org_id] = @org_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_get_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_get_by_site_id]

GO

CREATE PROCEDURE usp_org_site_get_by_site_id
(
    @site_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [org_id]
    FROM [dbo].[org_site]
    WHERE 1=1
    AND [site_id] = @site_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_org_site_get_by_org_id_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_org_site_get_by_org_id_by_site_id]

GO

CREATE PROCEDURE usp_org_site_get_by_org_id_by_site_id
(
    @org_id uniqueidentifier 
    , @site_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [org_id]
    FROM [dbo].[org_site]
    WHERE 1=1
    AND [org_id] = @org_id
    AND [site_id] = @site_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: SiteApp - site_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_count]

GO

CREATE PROCEDURE usp_site_app_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site_app]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_count_by_uuid]

GO

CREATE PROCEDURE usp_site_app_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site_app]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_count_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_count_by_app_id]

GO

CREATE PROCEDURE usp_site_app_count_by_app_id
(
    @app_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site_app]
    WHERE 1=1
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_count_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_count_by_site_id]

GO

CREATE PROCEDURE usp_site_app_count_by_site_id
(
    @site_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site_app]
    WHERE 1=1
    AND [site_id] = @site_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_count_by_app_id_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_count_by_app_id_by_site_id]

GO

CREATE PROCEDURE usp_site_app_count_by_app_id_by_site_id
(
    @app_id uniqueidentifier 
    , @site_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[site_app]
    WHERE 1=1
    AND [app_id] = @app_id
    AND [site_id] = @site_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: SiteApp - site_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_browse_by_filter]

GO

CREATE PROCEDURE usp_site_app_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [site_id]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [app_id]'

    SET @sql = @sql + ' FROM [dbo].[site_app] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: SiteApp - site_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_set_by_uuid]

GO

CREATE PROCEDURE usp_site_app_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @site_id uniqueidentifier 
    , @type varchar (500) = NULL
    , @app_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[site_app]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[site_app] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [site_id] = @site_id
                    , [type] = @type
                    , [app_id] = @app_id
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[site_app]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [site_id]
                    , [type]
                    , [app_id]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @site_id
                    , @type
                    , @app_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_set_by_app_id_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_set_by_app_id_by_site_id]

GO

CREATE PROCEDURE usp_site_app_set_by_app_id_by_site_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @site_id uniqueidentifier 
    , @type varchar (500) = NULL
    , @app_id uniqueidentifier 
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[site_app]  
                WHERE 1=1
                AND [app_id] = @app_id
                AND [site_id] = @site_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[site_app] 
                SET
                    [status] = @status
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [site_id] = @site_id
                    , [type] = @type
                    , [app_id] = @app_id
                WHERE 1=1
                AND [app_id] = @app_id
                AND [site_id] = @site_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[site_app]
                (
                    [status]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [site_id]
                    , [type]
                    , [app_id]
                )
                VALUES
                (
                    @status
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @site_id
                    , @type
                    , @app_id
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: SiteApp - site_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_del_by_uuid]

GO

CREATE PROCEDURE usp_site_app_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[site_app]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_del_by_app_id_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_del_by_app_id_by_site_id]

GO

CREATE PROCEDURE usp_site_app_del_by_app_id_by_site_id
(
    @app_id uniqueidentifier 
    , @site_id uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[site_app]
    WHERE 1=1                        
    AND [app_id] = @app_id
    AND [site_id] = @site_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: SiteApp - site_app
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_get]

GO

CREATE PROCEDURE usp_site_app_get
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [app_id]
    FROM [dbo].[site_app]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_get_by_uuid]

GO

CREATE PROCEDURE usp_site_app_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [app_id]
    FROM [dbo].[site_app]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_get_by_app_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_get_by_app_id]

GO

CREATE PROCEDURE usp_site_app_get_by_app_id
(
    @app_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [app_id]
    FROM [dbo].[site_app]
    WHERE 1=1
    AND [app_id] = @app_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_get_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_get_by_site_id]

GO

CREATE PROCEDURE usp_site_app_get_by_site_id
(
    @site_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [app_id]
    FROM [dbo].[site_app]
    WHERE 1=1
    AND [site_id] = @site_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_site_app_get_by_app_id_by_site_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_site_app_get_by_app_id_by_site_id]

GO

CREATE PROCEDURE usp_site_app_get_by_app_id_by_site_id
(
    @app_id uniqueidentifier 
    , @site_id uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [site_id]
        , [type]
        , [app_id]
    FROM [dbo].[site_app]
    WHERE 1=1
    AND [app_id] = @app_id
    AND [site_id] = @site_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Photo - photo
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_count]

GO

CREATE PROCEDURE usp_photo_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[photo]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_count_by_uuid]

GO

CREATE PROCEDURE usp_photo_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[photo]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_count_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_count_by_external_id]

GO

CREATE PROCEDURE usp_photo_count_by_external_id
(
    @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[photo]
    WHERE 1=1
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_count_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_count_by_url]

GO

CREATE PROCEDURE usp_photo_count_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[photo]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_count_by_url_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_count_by_url_by_external_id]

GO

CREATE PROCEDURE usp_photo_count_by_url_by_external_id
(
    @url varchar (500) = NULL
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[photo]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_count_by_uuid_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_count_by_uuid_by_external_id]

GO

CREATE PROCEDURE usp_photo_count_by_uuid_by_external_id
(
    @uuid uniqueidentifier 
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[photo]
    WHERE 1=1
    AND [uuid] = @uuid
    AND [external_id] = @external_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Photo - photo
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_browse_by_filter]

GO

CREATE PROCEDURE usp_photo_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [third_party_oembed]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [url]'
    SET @sql = @sql + ', [third_party_data]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [third_party_url]'
    SET @sql = @sql + ', [third_party_id]'
    SET @sql = @sql + ', [content_type]'
    SET @sql = @sql + ', [external_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[photo] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Photo - photo
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_set_by_uuid]

GO

CREATE PROCEDURE usp_photo_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[photo]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[photo] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[photo]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_set_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_set_by_external_id]

GO

CREATE PROCEDURE usp_photo_set_by_external_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[photo]  
                WHERE 1=1
                AND [external_id] = @external_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[photo] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [external_id] = @external_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[photo]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_set_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_set_by_url]

GO

CREATE PROCEDURE usp_photo_set_by_url
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[photo]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[photo] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[photo]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_set_by_url_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_set_by_url_by_external_id]

GO

CREATE PROCEDURE usp_photo_set_by_url_by_external_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[photo]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND [external_id] = @external_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[photo] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND [external_id] = @external_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[photo]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_set_by_uuid_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_set_by_uuid_by_external_id]

GO

CREATE PROCEDURE usp_photo_set_by_uuid_by_external_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[photo]  
                WHERE 1=1
                AND [uuid] = @uuid
                AND [external_id] = @external_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[photo] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                AND [external_id] = @external_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[photo]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Photo - photo
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_del_by_uuid]

GO

CREATE PROCEDURE usp_photo_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[photo]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_del_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_del_by_external_id]

GO

CREATE PROCEDURE usp_photo_del_by_external_id
(
    @external_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[photo]
    WHERE 1=1                        
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_del_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_del_by_url]

GO

CREATE PROCEDURE usp_photo_del_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[photo]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_del_by_url_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_del_by_url_by_external_id]

GO

CREATE PROCEDURE usp_photo_del_by_url_by_external_id
(
    @url varchar (500) = NULL
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[photo]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_del_by_uuid_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_del_by_uuid_by_external_id]

GO

CREATE PROCEDURE usp_photo_del_by_uuid_by_external_id
(
    @uuid uniqueidentifier 
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[photo]
    WHERE 1=1                        
    AND [uuid] = @uuid
    AND [external_id] = @external_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Photo - photo
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_get]

GO

CREATE PROCEDURE usp_photo_get
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[photo]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_get_by_uuid]

GO

CREATE PROCEDURE usp_photo_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[photo]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_get_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_get_by_external_id]

GO

CREATE PROCEDURE usp_photo_get_by_external_id
(
    @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[photo]
    WHERE 1=1
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_get_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_get_by_url]

GO

CREATE PROCEDURE usp_photo_get_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[photo]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_get_by_url_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_get_by_url_by_external_id]

GO

CREATE PROCEDURE usp_photo_get_by_url_by_external_id
(
    @url varchar (500) = NULL
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[photo]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_photo_get_by_uuid_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_photo_get_by_uuid_by_external_id]

GO

CREATE PROCEDURE usp_photo_get_by_uuid_by_external_id
(
    @uuid uniqueidentifier 
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[photo]
    WHERE 1=1
    AND [uuid] = @uuid
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: Video - video
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_count]

GO

CREATE PROCEDURE usp_video_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[video]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_count_by_uuid]

GO

CREATE PROCEDURE usp_video_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[video]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_count_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_count_by_external_id]

GO

CREATE PROCEDURE usp_video_count_by_external_id
(
    @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[video]
    WHERE 1=1
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_count_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_count_by_url]

GO

CREATE PROCEDURE usp_video_count_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[video]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_count_by_url_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_count_by_url_by_external_id]

GO

CREATE PROCEDURE usp_video_count_by_url_by_external_id
(
    @url varchar (500) = NULL
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[video]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_count_by_uuid_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_count_by_uuid_by_external_id]

GO

CREATE PROCEDURE usp_video_count_by_uuid_by_external_id
(
    @uuid uniqueidentifier 
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[video]
    WHERE 1=1
    AND [uuid] = @uuid
    AND [external_id] = @external_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: Video - video
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_browse_by_filter]

GO

CREATE PROCEDURE usp_video_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [third_party_oembed]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [url]'
    SET @sql = @sql + ', [third_party_data]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [third_party_url]'
    SET @sql = @sql + ', [third_party_id]'
    SET @sql = @sql + ', [content_type]'
    SET @sql = @sql + ', [external_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[video] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: Video - video
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_set_by_uuid]

GO

CREATE PROCEDURE usp_video_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[video]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[video] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[video]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_set_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_set_by_external_id]

GO

CREATE PROCEDURE usp_video_set_by_external_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[video]  
                WHERE 1=1
                AND [external_id] = @external_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[video] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [external_id] = @external_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[video]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_set_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_set_by_url]

GO

CREATE PROCEDURE usp_video_set_by_url
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[video]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[video] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[video]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_set_by_url_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_set_by_url_by_external_id]

GO

CREATE PROCEDURE usp_video_set_by_url_by_external_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[video]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND [external_id] = @external_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[video] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND [external_id] = @external_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[video]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_set_by_uuid_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_set_by_uuid_by_external_id]

GO

CREATE PROCEDURE usp_video_set_by_uuid_by_external_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @external_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[video]  
                WHERE 1=1
                AND [uuid] = @uuid
                AND [external_id] = @external_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[video] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [uuid] = @uuid
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [external_id] = @external_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                AND [external_id] = @external_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[video]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [uuid]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [external_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @uuid
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @external_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: Video - video
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_del_by_uuid]

GO

CREATE PROCEDURE usp_video_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[video]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_del_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_del_by_external_id]

GO

CREATE PROCEDURE usp_video_del_by_external_id
(
    @external_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[video]
    WHERE 1=1                        
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_del_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_del_by_url]

GO

CREATE PROCEDURE usp_video_del_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[video]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_del_by_url_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_del_by_url_by_external_id]

GO

CREATE PROCEDURE usp_video_del_by_url_by_external_id
(
    @url varchar (500) = NULL
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[video]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_del_by_uuid_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_del_by_uuid_by_external_id]

GO

CREATE PROCEDURE usp_video_del_by_uuid_by_external_id
(
    @uuid uniqueidentifier 
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[video]
    WHERE 1=1                        
    AND [uuid] = @uuid
    AND [external_id] = @external_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: Video - video
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_get]

GO

CREATE PROCEDURE usp_video_get
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[video]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_get_by_uuid]

GO

CREATE PROCEDURE usp_video_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[video]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_get_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_get_by_external_id]

GO

CREATE PROCEDURE usp_video_get_by_external_id
(
    @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[video]
    WHERE 1=1
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_get_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_get_by_url]

GO

CREATE PROCEDURE usp_video_get_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[video]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_get_by_url_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_get_by_url_by_external_id]

GO

CREATE PROCEDURE usp_video_get_by_url_by_external_id
(
    @url varchar (500) = NULL
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[video]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_video_get_by_uuid_by_external_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_video_get_by_uuid_by_external_id]

GO

CREATE PROCEDURE usp_video_get_by_uuid_by_external_id
(
    @uuid uniqueidentifier 
    , @external_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [uuid]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [external_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[video]
    WHERE 1=1
    AND [uuid] = @uuid
    AND [external_id] = @external_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameRpgItemWeapon - game_rpg_item_weapon
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_count]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_count_by_uuid]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_count_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_count_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_count_by_url]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_count_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_count_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_count_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_count_by_url_by_game_id
(
    @url varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_count_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_count_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_count_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND [uuid] = @uuid
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameRpgItemWeapon - game_rpg_item_weapon
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_browse_by_filter]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [third_party_oembed]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [description]'
    SET @sql = @sql + ', [game_defense]'
    SET @sql = @sql + ', [third_party_url]'
    SET @sql = @sql + ', [third_party_id]'
    SET @sql = @sql + ', [content_type]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [game_attack]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [url]'
    SET @sql = @sql + ', [third_party_data]'
    SET @sql = @sql + ', [game_price]'
    SET @sql = @sql + ', [game_type]'
    SET @sql = @sql + ', [game_skill]'
    SET @sql = @sql + ', [game_health]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [game_energy]'
    SET @sql = @sql + ', [game_data]'

    SET @sql = @sql + ' FROM [dbo].[game_rpg_item_weapon] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameRpgItemWeapon - game_rpg_item_weapon
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_set_by_uuid]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_weapon]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_weapon] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_weapon]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_set_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_set_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_set_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_weapon]  
                WHERE 1=1
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_weapon] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_weapon]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_set_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_set_by_url]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_set_by_url
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_weapon]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_weapon] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_weapon]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_set_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_set_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_set_by_url_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_weapon]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_weapon] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_weapon]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_set_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_set_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_set_by_uuid_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_weapon]  
                WHERE 1=1
                AND [uuid] = @uuid
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_weapon] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND [uuid] = @uuid
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_weapon]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameRpgItemWeapon - game_rpg_item_weapon
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_del_by_uuid]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_del_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_del_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_del_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1                        
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_del_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_del_by_url]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_del_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_del_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_del_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_del_by_url_by_game_id
(
    @url varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_del_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_del_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_del_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1                        
    AND [uuid] = @uuid
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameRpgItemWeapon - game_rpg_item_weapon
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_get]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_get
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_get_by_uuid]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_get_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_get_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_get_by_url]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_get_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_get_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_get_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_get_by_url_by_game_id
(
    @url varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_weapon_get_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_weapon_get_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_weapon_get_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_weapon]
    WHERE 1=1
    AND [uuid] = @uuid
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameRpgItemSkill - game_rpg_item_skill
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_count]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_count_by_uuid]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_count_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_count_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_count_by_url]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_count_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_count_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_count_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_count_by_url_by_game_id
(
    @url varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_count_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_count_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_count_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND [uuid] = @uuid
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameRpgItemSkill - game_rpg_item_skill
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_browse_by_filter]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [third_party_oembed]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [description]'
    SET @sql = @sql + ', [game_defense]'
    SET @sql = @sql + ', [third_party_url]'
    SET @sql = @sql + ', [third_party_id]'
    SET @sql = @sql + ', [content_type]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [game_attack]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [url]'
    SET @sql = @sql + ', [third_party_data]'
    SET @sql = @sql + ', [game_price]'
    SET @sql = @sql + ', [game_type]'
    SET @sql = @sql + ', [game_skill]'
    SET @sql = @sql + ', [game_health]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [game_energy]'
    SET @sql = @sql + ', [game_data]'

    SET @sql = @sql + ' FROM [dbo].[game_rpg_item_skill] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameRpgItemSkill - game_rpg_item_skill
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_set_by_uuid]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_skill]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_skill] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_skill]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_set_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_set_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_set_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_skill]  
                WHERE 1=1
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_skill] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_skill]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_set_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_set_by_url]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_set_by_url
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_skill]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_skill] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_skill]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_set_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_set_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_set_by_url_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_skill]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_skill] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_skill]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_set_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_set_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_set_by_uuid_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @third_party_oembed varchar (500) = NULL
    , @code varchar (255) = NULL
    , @description varchar (255) = NULL
    , @game_defense decimal = NULL
    , @third_party_url varchar (500) = NULL
    , @third_party_id varchar (500) = NULL
    , @content_type varchar (100) = NULL
    , @type varchar (500) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @game_attack decimal = NULL
    , @uuid uniqueidentifier 
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (500) = NULL
    , @third_party_data varchar (500) = NULL
    , @game_price decimal = NULL
    , @game_type decimal = NULL
    , @game_skill decimal = NULL
    , @game_health decimal = NULL
    , @date_created DATETIME = GETDATE
    , @game_energy decimal = NULL
    , @game_data ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_rpg_item_skill]  
                WHERE 1=1
                AND [uuid] = @uuid
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_rpg_item_skill] 
                SET
                    [status] = @status
                    , [third_party_oembed] = @third_party_oembed
                    , [code] = @code
                    , [description] = @description
                    , [game_defense] = @game_defense
                    , [third_party_url] = @third_party_url
                    , [third_party_id] = @third_party_id
                    , [content_type] = @content_type
                    , [type] = @type
                    , [active] = @active
                    , [game_id] = @game_id
                    , [game_attack] = @game_attack
                    , [uuid] = @uuid
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [third_party_data] = @third_party_data
                    , [game_price] = @game_price
                    , [game_type] = @game_type
                    , [game_skill] = @game_skill
                    , [game_health] = @game_health
                    , [date_created] = @date_created
                    , [game_energy] = @game_energy
                    , [game_data] = @game_data
                WHERE 1=1
                AND [uuid] = @uuid
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_rpg_item_skill]
                (
                    [status]
                    , [third_party_oembed]
                    , [code]
                    , [description]
                    , [game_defense]
                    , [third_party_url]
                    , [third_party_id]
                    , [content_type]
                    , [type]
                    , [active]
                    , [game_id]
                    , [game_attack]
                    , [uuid]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [third_party_data]
                    , [game_price]
                    , [game_type]
                    , [game_skill]
                    , [game_health]
                    , [date_created]
                    , [game_energy]
                    , [game_data]
                )
                VALUES
                (
                    @status
                    , @third_party_oembed
                    , @code
                    , @description
                    , @game_defense
                    , @third_party_url
                    , @third_party_id
                    , @content_type
                    , @type
                    , @active
                    , @game_id
                    , @game_attack
                    , @uuid
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @third_party_data
                    , @game_price
                    , @game_type
                    , @game_skill
                    , @game_health
                    , @date_created
                    , @game_energy
                    , @game_data
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameRpgItemSkill - game_rpg_item_skill
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_del_by_uuid]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_del_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_del_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_del_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1                        
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_del_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_del_by_url]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_del_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_del_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_del_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_del_by_url_by_game_id
(
    @url varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_del_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_del_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_del_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1                        
    AND [uuid] = @uuid
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameRpgItemSkill - game_rpg_item_skill
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_get]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_get
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_get_by_uuid]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_get_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_get_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_get_by_url]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_get_by_url
(
    @url varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_get_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_get_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_get_by_url_by_game_id
(
    @url varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_rpg_item_skill_get_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_rpg_item_skill_get_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_rpg_item_skill_get_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [third_party_oembed]
        , [code]
        , [description]
        , [game_defense]
        , [third_party_url]
        , [third_party_id]
        , [content_type]
        , [type]
        , [active]
        , [game_id]
        , [game_attack]
        , [uuid]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [third_party_data]
        , [game_price]
        , [game_type]
        , [game_skill]
        , [game_health]
        , [date_created]
        , [game_energy]
        , [game_data]
    FROM [dbo].[game_rpg_item_skill]
    WHERE 1=1
    AND [uuid] = @uuid
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameProduct - game_product
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_count]

GO

CREATE PROCEDURE usp_game_product_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_product]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_count_by_uuid]

GO

CREATE PROCEDURE usp_game_product_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_product]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_count_by_game_id]

GO

CREATE PROCEDURE usp_game_product_count_by_game_id
(
    @game_id varchar (100) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_product]
    WHERE 1=1
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_count_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_count_by_url]

GO

CREATE PROCEDURE usp_game_product_count_by_url
(
    @url varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_product]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_count_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_count_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_product_count_by_url_by_game_id
(
    @url varchar (255) = NULL
    , @game_id varchar (100) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_product]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_count_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_count_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_product_count_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id varchar (100) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_product]
    WHERE 1=1
    AND [uuid] = @uuid
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameProduct - game_product
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_browse_by_filter]

GO

CREATE PROCEDURE usp_game_product_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [url]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_product] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameProduct - game_product
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_set_by_uuid]

GO

CREATE PROCEDURE usp_game_product_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @game_id varchar (100) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_product]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_product] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [uuid] = @uuid
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_product]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [uuid]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @uuid
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_set_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_set_by_game_id]

GO

CREATE PROCEDURE usp_game_product_set_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @game_id varchar (100) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_product]  
                WHERE 1=1
                AND LOWER([game_id]) = LOWER(@game_id)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_product] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [uuid] = @uuid
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([game_id]) = LOWER(@game_id)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_product]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [uuid]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @uuid
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_set_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_set_by_url]

GO

CREATE PROCEDURE usp_game_product_set_by_url
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @game_id varchar (100) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_product]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_product] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [uuid] = @uuid
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_product]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [uuid]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @uuid
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_set_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_set_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_product_set_by_url_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @game_id varchar (100) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_product]  
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND LOWER([game_id]) = LOWER(@game_id)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_product] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [uuid] = @uuid
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND LOWER([url]) = LOWER(@url)
                AND LOWER([game_id]) = LOWER(@game_id)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_product]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [uuid]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @uuid
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_set_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_set_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_product_set_by_uuid_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @url varchar (255) = NULL
    , @uuid uniqueidentifier 
    , @game_id varchar (100) = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_product]  
                WHERE 1=1
                AND [uuid] = @uuid
                AND LOWER([game_id]) = LOWER(@game_id)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_product] 
                SET
                    [status] = @status
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [url] = @url
                    , [uuid] = @uuid
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                AND LOWER([game_id]) = LOWER(@game_id)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_product]
                (
                    [status]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [url]
                    , [uuid]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @url
                    , @uuid
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameProduct - game_product
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_del_by_uuid]

GO

CREATE PROCEDURE usp_game_product_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_product]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_del_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_del_by_game_id]

GO

CREATE PROCEDURE usp_game_product_del_by_game_id
(
    @game_id varchar (100) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_product]
    WHERE 1=1                        
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_del_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_del_by_url]

GO

CREATE PROCEDURE usp_game_product_del_by_url
(
    @url varchar (255) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_product]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_del_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_del_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_product_del_by_url_by_game_id
(
    @url varchar (255) = NULL
    , @game_id varchar (100) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_product]
    WHERE 1=1                        
    AND LOWER([url]) = LOWER(@url)
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_del_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_del_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_product_del_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id varchar (100) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_product]
    WHERE 1=1                        
    AND [uuid] = @uuid
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameProduct - game_product
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_get]

GO

CREATE PROCEDURE usp_game_product_get
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [uuid]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_product]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_get_by_uuid]

GO

CREATE PROCEDURE usp_game_product_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [uuid]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_product]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_get_by_game_id]

GO

CREATE PROCEDURE usp_game_product_get_by_game_id
(
    @game_id varchar (100) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [uuid]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_product]
    WHERE 1=1
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_get_by_url]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_get_by_url]

GO

CREATE PROCEDURE usp_game_product_get_by_url
(
    @url varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [uuid]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_product]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_get_by_url_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_get_by_url_by_game_id]

GO

CREATE PROCEDURE usp_game_product_get_by_url_by_game_id
(
    @url varchar (255) = NULL
    , @game_id varchar (100) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [uuid]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_product]
    WHERE 1=1
    AND LOWER([url]) = LOWER(@url)
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_product_get_by_uuid_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_product_get_by_uuid_by_game_id]

GO

CREATE PROCEDURE usp_game_product_get_by_uuid_by_game_id
(
    @uuid uniqueidentifier 
    , @game_id varchar (100) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [url]
        , [uuid]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_product]
    WHERE 1=1
    AND [uuid] = @uuid
    AND LOWER([game_id]) = LOWER(@game_id)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameStatisticLeaderboard - game_statistic_leaderboard
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_count]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_count_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_count_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_count_by_key]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_count_by_key
(
    @key uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [key] = @key
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_count_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_count_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_count_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_count_by_key_by_game_id
(
    @key uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [key] = @key
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_count_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_count_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_count_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_count_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_count_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_count_by_key_by_profile_id_by_game_id
(
    @key uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [key] = @key
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_count_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_count_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_count_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [key] = @key
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameStatisticLeaderboard - game_statistic_leaderboard
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_browse_by_filter]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [username]'
    SET @sql = @sql + ', [key]'
    SET @sql = @sql + ', [stat_value_formatted]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [rank]'
    SET @sql = @sql + ', [rank_change]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [rank_total_count]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [stat_value]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [level]'
    SET @sql = @sql + ', [timestamp]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[game_statistic_leaderboard] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameStatisticLeaderboard - game_statistic_leaderboard
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_set_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @key uniqueidentifier = NULL
    , @stat_value_formatted varchar (500) = NULL
    , @profile_id uniqueidentifier = NULL
    , @rank int = NULL
    , @rank_change int = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @rank_total_count int = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @timestamp float = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_leaderboard]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_leaderboard] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [key] = @key
                    , [stat_value_formatted] = @stat_value_formatted
                    , [profile_id] = @profile_id
                    , [rank] = @rank
                    , [rank_change] = @rank_change
                    , [game_id] = @game_id
                    , [active] = @active
                    , [rank_total_count] = @rank_total_count
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [timestamp] = @timestamp
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_leaderboard]
                (
                    [status]
                    , [username]
                    , [key]
                    , [stat_value_formatted]
                    , [profile_id]
                    , [rank]
                    , [rank_change]
                    , [game_id]
                    , [active]
                    , [rank_total_count]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [timestamp]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @key
                    , @stat_value_formatted
                    , @profile_id
                    , @rank
                    , @rank_change
                    , @game_id
                    , @active
                    , @rank_total_count
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @timestamp
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_set_by_uuid_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_set_by_uuid_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_set_by_uuid_by_profile_id_by_game_id_by_timestamp
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @key uniqueidentifier = NULL
    , @stat_value_formatted varchar (500) = NULL
    , @profile_id uniqueidentifier = NULL
    , @rank int = NULL
    , @rank_change int = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @rank_total_count int = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @timestamp float = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_leaderboard]  
                WHERE 1=1
                AND [uuid] = @uuid
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_leaderboard] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [key] = @key
                    , [stat_value_formatted] = @stat_value_formatted
                    , [profile_id] = @profile_id
                    , [rank] = @rank
                    , [rank_change] = @rank_change
                    , [game_id] = @game_id
                    , [active] = @active
                    , [rank_total_count] = @rank_total_count
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [timestamp] = @timestamp
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_leaderboard]
                (
                    [status]
                    , [username]
                    , [key]
                    , [stat_value_formatted]
                    , [profile_id]
                    , [rank]
                    , [rank_change]
                    , [game_id]
                    , [active]
                    , [rank_total_count]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [timestamp]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @key
                    , @stat_value_formatted
                    , @profile_id
                    , @rank
                    , @rank_change
                    , @game_id
                    , @active
                    , @rank_total_count
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @timestamp
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_set_by_profile_id_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_set_by_profile_id_by_key]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_set_by_profile_id_by_key
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @key uniqueidentifier = NULL
    , @stat_value_formatted varchar (500) = NULL
    , @profile_id uniqueidentifier = NULL
    , @rank int = NULL
    , @rank_change int = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @rank_total_count int = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @timestamp float = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_leaderboard]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [key] = @key
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_leaderboard] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [key] = @key
                    , [stat_value_formatted] = @stat_value_formatted
                    , [profile_id] = @profile_id
                    , [rank] = @rank
                    , [rank_change] = @rank_change
                    , [game_id] = @game_id
                    , [active] = @active
                    , [rank_total_count] = @rank_total_count
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [timestamp] = @timestamp
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [key] = @key
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_leaderboard]
                (
                    [status]
                    , [username]
                    , [key]
                    , [stat_value_formatted]
                    , [profile_id]
                    , [rank]
                    , [rank_change]
                    , [game_id]
                    , [active]
                    , [rank_total_count]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [timestamp]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @key
                    , @stat_value_formatted
                    , @profile_id
                    , @rank
                    , @rank_change
                    , @game_id
                    , @active
                    , @rank_total_count
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @timestamp
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_set_by_profile_id_by_key_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_set_by_profile_id_by_key_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_set_by_profile_id_by_key_by_timestamp
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @key uniqueidentifier = NULL
    , @stat_value_formatted varchar (500) = NULL
    , @profile_id uniqueidentifier = NULL
    , @rank int = NULL
    , @rank_change int = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @rank_total_count int = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @timestamp float = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_leaderboard]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [key] = @key
                AND [timestamp] = @timestamp
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_leaderboard] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [key] = @key
                    , [stat_value_formatted] = @stat_value_formatted
                    , [profile_id] = @profile_id
                    , [rank] = @rank
                    , [rank_change] = @rank_change
                    , [game_id] = @game_id
                    , [active] = @active
                    , [rank_total_count] = @rank_total_count
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [timestamp] = @timestamp
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [key] = @key
                AND [timestamp] = @timestamp
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_leaderboard]
                (
                    [status]
                    , [username]
                    , [key]
                    , [stat_value_formatted]
                    , [profile_id]
                    , [rank]
                    , [rank_change]
                    , [game_id]
                    , [active]
                    , [rank_total_count]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [timestamp]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @key
                    , @stat_value_formatted
                    , @profile_id
                    , @rank
                    , @rank_change
                    , @game_id
                    , @active
                    , @rank_total_count
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @timestamp
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_set_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_set_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_set_by_key_by_profile_id_by_game_id_by_timestamp
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @key uniqueidentifier = NULL
    , @stat_value_formatted varchar (500) = NULL
    , @profile_id uniqueidentifier = NULL
    , @rank int = NULL
    , @rank_change int = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @rank_total_count int = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @timestamp float = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_leaderboard]  
                WHERE 1=1
                AND [key] = @key
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_leaderboard] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [key] = @key
                    , [stat_value_formatted] = @stat_value_formatted
                    , [profile_id] = @profile_id
                    , [rank] = @rank
                    , [rank_change] = @rank_change
                    , [game_id] = @game_id
                    , [active] = @active
                    , [rank_total_count] = @rank_total_count
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [timestamp] = @timestamp
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [key] = @key
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_leaderboard]
                (
                    [status]
                    , [username]
                    , [key]
                    , [stat_value_formatted]
                    , [profile_id]
                    , [rank]
                    , [rank_change]
                    , [game_id]
                    , [active]
                    , [rank_total_count]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [timestamp]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @key
                    , @stat_value_formatted
                    , @profile_id
                    , @rank
                    , @rank_change
                    , @game_id
                    , @active
                    , @rank_total_count
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @timestamp
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_set_by_profile_id_by_game_id_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_set_by_profile_id_by_game_id_by_key]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_set_by_profile_id_by_game_id_by_key
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @key uniqueidentifier = NULL
    , @stat_value_formatted varchar (500) = NULL
    , @profile_id uniqueidentifier = NULL
    , @rank int = NULL
    , @rank_change int = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @rank_total_count int = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @timestamp float = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_leaderboard]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [key] = @key
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_leaderboard] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [key] = @key
                    , [stat_value_formatted] = @stat_value_formatted
                    , [profile_id] = @profile_id
                    , [rank] = @rank
                    , [rank_change] = @rank_change
                    , [game_id] = @game_id
                    , [active] = @active
                    , [rank_total_count] = @rank_total_count
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [timestamp] = @timestamp
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [key] = @key
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_leaderboard]
                (
                    [status]
                    , [username]
                    , [key]
                    , [stat_value_formatted]
                    , [profile_id]
                    , [rank]
                    , [rank_change]
                    , [game_id]
                    , [active]
                    , [rank_total_count]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [timestamp]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @key
                    , @stat_value_formatted
                    , @profile_id
                    , @rank
                    , @rank_change
                    , @game_id
                    , @active
                    , @rank_total_count
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @timestamp
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameStatisticLeaderboard - game_statistic_leaderboard
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_del_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_del_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_del_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_del_by_key_by_game_id
(
    @key uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1                        
    AND [key] = @key
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_del_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_del_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_del_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_del_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_del_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_del_by_key_by_profile_id_by_game_id
(
    @key uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1                        
    AND [key] = @key
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameStatisticLeaderboard - game_statistic_leaderboard
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get_by_key]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get_by_key
(
    @key uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [key] = @key
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get_by_key_by_game_id
(
    @key uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [key] = @key
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get_by_profile_id_by_game_id_by_timestamp
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get_by_key_by_profile_id_by_game_id
(
    @key uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [key] = @key
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_leaderboard_get_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_leaderboard_get_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_leaderboard_get_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [key]
        , [stat_value_formatted]
        , [profile_id]
        , [rank]
        , [rank_change]
        , [game_id]
        , [active]
        , [rank_total_count]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [timestamp]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic_leaderboard]
    WHERE 1=1
    AND [key] = @key
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameLiveQueue - game_live_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_count]

GO

CREATE PROCEDURE usp_game_live_queue_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_live_queue]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_count_by_uuid]

GO

CREATE PROCEDURE usp_game_live_queue_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_live_queue]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_count_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_count_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_live_queue_count_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_live_queue]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameLiveQueue - game_live_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_browse_by_filter]

GO

CREATE PROCEDURE usp_game_live_queue_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [data_stat]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [data_ad]'

    SET @sql = @sql + ' FROM [dbo].[game_live_queue] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameLiveQueue - game_live_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_set_by_uuid]

GO

CREATE PROCEDURE usp_game_live_queue_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @data_stat ntext = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @game_id uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
    , @data_ad ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_live_queue]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_live_queue] 
                SET
                    [status] = @status
                    , [data_stat] = @data_stat
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [game_id] = @game_id
                    , [profile_id] = @profile_id
                    , [type] = @type
                    , [data_ad] = @data_ad
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_live_queue]
                (
                    [status]
                    , [data_stat]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [game_id]
                    , [profile_id]
                    , [type]
                    , [data_ad]
                )
                VALUES
                (
                    @status
                    , @data_stat
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @game_id
                    , @profile_id
                    , @type
                    , @data_ad
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_set_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_set_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_live_queue_set_by_profile_id_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @data_stat ntext = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @game_id uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
    , @data_ad ntext = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_live_queue]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_live_queue] 
                SET
                    [status] = @status
                    , [data_stat] = @data_stat
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [game_id] = @game_id
                    , [profile_id] = @profile_id
                    , [type] = @type
                    , [data_ad] = @data_ad
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_live_queue]
                (
                    [status]
                    , [data_stat]
                    , [uuid]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [game_id]
                    , [profile_id]
                    , [type]
                    , [data_ad]
                )
                VALUES
                (
                    @status
                    , @data_stat
                    , @uuid
                    , @date_modified
                    , @active
                    , @date_created
                    , @game_id
                    , @profile_id
                    , @type
                    , @data_ad
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameLiveQueue - game_live_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_del_by_uuid]

GO

CREATE PROCEDURE usp_game_live_queue_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_live_queue]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_del_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_del_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_live_queue_del_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_live_queue]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameLiveQueue - game_live_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_get]

GO

CREATE PROCEDURE usp_game_live_queue_get
AS
BEGIN
    SELECT
        [status]
        , [data_stat]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [profile_id]
        , [type]
        , [data_ad]
    FROM [dbo].[game_live_queue]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_get_by_uuid]

GO

CREATE PROCEDURE usp_game_live_queue_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [data_stat]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [profile_id]
        , [type]
        , [data_ad]
    FROM [dbo].[game_live_queue]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_get_by_game_id]

GO

CREATE PROCEDURE usp_game_live_queue_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [data_stat]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [profile_id]
        , [type]
        , [data_ad]
    FROM [dbo].[game_live_queue]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_queue_get_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_queue_get_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_live_queue_get_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [data_stat]
        , [uuid]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [profile_id]
        , [type]
        , [data_ad]
    FROM [dbo].[game_live_queue]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameLiveRecentQueue - game_live_recent_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_count]

GO

CREATE PROCEDURE usp_game_live_recent_queue_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_count_by_uuid]

GO

CREATE PROCEDURE usp_game_live_recent_queue_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_count_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_count_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_live_recent_queue_count_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameLiveRecentQueue - game_live_recent_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_browse_by_filter]

GO

CREATE PROCEDURE usp_game_live_recent_queue_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [username]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [game]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_live_recent_queue] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameLiveRecentQueue - game_live_recent_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_set_by_uuid]

GO

CREATE PROCEDURE usp_game_live_recent_queue_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @profile_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @game varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_live_recent_queue]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_live_recent_queue] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [profile_id] = @profile_id
                    , [uuid] = @uuid
                    , [game] = @game
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_live_recent_queue]
                (
                    [status]
                    , [username]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [profile_id]
                    , [uuid]
                    , [game]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @username
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @profile_id
                    , @uuid
                    , @game
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_set_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_set_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_live_recent_queue_set_by_profile_id_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @profile_id uniqueidentifier = NULL
    , @uuid uniqueidentifier 
    , @game varchar (500) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_live_recent_queue]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_live_recent_queue] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [profile_id] = @profile_id
                    , [uuid] = @uuid
                    , [game] = @game
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [description] = @description
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_live_recent_queue]
                (
                    [status]
                    , [username]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [profile_id]
                    , [uuid]
                    , [game]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @username
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @profile_id
                    , @uuid
                    , @game
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameLiveRecentQueue - game_live_recent_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_del_by_uuid]

GO

CREATE PROCEDURE usp_game_live_recent_queue_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_del_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_del_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_live_recent_queue_del_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameLiveRecentQueue - game_live_recent_queue
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_get]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_get]

GO

CREATE PROCEDURE usp_game_live_recent_queue_get
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [profile_id]
        , [uuid]
        , [game]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_get_by_uuid]

GO

CREATE PROCEDURE usp_game_live_recent_queue_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [profile_id]
        , [uuid]
        , [game]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_get_by_game_id]

GO

CREATE PROCEDURE usp_game_live_recent_queue_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [profile_id]
        , [uuid]
        , [game]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_live_recent_queue_get_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_live_recent_queue_get_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_live_recent_queue_get_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [profile_id]
        , [uuid]
        , [game]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [description]
    FROM [dbo].[game_live_recent_queue]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameStatistic - game_statistic
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_count]

GO

CREATE PROCEDURE usp_game_statistic_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_count_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_count_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_count_by_key]

GO

CREATE PROCEDURE usp_game_statistic_count_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_count_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_count_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_count_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_count_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_count_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_count_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_count_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_count_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_count_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_count_by_key_by_profile_id_by_game_id
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_count_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_count_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_count_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameStatistic - game_statistic
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_browse_by_filter]

GO

CREATE PROCEDURE usp_game_statistic_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [username]'
    SET @sql = @sql + ', [timestamp]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [key]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [stat_value]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [level]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[game_statistic] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameStatistic - game_statistic
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_set_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_set_by_uuid_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_set_by_uuid_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_set_by_uuid_by_profile_id_by_game_id_by_timestamp
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic]  
                WHERE 1=1
                AND [uuid] = @uuid
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_set_by_profile_id_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_set_by_profile_id_by_key]

GO

CREATE PROCEDURE usp_game_statistic_set_by_profile_id_by_key
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND LOWER([key]) = LOWER(@key)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND LOWER([key]) = LOWER(@key)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_set_by_profile_id_by_key_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_set_by_profile_id_by_key_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_set_by_profile_id_by_key_by_timestamp
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND LOWER([key]) = LOWER(@key)
                AND [timestamp] = @timestamp
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND LOWER([key]) = LOWER(@key)
                AND [timestamp] = @timestamp
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_set_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_set_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_set_by_key_by_profile_id_by_game_id_by_timestamp
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_set_by_profile_id_by_game_id_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_set_by_profile_id_by_game_id_by_key]

GO

CREATE PROCEDURE usp_game_statistic_set_by_profile_id_by_game_id_by_key
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @data ntext = NULL
    , @stat_value float = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND LOWER([key]) = LOWER(@key)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [data] = @data
                    , [stat_value] = @stat_value
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND LOWER([key]) = LOWER(@key)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [data]
                    , [stat_value]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @data
                    , @stat_value
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameStatistic - game_statistic
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_del_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_del_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_del_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_del_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic]
    WHERE 1=1                        
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_del_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_del_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_del_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_del_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_del_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_del_by_key_by_profile_id_by_game_id
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic]
    WHERE 1=1                        
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameStatistic - game_statistic
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_get_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_get_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_get_by_key]

GO

CREATE PROCEDURE usp_game_statistic_get_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_get_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_get_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_get_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_get_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_get_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_get_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_get_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_get_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_get_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_get_by_profile_id_by_game_id_by_timestamp
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_get_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_get_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_get_by_key_by_profile_id_by_game_id
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_get_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_get_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_get_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [data]
        , [stat_value]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_statistic]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameStatisticMeta - game_statistic_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_count]

GO

CREATE PROCEDURE usp_game_statistic_meta_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_count_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_meta_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_count_by_code]

GO

CREATE PROCEDURE usp_game_statistic_meta_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_count_by_name]

GO

CREATE PROCEDURE usp_game_statistic_meta_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_count_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_count_by_key]

GO

CREATE PROCEDURE usp_game_statistic_meta_count_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_count_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_meta_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_count_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_count_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_meta_count_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameStatisticMeta - game_statistic_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_browse_by_filter]

GO

CREATE PROCEDURE usp_game_statistic_meta_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [sort]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [store_count]'
    SET @sql = @sql + ', [key]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [order]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_statistic_meta] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameStatisticMeta - game_statistic_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_set_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_meta_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @store_count int = NULL
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @order varchar (40) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_meta]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_meta] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [uuid] = @uuid
                    , [store_count] = @store_count
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [order] = @order
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_meta]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [uuid]
                    , [store_count]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [order]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @uuid
                    , @store_count
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @order
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_set_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_set_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_meta_set_by_key_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @store_count int = NULL
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @order varchar (40) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_meta]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_meta] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [uuid] = @uuid
                    , [store_count] = @store_count
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [order] = @order
                    , [description] = @description
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_meta]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [uuid]
                    , [store_count]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [order]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @uuid
                    , @store_count
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @order
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameStatisticMeta - game_statistic_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_del_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_meta_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_del_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_del_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_meta_del_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1                        
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameStatisticMeta - game_statistic_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_get_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_meta_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_get_by_code]

GO

CREATE PROCEDURE usp_game_statistic_meta_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_get_by_name]

GO

CREATE PROCEDURE usp_game_statistic_meta_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_get_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_get_by_key]

GO

CREATE PROCEDURE usp_game_statistic_meta_get_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_get_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_meta_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_meta_get_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_meta_get_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_statistic_meta_get_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_statistic_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameStatisticTimestamp - game_statistic_timestamp
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_count]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_timestamp]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_count_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_timestamp]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_count_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_count_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_count_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp DATETIME = GETDATE
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_statistic_timestamp]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameStatisticTimestamp - game_statistic_timestamp
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_browse_by_filter]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [timestamp]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [key]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[game_statistic_timestamp] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameStatisticTimestamp - game_statistic_timestamp
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_set_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @timestamp DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @key varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @game_id uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_timestamp]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_timestamp] 
                SET
                    [status] = @status
                    , [timestamp] = @timestamp
                    , [uuid] = @uuid
                    , [key] = @key
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [game_id] = @game_id
                    , [profile_id] = @profile_id
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_timestamp]
                (
                    [status]
                    , [timestamp]
                    , [uuid]
                    , [key]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [game_id]
                    , [profile_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @timestamp
                    , @uuid
                    , @key
                    , @date_modified
                    , @active
                    , @date_created
                    , @game_id
                    , @profile_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_set_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_set_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_set_by_key_by_profile_id_by_game_id_by_timestamp
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @timestamp DATETIME = GETDATE
    , @uuid uniqueidentifier 
    , @key varchar (50) = NULL
    , @date_modified DATETIME = GETDATE
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @game_id uniqueidentifier = NULL
    , @profile_id uniqueidentifier = NULL
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_statistic_timestamp]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_statistic_timestamp] 
                SET
                    [status] = @status
                    , [timestamp] = @timestamp
                    , [uuid] = @uuid
                    , [key] = @key
                    , [date_modified] = @date_modified
                    , [active] = @active
                    , [date_created] = @date_created
                    , [game_id] = @game_id
                    , [profile_id] = @profile_id
                    , [type] = @type
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_statistic_timestamp]
                (
                    [status]
                    , [timestamp]
                    , [uuid]
                    , [key]
                    , [date_modified]
                    , [active]
                    , [date_created]
                    , [game_id]
                    , [profile_id]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @timestamp
                    , @uuid
                    , @key
                    , @date_modified
                    , @active
                    , @date_created
                    , @game_id
                    , @profile_id
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameStatisticTimestamp - game_statistic_timestamp
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_del_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic_timestamp]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_del_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_del_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_del_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp DATETIME = GETDATE
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_statistic_timestamp]
    WHERE 1=1                        
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameStatisticTimestamp - game_statistic_timestamp
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_get_by_uuid]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [timestamp]
        , [uuid]
        , [key]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [profile_id]
        , [type]
    FROM [dbo].[game_statistic_timestamp]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_statistic_timestamp_get_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_statistic_timestamp_get_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_statistic_timestamp_get_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp DATETIME = GETDATE
)
AS
BEGIN
    SELECT
        [status]
        , [timestamp]
        , [uuid]
        , [key]
        , [date_modified]
        , [active]
        , [date_created]
        , [game_id]
        , [profile_id]
        , [type]
    FROM [dbo].[game_statistic_timestamp]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameKeyMeta - game_key_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_count]

GO

CREATE PROCEDURE usp_game_key_meta_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_key_meta]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_count_by_uuid]

GO

CREATE PROCEDURE usp_game_key_meta_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_count_by_code]

GO

CREATE PROCEDURE usp_game_key_meta_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_count_by_name]

GO

CREATE PROCEDURE usp_game_key_meta_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_count_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_count_by_key]

GO

CREATE PROCEDURE usp_game_key_meta_count_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_count_by_game_id]

GO

CREATE PROCEDURE usp_game_key_meta_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_count_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_count_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_key_meta_count_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameKeyMeta - game_key_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_browse_by_filter]

GO

CREATE PROCEDURE usp_game_key_meta_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [sort]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [level]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [key_level]'
    SET @sql = @sql + ', [store_count]'
    SET @sql = @sql + ', [key]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [order]'
    SET @sql = @sql + ', [key_stat]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_key_meta] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameKeyMeta - game_key_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_set_by_uuid]

GO

CREATE PROCEDURE usp_game_key_meta_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @level varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @key_level varchar (50) = NULL
    , @store_count int = NULL
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @order varchar (40) = NULL
    , @key_stat varchar (50) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_key_meta]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_key_meta] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [level] = @level
                    , [uuid] = @uuid
                    , [key_level] = @key_level
                    , [store_count] = @store_count
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [order] = @order
                    , [key_stat] = @key_stat
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_key_meta]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [level]
                    , [uuid]
                    , [key_level]
                    , [store_count]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [order]
                    , [key_stat]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @level
                    , @uuid
                    , @key_level
                    , @store_count
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @order
                    , @key_stat
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_set_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_set_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_key_meta_set_by_key_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @level varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @key_level varchar (50) = NULL
    , @store_count int = NULL
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @order varchar (40) = NULL
    , @key_stat varchar (50) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_key_meta]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_key_meta] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [level] = @level
                    , [uuid] = @uuid
                    , [key_level] = @key_level
                    , [store_count] = @store_count
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [order] = @order
                    , [key_stat] = @key_stat
                    , [description] = @description
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_key_meta]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [level]
                    , [uuid]
                    , [key_level]
                    , [store_count]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [order]
                    , [key_stat]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @level
                    , @uuid
                    , @key_level
                    , @store_count
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @order
                    , @key_stat
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_set_by_key_by_game_id_by_level]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_set_by_key_by_game_id_by_level]

GO

CREATE PROCEDURE usp_game_key_meta_set_by_key_by_game_id_by_level
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @level varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @key_level varchar (50) = NULL
    , @store_count int = NULL
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @order varchar (40) = NULL
    , @key_stat varchar (50) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_key_meta]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
                AND LOWER([level]) = LOWER(@level)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_key_meta] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [level] = @level
                    , [uuid] = @uuid
                    , [key_level] = @key_level
                    , [store_count] = @store_count
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [order] = @order
                    , [key_stat] = @key_stat
                    , [description] = @description
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
                AND LOWER([level]) = LOWER(@level)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_key_meta]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [level]
                    , [uuid]
                    , [key_level]
                    , [store_count]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [order]
                    , [key_stat]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @level
                    , @uuid
                    , @key_level
                    , @store_count
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @order
                    , @key_stat
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameKeyMeta - game_key_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_del_by_uuid]

GO

CREATE PROCEDURE usp_game_key_meta_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_key_meta]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_del_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_del_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_key_meta_del_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_key_meta]
    WHERE 1=1                        
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameKeyMeta - game_key_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_get_by_uuid]

GO

CREATE PROCEDURE usp_game_key_meta_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [key_level]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [key_stat]
        , [description]
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_get_by_code]

GO

CREATE PROCEDURE usp_game_key_meta_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [key_level]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [key_stat]
        , [description]
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_get_by_name]

GO

CREATE PROCEDURE usp_game_key_meta_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [key_level]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [key_stat]
        , [description]
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_get_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_get_by_key]

GO

CREATE PROCEDURE usp_game_key_meta_get_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [key_level]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [key_stat]
        , [description]
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_get_by_game_id]

GO

CREATE PROCEDURE usp_game_key_meta_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [key_level]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [key_stat]
        , [description]
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_get_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_get_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_key_meta_get_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [key_level]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [key_stat]
        , [description]
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_key_meta_get_by_code_by_level]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_key_meta_get_by_code_by_level]

GO

CREATE PROCEDURE usp_game_key_meta_get_by_code_by_level
(
    @code varchar (255) = NULL
    , @level varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [key_level]
        , [store_count]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [key_stat]
        , [description]
    FROM [dbo].[game_key_meta]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
    AND LOWER([level]) = LOWER(@level)
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameLevel - game_level
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_count]

GO

CREATE PROCEDURE usp_game_level_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_level]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_count_by_uuid]

GO

CREATE PROCEDURE usp_game_level_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_level]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_count_by_code]

GO

CREATE PROCEDURE usp_game_level_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_level]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_count_by_name]

GO

CREATE PROCEDURE usp_game_level_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_level]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_count_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_count_by_key]

GO

CREATE PROCEDURE usp_game_level_count_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_level]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_count_by_game_id]

GO

CREATE PROCEDURE usp_game_level_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_level]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_count_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_count_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_level_count_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_level]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameLevel - game_level
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_browse_by_filter]

GO

CREATE PROCEDURE usp_game_level_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [sort]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [key]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [order]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_level] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameLevel - game_level
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_set_by_uuid]

GO

CREATE PROCEDURE usp_game_level_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @order varchar (40) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_level]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_level] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [uuid] = @uuid
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [order] = @order
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_level]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [uuid]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [order]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @uuid
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @order
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_set_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_set_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_level_set_by_key_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @order varchar (40) = NULL
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_level]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_level] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [uuid] = @uuid
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [order] = @order
                    , [description] = @description
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_level]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [date_modified]
                    , [data]
                    , [uuid]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [order]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @date_modified
                    , @data
                    , @uuid
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @order
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameLevel - game_level
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_del_by_uuid]

GO

CREATE PROCEDURE usp_game_level_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_level]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_del_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_del_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_level_del_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_level]
    WHERE 1=1                        
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameLevel - game_level
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_get_by_uuid]

GO

CREATE PROCEDURE usp_game_level_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_level]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_get_by_code]

GO

CREATE PROCEDURE usp_game_level_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_level]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_get_by_name]

GO

CREATE PROCEDURE usp_game_level_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_level]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_get_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_get_by_key]

GO

CREATE PROCEDURE usp_game_level_get_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_level]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_get_by_game_id]

GO

CREATE PROCEDURE usp_game_level_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_level]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_level_get_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_level_get_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_level_get_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [date_modified]
        , [data]
        , [uuid]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [order]
        , [description]
    FROM [dbo].[game_level]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameAchievement - game_achievement
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_count]

GO

CREATE PROCEDURE usp_game_achievement_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_count_by_uuid]

GO

CREATE PROCEDURE usp_game_achievement_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_count_by_profile_id_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_count_by_profile_id_by_key]

GO

CREATE PROCEDURE usp_game_achievement_count_by_profile_id_by_key
(
    @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_count_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_count_by_username]

GO

CREATE PROCEDURE usp_game_achievement_count_by_username
(
    @username varchar (500) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND LOWER([username]) = LOWER(@username)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_count_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_count_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_count_by_key_by_profile_id_by_game_id
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_count_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_count_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_achievement_count_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameAchievement - game_achievement
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_browse_by_filter]

GO

CREATE PROCEDURE usp_game_achievement_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [username]'
    SET @sql = @sql + ', [timestamp]'
    SET @sql = @sql + ', [completed]'
    SET @sql = @sql + ', [profile_id]'
    SET @sql = @sql + ', [key]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [achievement_value]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [level]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'

    SET @sql = @sql + ' FROM [dbo].[game_achievement] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameAchievement - game_achievement
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_set_by_uuid]

GO

CREATE PROCEDURE usp_game_achievement_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @completed bit = 1
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @achievement_value decimal = NULL
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_achievement]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_achievement] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [completed] = @completed
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [achievement_value] = @achievement_value
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_achievement]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [completed]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [achievement_value]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @completed
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @achievement_value
                    , @data
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_set_by_uuid_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_set_by_uuid_by_key]

GO

CREATE PROCEDURE usp_game_achievement_set_by_uuid_by_key
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @completed bit = 1
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @achievement_value decimal = NULL
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_achievement]  
                WHERE 1=1
                AND [uuid] = @uuid
                AND LOWER([key]) = LOWER(@key)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_achievement] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [completed] = @completed
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [achievement_value] = @achievement_value
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [uuid] = @uuid
                AND LOWER([key]) = LOWER(@key)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_achievement]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [completed]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [achievement_value]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @completed
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @achievement_value
                    , @data
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_set_by_profile_id_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_set_by_profile_id_by_key]

GO

CREATE PROCEDURE usp_game_achievement_set_by_profile_id_by_key
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @completed bit = 1
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @achievement_value decimal = NULL
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_achievement]  
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND LOWER([key]) = LOWER(@key)
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_achievement] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [completed] = @completed
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [achievement_value] = @achievement_value
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND [profile_id] = @profile_id
                AND LOWER([key]) = LOWER(@key)
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_achievement]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [completed]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [achievement_value]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @completed
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @achievement_value
                    , @data
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_set_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_set_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_set_by_key_by_profile_id_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @completed bit = 1
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @achievement_value decimal = NULL
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_achievement]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_achievement] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [completed] = @completed
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [achievement_value] = @achievement_value
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_achievement]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [completed]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [achievement_value]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @completed
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @achievement_value
                    , @data
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_set_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_set_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_achievement_set_by_key_by_profile_id_by_game_id_by_timestamp
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @username varchar (500) = NULL
    , @timestamp float = NULL
    , @completed bit = 1
    , @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
    , @active bit = NULL
    , @game_id uniqueidentifier = NULL
    , @achievement_value decimal = NULL
    , @data ntext = NULL
    , @uuid uniqueidentifier 
    , @date_modified DATETIME = GETDATE
    , @level varchar (500) = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (500) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_achievement]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_achievement] 
                SET
                    [status] = @status
                    , [username] = @username
                    , [timestamp] = @timestamp
                    , [completed] = @completed
                    , [profile_id] = @profile_id
                    , [key] = @key
                    , [active] = @active
                    , [game_id] = @game_id
                    , [achievement_value] = @achievement_value
                    , [data] = @data
                    , [uuid] = @uuid
                    , [date_modified] = @date_modified
                    , [level] = @level
                    , [date_created] = @date_created
                    , [type] = @type
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [profile_id] = @profile_id
                AND [game_id] = @game_id
                AND [timestamp] = @timestamp
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_achievement]
                (
                    [status]
                    , [username]
                    , [timestamp]
                    , [completed]
                    , [profile_id]
                    , [key]
                    , [active]
                    , [game_id]
                    , [achievement_value]
                    , [data]
                    , [uuid]
                    , [date_modified]
                    , [level]
                    , [date_created]
                    , [type]
                )
                VALUES
                (
                    @status
                    , @username
                    , @timestamp
                    , @completed
                    , @profile_id
                    , @key
                    , @active
                    , @game_id
                    , @achievement_value
                    , @data
                    , @uuid
                    , @date_modified
                    , @level
                    , @date_created
                    , @type
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameAchievement - game_achievement
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_del_by_uuid]

GO

CREATE PROCEDURE usp_game_achievement_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_achievement]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_del_by_profile_id_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_del_by_profile_id_by_key]

GO

CREATE PROCEDURE usp_game_achievement_del_by_profile_id_by_key
(
    @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_achievement]
    WHERE 1=1                        
    AND [profile_id] = @profile_id
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_del_by_uuid_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_del_by_uuid_by_key]

GO

CREATE PROCEDURE usp_game_achievement_del_by_uuid_by_key
(
    @uuid uniqueidentifier 
    , @key varchar (50) = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_achievement]
    WHERE 1=1                        
    AND [uuid] = @uuid
    AND LOWER([key]) = LOWER(@key)
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameAchievement - game_achievement
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_uuid]

GO

CREATE PROCEDURE usp_game_achievement_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_profile_id_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_profile_id_by_key]

GO

CREATE PROCEDURE usp_game_achievement_get_by_profile_id_by_key
(
    @profile_id uniqueidentifier = NULL
    , @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_username]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_username]

GO

CREATE PROCEDURE usp_game_achievement_get_by_username
(
    @username varchar (500) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND LOWER([username]) = LOWER(@username)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_key]

GO

CREATE PROCEDURE usp_game_achievement_get_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_get_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_get_by_profile_id_by_game_id
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_achievement_get_by_profile_id_by_game_id_by_timestamp
(
    @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_key_by_profile_id_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_key_by_profile_id_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_get_by_key_by_profile_id_by_game_id
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_get_by_key_by_profile_id_by_game_id_by_timestamp]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_get_by_key_by_profile_id_by_game_id_by_timestamp]

GO

CREATE PROCEDURE usp_game_achievement_get_by_key_by_profile_id_by_game_id_by_timestamp
(
    @key varchar (50) = NULL
    , @profile_id uniqueidentifier = NULL
    , @game_id uniqueidentifier = NULL
    , @timestamp float = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [username]
        , [timestamp]
        , [completed]
        , [profile_id]
        , [key]
        , [active]
        , [game_id]
        , [achievement_value]
        , [data]
        , [uuid]
        , [date_modified]
        , [level]
        , [date_created]
        , [type]
    FROM [dbo].[game_achievement]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [profile_id] = @profile_id
    AND [game_id] = @game_id
    AND [timestamp] = @timestamp
END
GO
-- -----------------------------------------------------------------------------
-- PROCS

-- ------------------------------------
-- COUNT

-- ------------------------------------
-- MODEL: GameAchievementMeta - game_achievement_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_count]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_count]

GO

CREATE PROCEDURE usp_game_achievement_meta_count
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_count_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_count_by_uuid]

GO

CREATE PROCEDURE usp_game_achievement_meta_count_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_count_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_count_by_code]

GO

CREATE PROCEDURE usp_game_achievement_meta_count_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_count_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_count_by_name]

GO

CREATE PROCEDURE usp_game_achievement_meta_count_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_count_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_count_by_key]

GO

CREATE PROCEDURE usp_game_achievement_meta_count_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_count_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_count_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_meta_count_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_count_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_count_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_meta_count_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        COUNT(*) as count
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- BROWSE

-- ------------------------------------
-- MODEL: GameAchievementMeta - game_achievement_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_browse_by_filter]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_browse_by_filter]

GO

CREATE PROCEDURE usp_game_achievement_meta_browse_by_filter
(
    @page int = 1,
    @page_size int = 10,
    @sort VARCHAR(500) = 'date_modified ASC',
    @filter nvarchar(4000) = NULL
    
)
AS
BEGIN
    DECLARE @sql NVARCHAR(4000)
    SET NOCOUNT ON	

    IF @page = 0
            SET @page = 1
    IF @page_size = 0
            SET @page_size = 10
    
    SET @sql = 'WITH pagedtable AS'
    SET @sql = @sql + '(
                           SELECT ROW_NUMBER()
                           OVER(
                           ORDER BY '
    SET @sql = @sql + @sort
    SET @sql = @sql + ') AS row_num , COUNT(*) OVER(PARTITION BY 1) as total_rows'
    SET @sql = @sql + ', [status]'
    SET @sql = @sql + ', [sort]'
    SET @sql = @sql + ', [code]'
    SET @sql = @sql + ', [display_name]'
    SET @sql = @sql + ', [name]'
    SET @sql = @sql + ', [game_stat]'
    SET @sql = @sql + ', [date_modified]'
    SET @sql = @sql + ', [data]'
    SET @sql = @sql + ', [level]'
    SET @sql = @sql + ', [uuid]'
    SET @sql = @sql + ', [points]'
    SET @sql = @sql + ', [key]'
    SET @sql = @sql + ', [game_id]'
    SET @sql = @sql + ', [active]'
    SET @sql = @sql + ', [date_created]'
    SET @sql = @sql + ', [type]'
    SET @sql = @sql + ', [leaderboard]'
    SET @sql = @sql + ', [description]'

    SET @sql = @sql + ' FROM [dbo].[game_achievement_meta] WHERE 1=1 '
    BEGIN
        IF @filter IS NOT NULL AND @filter != ''
        SET @sql = @sql + ' ' + @filter + ' '			
    END
    SET @sql = @sql + ')'    
    
    SET @sql = @sql + ' SELECT * '
    SET @sql = @sql + ' FROM pagedtable '
    SET @sql = @sql + ' WHERE row_num BETWEEN ('
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' - 1) * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' + 1 AND '
    SET @sql = @sql + convert(varchar,@page)
    SET @sql = @sql + ' * '
    SET @sql = @sql + convert(varchar,@page_size)
    SET @sql = @sql + ' ORDER BY '
    SET @sql = @sql + @sort
    
    PRINT @sql
    PRINT @@rowcount
    EXECUTE sp_executesql @sql 
    

END
GO
-- ------------------------------------
-- SET

-- ------------------------------------
-- MODEL: GameAchievementMeta - game_achievement_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_set_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_set_by_uuid]

GO

CREATE PROCEDURE usp_game_achievement_meta_set_by_uuid
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @game_stat bit = 1
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @level varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @points int = NULL
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @leaderboard bit = 1
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_achievement_meta]  
                WHERE 1=1
                AND [uuid] = @uuid
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_achievement_meta] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [game_stat] = @game_stat
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [level] = @level
                    , [uuid] = @uuid
                    , [points] = @points
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [leaderboard] = @leaderboard
                    , [description] = @description
                WHERE 1=1
                AND [uuid] = @uuid
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_achievement_meta]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [game_stat]
                    , [date_modified]
                    , [data]
                    , [level]
                    , [uuid]
                    , [points]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [leaderboard]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @game_stat
                    , @date_modified
                    , @data
                    , @level
                    , @uuid
                    , @points
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @leaderboard
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_set_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_set_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_meta_set_by_key_by_game_id
(
    @set_type varchar (50) = 'full'                        
    , @status varchar (255) = NULL
    , @sort int = NULL
    , @code varchar (255) = NULL
    , @display_name varchar (255) = NULL
    , @name varchar (255) = NULL
    , @game_stat bit = 1
    , @date_modified DATETIME = GETDATE
    , @data ntext = NULL
    , @level varchar (500) = NULL
    , @uuid uniqueidentifier 
    , @points int = NULL
    , @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
    , @active bit = NULL
    , @date_created DATETIME = GETDATE
    , @type varchar (40) = NULL
    , @leaderboard bit = 1
    , @description varchar (255) = NULL
)
AS
BEGIN
    BEGIN
        DECLARE @CountItems int
        SET @CountItems = 0
        
        DECLARE @id bit
        
        BEGIN
            IF @set_type != 'full' AND @set_type != 'insertonly' AND @set_type != 'updateonly'
                SET @set_type = 'full'
        END

	-- IF TYPE IS FULL SET (COUNT CHECK, UPDATE, INSERT)
	-- GET COUNT TO CHECK
	BEGIN
	    IF @set_type = 'full'
	    BEGIN
		-- CHECK COUNT
                SELECT @CountItems =  COUNT(*)
                FROM  [dbo].[game_achievement_meta]  
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
	    END
	END

        BEGIN
            -- UPDATE
            IF (@CountItems > 0 AND @set_type != 'insertonly')
                OR (@CountItems = 0 AND @set_type = 'updateonly')
            BEGIN		
                UPDATE [dbo].[game_achievement_meta] 
                SET
                    [status] = @status
                    , [sort] = @sort
                    , [code] = @code
                    , [display_name] = @display_name
                    , [name] = @name
                    , [game_stat] = @game_stat
                    , [date_modified] = @date_modified
                    , [data] = @data
                    , [level] = @level
                    , [uuid] = @uuid
                    , [points] = @points
                    , [key] = @key
                    , [game_id] = @game_id
                    , [active] = @active
                    , [date_created] = @date_created
                    , [type] = @type
                    , [leaderboard] = @leaderboard
                    , [description] = @description
                WHERE 1=1
                AND LOWER([key]) = LOWER(@key)
                AND [game_id] = @game_id
                SET @id=1
            END
        END
        BEGIN
            --INSERT
            IF @CountItems = 0 AND @set_type != 'updateonly' 			
            BEGIN			
                INSERT INTO [dbo].[game_achievement_meta]
                (
                    [status]
                    , [sort]
                    , [code]
                    , [display_name]
                    , [name]
                    , [game_stat]
                    , [date_modified]
                    , [data]
                    , [level]
                    , [uuid]
                    , [points]
                    , [key]
                    , [game_id]
                    , [active]
                    , [date_created]
                    , [type]
                    , [leaderboard]
                    , [description]
                )
                VALUES
                (
                    @status
                    , @sort
                    , @code
                    , @display_name
                    , @name
                    , @game_stat
                    , @date_modified
                    , @data
                    , @level
                    , @uuid
                    , @points
                    , @key
                    , @game_id
                    , @active
                    , @date_created
                    , @type
                    , @leaderboard
                    , @description
                )                    
                SET @id=1                    
            END
        END     
        SELECT @id as id
    END 
END
GO
-- ------------------------------------
-- DEL

-- ------------------------------------
-- MODEL: GameAchievementMeta - game_achievement_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_del_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_del_by_uuid]

GO

CREATE PROCEDURE usp_game_achievement_meta_del_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1                        
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_del_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_del_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_meta_del_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    DELETE 
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1                        
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO
-- ------------------------------------
-- GET

-- ------------------------------------
-- MODEL: GameAchievementMeta - game_achievement_meta
                       
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_get_by_uuid]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_get_by_uuid]

GO

CREATE PROCEDURE usp_game_achievement_meta_get_by_uuid
(
    @uuid uniqueidentifier 
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [game_stat]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [points]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [leaderboard]
        , [description]
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND [uuid] = @uuid
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_get_by_code]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_get_by_code]

GO

CREATE PROCEDURE usp_game_achievement_meta_get_by_code
(
    @code varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [game_stat]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [points]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [leaderboard]
        , [description]
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND LOWER([code]) = LOWER(@code)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_get_by_name]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_get_by_name]

GO

CREATE PROCEDURE usp_game_achievement_meta_get_by_name
(
    @name varchar (255) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [game_stat]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [points]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [leaderboard]
        , [description]
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND LOWER([name]) = LOWER(@name)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_get_by_key]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_get_by_key]

GO

CREATE PROCEDURE usp_game_achievement_meta_get_by_key
(
    @key varchar (50) = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [game_stat]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [points]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [leaderboard]
        , [description]
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_get_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_get_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_meta_get_by_game_id
(
    @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [game_stat]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [points]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [leaderboard]
        , [description]
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND [game_id] = @game_id
END
GO
-- -----------------------------------------------------------------------------
IF EXISTS (SELECT * FROM dbo.sysobjects where id = object_id(N'[dbo].[usp_game_achievement_meta_get_by_key_by_game_id]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE [dbo].[usp_game_achievement_meta_get_by_key_by_game_id]

GO

CREATE PROCEDURE usp_game_achievement_meta_get_by_key_by_game_id
(
    @key varchar (50) = NULL
    , @game_id uniqueidentifier = NULL
)
AS
BEGIN
    SELECT
        [status]
        , [sort]
        , [code]
        , [display_name]
        , [name]
        , [game_stat]
        , [date_modified]
        , [data]
        , [level]
        , [uuid]
        , [points]
        , [key]
        , [game_id]
        , [active]
        , [date_created]
        , [type]
        , [leaderboard]
        , [description]
    FROM [dbo].[game_achievement_meta]
    WHERE 1=1
    AND LOWER([key]) = LOWER(@key)
    AND [game_id] = @game_id
END
GO

